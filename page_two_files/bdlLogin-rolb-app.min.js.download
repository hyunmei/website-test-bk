function getElementsByClassName(a,b){if(a.getElementsByClassName)return a.getElementsByClassName(b);if(b=b.replace(/ *$/,""),a.querySelectorAll)return a.querySelectorAll((" "+b).replace(/ +/g,"."));b=b.replace(/^ */,"");var c,d,e,f=b.split(/ +/),g=f.length,h=a.getElementsByTagName("*"),i=h.length,j=[];for(c=0;c<i;c++){for(e=!0,d=g;d--;)RegExp(" "+f[d]+" ").test(" "+h[c].className+" ")||(e=!1);e&&j.push(h[c])}return j}function getTextContent(a){return"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),a.textContent||""+a.innerText}function scFixed(a,b){this.f1=a,this.v1=b,this.setTags=function(s,c,d){scSetTag(s,a,b)}}function scFixed1Tag(a,b,c){this.f1=a,this.v1=b,this.f2=c,this.setTags=function(s,d,e){scSetTag(s,a,b),scSetTag(s,c,e)}}function scAppendWholeTag(a,b,c,d,e){this.f1=a,this.v1=b,this.f2=c,this.v2=d,this.f3=e,this.setTags=function(s,f,g){scSetTag(s,a,b),scSetTag(s,c,d),g=s[e]?s[e]+"|"+f+"="+g:f+"="+g,scSetTag(s,e,g)}}function scLowRankTag(a){this.tag=a,this.setTags=function(s,a,b){null!=s[this.tag]&&""!=s[this.tag]&&"0.00"!=s[this.tag]||scSetTag(s,this.tag,b)}}function scProductsTag(a,b){this.productTag=a,this.compTag=b,this.setTags=function(s,a,c){scSetTag(s,b,c)}}function scSetLinkNameTag(a,b){this.f=a,this.rank=b,this.setTags=function(s,a,b){this.rank>s.__LinkNameRank&&(s.__LinkName=b,s.__LinkNameRank=this.rank)}}function scCombinedP123(a){this.sep=a,this.setTags=function(s,a,b){var c=b.indexOf(this.sep);c>0&&(scSetTag(s,"prop1",b.substring(0,c)),b=b.substring(c+1),(c=b.indexOf(this.sep))>0&&(scSetTag(s,"prop2",b.substring(0,c)),b=b.substring(c+1))),scSetTag(s,"prop3",b)}}function scRemap(a){var b=!1,s=s_gi(s_account);scSetInitial(s,"link");for(var c in WT)null!==WT[c]&&(scMapTag(s,c,WT[c]),b=!0);for(var c in DCS)null!==DCS[c]&&(scMapTag(s,c,DCS[c]),b=!0);for(var c in DCSext)null!==DCSext[c]&&(scMapTag(s,c,DCSext[c]),b=!0);for(var c in a)null!==a[c]&&(scSetTag(s,c,a[c]),b=!0);if(b)try{scSetDerived(s,"link"),s.tl(this,"o",s.__LinkName),scCleanUp(s)}catch(a){}WT={},DCS={},DCSext={}}function tagPageView(){var a=$("#_wt");if(a.length){var b,c=!1,s=s_gi(s_account);scSetInitial(s);var d=a.metadata();for(var e in d)b=d[e],0==e.indexOf("WT.")?(scMapTag(s,e.substring(3),b),c=!0):0==e.indexOf("DCSext.")?(scMapTag(s,e.substring(7),b),c=!0):0==e.indexOf("DCS.")?(scMapTag(s,e.substring(4),b),c=!0):0==e.indexOf("s.")&&(scSetTag(s,e.substring(2),b),c=!0);if(a.remove(),c)try{scSetDeepLink(s),scSetDerived(s),s.t(),scCleanUp(s)}catch(a){}}}function tagAjaxContent(){var a=$("div#_sc1");if(a.length)for(var b=1;a.length;)a.each(function(){tagQueryContents($(this))}),a.remove(),b++,a=$("div#_sc"+b)}function tagQueryContents(a){var b=a.closest(".modal-wnd");0==b.length&&(b=a.closest(".takeover-wnd"),0==b.length&&(b=a.closest("div.module-holder"),0==b.length&&(b=$(window.top.document))));var c=a.metadata(),d=c.selector;if(null!=d&&0!=d.length){var e=c.bind?c.bind:"click",f=function(a){try{scSetInitial(s,"link");var b,d=$(a.target);d.is(":checkbox")?b=d.is(":checked")?"on":"off":(b=d.text())||(b=d.val(),b||(b=d.attr("name")),b||(b="")),s.__LinkName=b.replace(/(^|\W+)(\w)/g,function(a,b,c){return c.toUpperCase()}),s.__LinkNameRank=1;for(var e in c)if(0==e.indexOf("attr.")){var f=$(a.currentTarget).attr(c[e]);scSetTag(s,e.substring(5),f)}else 0==e.indexOf("s.")?scSetTag(s,e.substring(2),c[e]):0==e.indexOf("DCS.")?scMapTag(s,e.substring(4),c[e]):0==e.indexOf("DCSext.")?scMapTag(s,e.substring(7),c[e]):0==e.indexOf("WT.")&&scMapTag(s,e.substring(3),c[e]);1==s.__LinkNameRank&&s.__LinkPrefix&&(s.__LinkName=s.__LinkPrefix+s.__LinkName),scSetDerived(s,"link"),s.tl(!0,"o",s.__LinkName),scCleanUp(s)}catch(a){}};if(void 0==document.getElementsByClassName){b.find(d).unbind(e,f),b.find(d).bind(e,c,f);var g=b.find(d);0==g.length&&($(d).unbind(e),$(d).bind(e,c,f))}else{b.find(d).unbind(e),b.find(d).bind(e,c,f);var g=b.find(d);0==g.length&&($(d).unbind(e),$(d).bind(e,c,f))}}}function setFromClickTagsFTB(a,b,c,d){dcsMultiTrack(a,b,c,d,"DCSext.sprop34",getProp34(s),"DCSext.seVar25",getProp34(s))}function scLinkTrack(){if(scSetInitial(s,"link"),arguments.length%2==0){for(var a=0;a<arguments.length;a+=2)0==arguments[a].indexOf("s.")?scSetTag(s,arguments[a].substring(2),arguments[a+1]):scSetTag(s,arguments[a],arguments[a+1]);try{scSetDerived(s,"link"),s.tl(this,"o",s.__LinkName),scCleanUp(s)}catch(a){}}}function scLinkTrackError(a,b){var c=b.stack?b.stack.substr(0,500):"Stack trace unavailable";c=c.replace(/https:\/\/bank.barclays.co.uk/g,""),c=encodeURI(c);var d=b.message?b.message:b;scLinkTrack("eVar11",a,"prop11",a,"events","event4","eVar66",c.substr(0,240),"eVar67",d.substr(0,240))}function dcsMultiTrack(){if(!isLoginPage(s)){var a={};if(WT={},DCS={},DCSext={},arguments.length%2==0){for(var b=0;b<arguments.length;b+=2)0==arguments[b].indexOf("WT.")?WT[arguments[b].substring(3)]=arguments[b+1]:0==arguments[b].indexOf("DCS.")?DCS[arguments[b].substring(4)]=arguments[b+1]:0==arguments[b].indexOf("DCSext.")?DCSext[arguments[b].substring(7)]=arguments[b+1]:0==arguments[b].indexOf("s.")&&(a[arguments[b].substring(2)]=arguments[b+1]);scRemap(a)}}}function scMeta(s){try{var a;if(scSetInitial(s),document.all?a=document.all.tags("meta"):document.documentElement&&(a=document.getElementsByTagName("meta")),void 0!==a)for(var b=1;b<=a.length;b++){var c=a.item(b-1);c.name&&(0==c.name.indexOf("WT.")?scMapTag(s,c.name.substring(3),c.content):0==c.name.indexOf("DCSext.")?scMapTag(s,c.name.substring(7),c.content):0==c.name.indexOf("DCS.")?scMapTag(s,c.name.substring(4),c.content):0==c.name.indexOf("s.")&&scSetTag(s,c.name.substring(2),c.content))}scSetDerived(s),scSaveBasePageName(),tagAjaxContent()}catch(a){}}function scSetInitial(s,a){s.server="bank.barclays.co.uk",s.channel="UKRBB",s.cookieDomainPeriods="3",s.currencyCode="GBP",s.visitorNamespace="barclaysuk",s.trackingServer="metrics.barclays.co.uk",s.trackingServerSecure="smetrics.barclays.co.uk",s.linkTrackEvents="None",s.useForcedLinkTracking=!1,s.__tx_e="",delete s.__LinkPrefix,a?(s.prop17=s.pageName,s.eVar41=s.pageName,s.linkTrackVars="prop17,eVar41"):(s.linkTrackVars="None",s.prop1="onl",s.prop2="",s.prop3="",s.prop16="",s.pageName="",isLoginPage(s)||-1!=document.title.indexOf("Login")||(s.events="")),s.products="",s.prop20="",s.prop30="",s.__pageName="",document.title?s.__LinkName=document.title:s.__LinkName="onl",s.__LinkNameRank=0}function scSetDerived(s,a){scSetdcsuri(s),scSetPurchaseTracking(s),scSetActivityTracking(s),scSetLoginReg(s),scSetProducts(s),scSetView(s),scSetPageName(s,a),scSetDcsvid(s),(document.title.indexOf("Login")>=0||isLoginPage(s))&&scLoginPagesTracking(s),scSetLoginEvents(s),scSetEvents(s)}function isLoginPage(s){return void 0!=s.eVar41&&""!=s.eVar41&&s.eVar41.indexOf("logon")>=0}function isHomePage(s){return void 0!=s.eVar41&&""!=s.eVar41&&s.eVar41.indexOf("HomePage")>=0}function scSetHelpCardButtons(a){scSetTag(s,"prop24","HelpCard"+a),scSetPageName(s,"link"),scCleanUpEvents(s),fireLoadEvent(s)}function scCleanUpEvents(s){if(s.linkTrackVars&&"None"!=s.linkTrackVars){var a=s.linkTrackVars.split(",");for(var b in a){var c=a[b];"events"!=c&&"eVar53"!=c||(s[a[b]]="")}}}function scLoginPagesTracking(s){scSetImpressions(s),scSetErrorMessage(s),scSetLOGIN_METHOD(s),scSetLOGIN_MECHANISM(s)}function scCleanUp(s){if(s.linkTrackVars&&"None"!=s.linkTrackVars){var a=s.linkTrackVars.split(",");for(var b in a)s[a[b]]=""}var a="eVar11,purchaseID,pageType,campaign,state,zip,transactionID".split(",");for(var b in a)s[a[b]]=""}function scSetValidationErrorMessage(s){for(var a=getElementsByClassName(document,"error"),b="",c=0,d=a.length;c<d;c++){var e=a[c],f=e.getAttribute("name");void 0!=f&&(b=""==b?f:b+"|"+f)}""!=b&&(scLinkTrack("prop32",b,"events","event4"),$("#ftb-takeover").length?dcsMultiTrack("s.linkTrackVars","prop16,prop17,prop32,prop34,eVar25,list3","s.linkTrackEvents","event4","s.prop34",getProp34(s),"s.prop32",b,"DCSext.sevents","event4","s.list3",b):(dcsMultiTrack("DCSext.sprop11",b,"DCSext.seVar11",b,"DCSext.sprop34",getProp34(s)),scSetTag(s,"prop32",b),scSetTag(s,"events","event4"),fireLoadEvent(s)))}function fireLoadEvent(s){try{s.tl(!0,"o",s.__LinkName)}catch(a){}}function scSetHelpCardButtons(a){scSetTag(s,"prop24","HelpCard"+a),fireLoadEvent(s)}function scSetErrorMessage(s){for(var a="",b=!1,c=getElementsByClassName(document,"request-error"),d=0,e=c.length;d<e;d++){var f=getElementsByClassName(c[d],"item"),g=null;g=f.length>0?getTextContent(getElementsByClassName(c[d],"item")[0]).trim().toUpperCase():"",!b&&(g.indexOf("WE ARE UNABLE TO LOG YOU")>=0||g.indexOf("WE COULDN'T LOG YOU IN")>=0||g.indexOf("LOG")>=0)&&(b=!0);var h=g.substring(0,g.indexOf("-")).trim();c.length-1==d?a+=h:a=a+h+"|"}if(""!=a){var s=s_gi(s_account);scSetTag(s,"prop11",a),void 0!=s.prop34&&""!=s.prop34&&(s.eVar25=s.prop34,scSetTag(s,"eVar25",s.eVar25)),b&&scSetTag(s,"eVar40",s.prop1+":unsuccessful")}else scSetTag(s,"prop11","")}function scSetErrorServiceMessage(s){for(var a="",b=getElementsByClassName(document,"request-error"),c=0,d=b.length;c<d;c++)for(var e=getElementsByClassName(b[c],"item"),f=0;f<e.length;f++){var g=getTextContent(getElementsByClassName(b[c],"item")[f]).trim().toUpperCase();if(void 0!=g){var h=g.substring(0,g.indexOf("-")).trim();a=""==a?h:a+"|"+h}}if(""!=a){var s=s_gi(s_account);scSetTag(s,"prop11",a),scSetTag(s,"eVar11",a),void 0!=s.prop34&&""!=s.prop34&&(s.eVar25=s.prop34,scSetTag(s,"eVar25",s.eVar25))}else scSetTag(s,"prop11","")}function scSetImpressions(s){if(void 0!=s.eVar53&&""!=s.eVar53){if(void 0!=getElementsByClassName(document,"info")){var a=getElementsByClassName(document,"info").length;0!=a&&(s.eVar53=a+s.eVar53.substring(1))}scSetTag(s,"prop53",s.eVar53)}void 0!=s.prop24&&(s.prop24.indexOf("change-user")>=0||s.prop24.indexOf("forget-user")>=0)&&(scSetTag(s,"eVar53",""),scSetTag(s,"prop53",""))}function scSetLOGIN_METHOD(s){void 0!=document.getElementById("passcode-radio")&&document.getElementById("passcode-radio").checked?scSetTag(s,"eVar37","Passcode"):void 0!=document.getElementById("mobileAuthentication")&&document.getElementById("mobileAuthentication").checked?scSetTag(s,"eVar37","MobilePinSentry"):void 0!=document.getElementById("pinsentry-radio")&&document.getElementById("pinsentry-radio").checked?scSetTag(s,"eVar37","PinSentry"):!$("#passcode").length||$("#pin-authorise1").length||$("#pin-authorise3").length?!$("#pin-authorise1").length||$("#passcode").length||$("#pin-authorise3").length?!$("#pin-authorise3").length||$("#passcode").length||$("#pin-authorise1").length?void 0!=document.getElementById("mobilesentry-radio")&&document.getElementById("mobilesentry-radio").checked&&scSetTag(s,"eVar37","MobileSentry"):scSetTag(s,"eVar37","MobilePinSentry"):scSetTag(s,"eVar37","PinSentry"):scSetTag(s,"eVar37","Passcode")}function scSetLOGIN_MECHANISM(s){void 0!=document.getElementById("membership-radio")||1!=getElementsByClassName(document,"reference-number").length||isNaN(getTextContent(getElementsByClassName(document,"reference-number")[0]).trim())?void 0!=document.getElementById("membership-radio")&&document.getElementById("membership-radio").checked?scSetTag(s,"eVar36","MembershipID"):void 0!=document.getElementById("card-radio")&&document.getElementById("card-radio").checked?scSetTag(s,"eVar36","CardNumber"):void 0==document.getElementById("card-radio")&&1==getElementsByClassName(document,"reference-number").length&&getTextContent(getElementsByClassName(document,"reference-number")[0]).trim().indexOf("X")>=0&&4==getTextContent(getElementsByClassName(document,"reference-number")[0]).trim().indexOf("-")?scSetTag(s,"eVar36","CardNumber"):void 0!=document.getElementById("account-radio")&&document.getElementById("account-radio").checked?scSetTag(s,"eVar36","AccountAndSortcode"):void 0==document.getElementById("account-radio")&&1==getElementsByClassName(document,"reference-number").length&&getTextContent(getElementsByClassName(document,"reference-number")[0]).trim().indexOf("-")>=2&&scSetTag(s,"eVar36","AccountAndSortcode"):scSetTag(s,"eVar36","MembershipID")}function scSetLoginEvents(s){if(!s.event15&&void 0!=s.eVar40&&s.eVar40.indexOf("unsuccessful")>=0&&scSetTag(s,"events","event15"),!s.event14&&isHomePage(s)&&void 0!=s.eVar9&&"Logged In"==s.eVar9&&(void 0==s.eVar40||""==s.eVar40)){scSetTag(s,"eVar40",s.prop1+":successful");var a=$("[name=firstTimeOLBLogin]");if(void 0!=a){"true"==$(a).attr("content")&&scSetTag(s,"events","event24")}}}function scSetDeepLink(s){var a=$("#dl");a.length>0&&(scSetTag(s,"events","event26"),a.remove())}function scSetDeepLink(s){var a=$("#dl");a.length>0&&(scSetTag(s,"events","event26"),a.remove())}function scSetdcsuri(s){s.prop16?scSetTag(s,"prop16",s.prop16):window.jQuery&&("undefined"!=typeof _wt&&void 0!==_wt.dcsurl&&""!==_wt.dcsurl?($.url.setUrl(_wt.dcsurl),scSetTag(s,"prop16",$.url.attr("path"))):scSetTag(s,"prop16",window.location.pathname))}function scSetProducts(s){if(""!=s.prop20&&(null==s.products||""==s.products)){scSetTag(s,"products",";"+s.prop20+";"+s.__tx_u+";"+s.prop30)}}function scSetView(s){"v"==s.__tx_e&&scSetTag(s,"events","scView")}function getProp34(s){return"undefined"!=typeof WT&&void 0!=WT.dcsvid?WT.dcsvid:window.jQuery?$("meta[name=WT.dcsvid]").attr("content"):void 0}function scSetPurchaseTracking(s){"p"==s.__tx_e&&"ROLB_purchasers"==s.__seg_1&&(scSetTag(s,"events","purchase:-"+s.eVar19),scSetTag(s,"purchaseID",s.eVar19),scSetTag(s,"transactionID",s.eVar19),scSetTag(s,"s.eVar21",s.eVar19),s.eVar19="")}function scSetActivityTracking(s){"p"==s.__tx_e&&null!=s.__seg_1&&"ROLB_purchasers"!=s.__seg_1&&null!=s.events&&s.events.indexOf("event17")<0&&scSetTag(s,"events","event17")}function scSetLoginReg(s){void 0!=s.prop20&&""!=s.prop20&&(s.prop20 in{"1-900-2":1,"910-2":1,"1-900-0":1,"910-0":1}?(scSetTag(s,"events","event14"),scSetTag(s,"eVar9","Logged In")):s.prop20 in{"1-900-3":1,"910-3":1,"1-900-1":1,"910-1":1}?(scSetTag(s,"events","event14"),scSetTag(s,"eVar9","First time logged In")):s.prop20 in{"900-4":1,"910-4":1,"900-5":1,"910-5":1}&&scSetTag(s,"events","event13"))}function scSetPageName(s,a){if(a)s.__LinkName=s.__LinkName.replace(/(^|\W+)(\w)/g,function(a,b,c){return c.toUpperCase()});else{s.__pageName&&0==s.__LinkNameRank&&(s.__LinkName=s.__pageName);var b=s.__pageName?s.__pageName:s.pageName&&""!=s.pageName?s.pageName:document.title;"ViewTransactions"==s.__pageName||"ViewStatementsList"==s.__pageName||"ViewStatementsList"==s.__pageName||"ManageStatements:StatementPreferences"==s.__pageName||"ManageStatements:ConfirmDetails"==s.__pageName||"ManageStatements:Receipt"==s.__pageName||"LetterPreferences"==s.__pageName||"MarketingPreferences"==s.__pageName||"StatementPreferences:Step1"==s.__pageName||"StatementPreferences:Receipt"==s.__pageName?s.pageName=s.__pageName:s.pageName=b.replace(/(^|\W+)(\w)/g,function(a,b,c){return c.toUpperCase()}),b=s.prop3,s.prop3=b.replace(/(^|\W+)(\w)/g,function(a,b,c){return c.toUpperCase()}),s.pageName=s.prop1+":"+s.prop2+":"+s.prop3+":"+s.pageName,s.prop3=s.prop1+":"+s.prop2+":"+s.prop3,s.prop2=s.prop1+":"+s.prop2,s.eVar41=s.pageName}}function isMultipleSavedUsers(s){return!(void 0==s.eVar53||""==s.eVar53||!isLoginPage(s))&&s.eVar53.split("|")[1]>1}function scSetEvents(s){null!=s.linkTrackEvents&&"None"!=s.linkTrackEvents?s.events=s.linkTrackEvents:s.events=""}function scSetDcsvid(s){void 0==s.eVar25||""==s.eVar25?"undefined"!=typeof WT&&void 0!=WT.dcsvid?scSetTag(s,"eVar25",WT.dcsvid):window.jQuery&&scSetTag(s,"eVar25",$("meta[name=WT.dcsvid]").attr("content")):scUpdateLinkTrack(s,"eVar25")}function scBarclaysCookieConsent(s){var a=document.getElementById("CCPCat3On");null!=a&&"on"==a.value?s.cookieLifetime="":s.cookieLifetime="NONE"}function scMapTag(s,a,b){if(dcs2sc.hasOwnProperty(a)&&null!==b&&""!=b){var c=dcs2sc[a];"object"==typeof c?c.setTags(s,a,b):scSetTag(s,c,b)}}function scSetTag(s,a,b){s[a]=b,scAddTag(s,a,b)}function scAddTag(s,a,b){0!=a.indexOf("__")&&(0==a.indexOf("events")?(null==s.linkTrackVars||"None"==s.linkTrackVars?s.linkTrackVars="events":s.linkTrackVars.indexOf("events")<0&&(s.linkTrackVars+=",events"),null==s.linkTrackEvents||"None"==s.linkTrackEvents?s.linkTrackEvents=b:s.linkTrackEvents+=","+b):"None"==s.linkTrackVars?s.linkTrackVars=a:s.linkTrackVars+=","+a)}function scUpdateLinkTrack(s,a){null==s.linkTrackVars||"None"==s.linkTrackVars?s.linkTrackVars=fieldname:s.linkTrackVars.indexOf(a)<0&&(s.linkTrackVars+=","+a)}function scSaveBasePageName(){scBasePageName=s.pageName,scTakeoverPageName=s.pageName}function scRestoreBasePageName(){s.pageName=scBasePageName,scTakeoverPageName=scBasePageName,s.eVar41=s.pageName}function scSaveTakeoverPageName(){scTakeoverPageName=s?s.pageName:""}function scRestoreTakeoverPageName(){s.pageName=scTakeoverPageName,s.eVar41=s.pageName}!function(){"use strict";angular.module("rolb.directives",[]),angular.module("rolb.services",[]),angular.module("appBdlLogin.config",[]),angular.module("appBdlLogin.services",["ngCookies","ngRoute","rolb.services","appBdlLogin.config"]),angular.module("appBdlLogin.controllers",["ngCookies","ngRoute","appBdlLogin.services","appBdlLogin.config"]),angular.module("appBdlLogin.directives",["rolb.directives"]),angular.module("appBdlLogin.filters",[])}(),function(){"use strict";var a=function(a,b,c,d,e,f,g){function h(){return a.resetViaSMS||a.resetViaPost?{newPasscode:{id:"newPasscode",value:"",step:"newPasscodeAndMemorableWord"},newPasscodeConfirm:{id:"newPasscodeConfirm",value:"",step:"newPasscodeAndMemorableWord"},memWord:{id:"memWord",value:"",step:"newPasscodeAndMemorableWord"},memWordConfirm:{id:"memWordConfirm",value:"",step:"newPasscodeAndMemorableWord"}}:{passcode:{id:"passcode",value:"",step:"newPasscodeAndMemorableWord",refId:"passcode"},memWord:{id:"memWord",value:"",step:"newPasscodeAndMemorableWord"},memWordConfirm:{id:"memWordConfirm",value:"",step:"newPasscodeAndMemorableWord"},memorableCharacters:{id:"memorableCharacters",value:"",step:"memCharSelection",refId:"memorablewordchar"}}}function i(){return{lastDigits:{id:"lastDigits",fieldName:"Last Digits",value:"",step:"authTFA"},mobilePinsentryCode:{id:"mobilePinsentryCode",fieldName:"Mobile PINsentry Number",value:"",step:"authMTFA"},phoneNumber:{id:"phoneNumber",fieldName:"Phone Number",value:""}}}function j(a){var b={rdoConfig:[],tabConfig:[]};return _.forEach(a,function(a){switch(a.type){case"MTFA":case"TFA":case"SFA":b.rdoConfig.push({value:a.type,label:a.label}),b.tabConfig.push({heading:a.label,value:a.type,templateUrl:a.templateUrl})}}),b}function k(a,b){return{1:{cls:"width55 memorableWordInputSpaceFirst",ariaLbl:"Please enter "+a+" character of you memorable word",inputLbl:a},2:{cls:"width55 memorableWordInputSpace",ariaLbl:"Please enter "+b+" character of you memorable word",inputLbl:b}}}function l(){return{1:{cls:"widthDesktop8Digit inputFirst4Digit",ariaLbl:"Please enter first four digits of your PIN sentry card reader code"},2:{cls:"widthDesktop8Digit inputSecond4Digit inputSpace4Digit",ariaLbl:"Please enter the last four digits of your PIN sentry card reader code"}}}function m(){return[{row:[{htmlData:"<div class='labelLeftWidth blockInline hidden-xs'><bdl-snippet-content class-names='blink-label gridLabel' ref-id='BDL_MTFA_help_step_1'></bdl-snippet-content></div><div class='iconCenter blockInline imageRight'><img id='pinsentryCard' src='/authlogin/img/PINsentry_mobile_login.png' alt='Mobile PINSentry' class='marginAutoMobile icon-PINsentry-card gridImg'/></div><div class='visible-xs'><bdl-snippet-content class-names='blink-label gridLabel' ref-id='BDL_MTFA_help_step_1'></bdl-snippet-content></div>"},{htmlData:"<div class='labelLeftWidth blockInline hidden-xs'><bdl-snippet-content class-names='blink-label gridLabel' ref-id='BDL_MTFA_help_step_2'></bdl-snippet-content></div><div class='iconCenter blockInline imageRight'><img id='pinsentryIdentifyCard' src='/authlogin/img/PINsentry_mobile_identify.png' alt='Identify Mobile PINSentry' class='marginAutoMobile icon-PINsentryIdentify-card gridImg'/></div><div class='visible-xs'><bdl-snippet-content class-names='blink-label gridLabel ' ref-id='BDL_MTFA_help_step_2'></bdl-snippet-content></div>"}]},{row:[{htmlTemplate:c("authentication/lastGridPINsEntry.html")}]}]}function n(){return[{row:[{htmlTemplate:c("authentication/firstGridCardReader.html")},{htmlData:"<div class='desktopAlign'><img id='pinsentryCardIdentify' src='/authlogin/img/PINsentry_cardreader_identify.png' alt='Insert your card and press identify' class='marginAutoMobile icon-identify-card'/></div><bdl-snippet-content class-names='blink-label' ref-id='BDL_TFA_help_step_2'></bdl-snippet-content>"},{htmlData:"<div class='desktopAlign'><img id='pinsentryCardEnter' src='/authlogin/img/PINsentry_cardreader_enter.png' alt='Enter your card pin and press enter' class='marginAutoMobile icon-enterPin-card'/></div><bdl-snippet-content class-names='blink-label' ref-id='BDL_TFA_help_step_3'></bdl-snippet-content>"}]},{row:[{htmlTemplate:c("authentication/lastGridCardReader.html")}]}]}function o(a){for(var b=new Array,c=97;c<123;c++)b[c-97]={},b[c-97].label=String.fromCharCode(c),b[c-97].value=b[c-97].label;if(!0===a)for(var c=48;c<58;c++)b[c-22]={},b[c-22].label=String.fromCharCode(c),b[c-22].value=b[c-22].label;return b}function p(a){var b;return a&&(a%10==1&&(b="st"),a%10==2&&(b="nd"),a%10==3&&(b="rd"),a%10>=4&&(b="th")),a+b}function q(){return{alertmessage:"<h3 class='alert-heading'>If you log in this way, it'll restrict your access...</h3>",additionalcontent:"<bdl-snippet-content use-btext='false' ref-id='BDL_SFA_info_alert_content'></bdl-snippet-content>"}}function r(){return{alertmessage:'<div class="alert-heading">Have you tried Mobile PINSentry?</div>',additionalcontent:"<bdl-snippet-content use-btext='false' ref-id='BDL_TFA_info_alert_content'></bdl-snippet-content>"}}function t(){return{alertmessage:"<div class='alert-heading marginBottomLockedOut'>You've been locked out from passcode log-in.</div>",additionalcontent:"<bdl-snippet-content use-btext='false' ref-id='BDL_FTB_DFA_Passcode_locked'></bdl-snippet-content>"}}function u(){d.apiService(b.JSON.getScaMobileNumber,{}).then(function(c){a.contentResponse={},a.contentResponse.errorJSON={},c&&(!1===c.header.stopFlow?(a.scaIdentifier=c.body.scaIdentifier,e.changeView(b.VIEWS.scaOtpAuthentication)):C.routeOnError(c))})}function v(c){var d=!0;c.header.messages?angular.forEach(c.header.messages,function(f){"SELF_SERVE_UNLOCK"===f.type?(a.errorPageRedirect=!0,a.selfServeLockedError=c,e.changeView(b.VIEWS.selfServeMemLockedOut),d=!1):"LOCKED"===f.type?(a.errorPageRedirect=!0,a.contentResponse.errorJSON=c,a.lockedOut=!0,e.changeView(b.VIEWS.lockedOut),d=!1):"DFA_LOCK_OUT_SFA"===f.type||"NEW_PASSCODE_AND_MEMORABLE_WORD"===f.type?(a.contentResponse.errorJSON=c,a.forgotPasscodeSuccess=!0,a.userData.data.defaultAuthenticationMethod="SFA",a.submitPress=!1,e.changeView(b.VIEWS.identification),d=!1):"UNLOCK"===f.type&&(a.errorPageRedirect=!0,a.contentResponse.errorJSON=c,a.userData.dateOfBirth=null,a.userData.cardNumber=null,g.getResetViaSMSSwitch(),d=!1)}):c.type&&"CONTEXTUAL_EXCEPTION"===c.type&&(d=!0),d&&(a.errorPageRedirect=!0,a.contentResponse.errorJSON=c,e.changeView(b.VIEWS.identification),a.stopFlow=!0,a.userData={},a.resetViaSMS=!1)}function w(c){var e=a.hiddenHelpCards.filter(function(b){return-1==a.existingHelpCards.indexOf(b)}),f={helpCards:e},g=b.JSON.addHiddenHelpCards,h=d.setRememberMeInfoPostAuthentication(c);d.apiService(g,f).then(function(a){h&&h.rememberMeDVOs&&h.rememberMeDVOs.length>0?d.apiService(b.JSON.rememberUser,h).then(function(a){C.forwardUser(c)}):C.forwardUser(c)})}function x(c){"INTERSTITIAL"===c.body.redirectToken.type?c.body.redirectToken.displayTypeCode?(a.interstitial={},a.interstitial.displayTypeCode=c.body.redirectToken.displayTypeCode,e.changeView(b.VIEWS.interstitial)):!0===c.body.redirectToken.dynamicInterstitialEligible&&"CHANNELAPP"===c.body.redirectToken.appName?(a.$broadcast("loader_on"),window.location.href=c.body.redirectToken.dynamicInterstitialAddress):!0===c.body.redirectToken.dynamicInterstitialEligible&&(a.interstitial={},a.interstitial.dyanmicInterstitialAddress=c.body.redirectToken.dynamicInterstitialAddress,a.interstitial.appName=c.body.redirectToken.appName,e.changeView(b.VIEWS.dynamicInterstitial)):(a.$broadcast("loader_on"),window.location.href=c.body.redirectToken.url)}function y(b,c){d.apiService(b,c).then(function(b){window.scrollTo(0,0),a.contentResponse={},a.contentResponse.errorJSON={},b&&(!1===b.header.stopFlow?(b.body.biocatchToken&&angular.element(document.querySelector("meta[name='bcsid']")).attr("content",""+b.body.biocatchToken.sid),a.userData.data=b.body,f.updateCCPCookie(b.body.verificationToken.membershipNumber).then(function(c){"FEDERATION"===b.body.redirectToken.type?(a.$broadcast("loader_on"),window.location.href=b.body.redirectToken.url+"?REF="+b.body.redirectToken.referenceId):C.sendHiddenHelpCardsAndRoute(b)})):C.routeOnError(b))})}function z(a,c,d){B={data:a,isSFAEligible:d===b.JSON.SFALogin,email:c.body.merchantEmail}}function A(){return B}var B,C={getAuthTypeValues:j,initializeModelValues:h,memCharConfigFn:k,mobilePinsEntryInputConfig:l,initializeTFAModelValues:i,mobilPINSentryGridData:m,cardReaderGridData:n,getMemorableCharOptions:o,getOrdinalNumber:p,passcodeInfoAlertContent:q,tfaInfoAlertContent:r,lockedSFAAlertContent:t,getScaMobileNumber:u,routeOnError:v,sendHiddenHelpCardsAndRoute:w,forwardUser:x,submitLoginRequest:y,setMerchantUserData:z,getMerchantUserData:A};return C};a.$inject=["$rootScope","CONSTANT","partial","services","secureRoute","snippetServices","authLoginUtilService"],angular.module("appBdlLogin.services").factory("authenticationUtilService",a)}(),function(){"use strict";var a=function(a,b,c,d,e,f,g,h,i,j){function k(a){if(void 0!==a.value&&""!==a.value&&null!==a.value)return a.value.replace(/[^0-9]/gi,"").replace(/(.{4})/g,"$1 ").trim()}function l(e){a.unlockMembership=void 0===e||e;var f={};b.apiService(c.JSON.passCodeViaSMSSwitch,f).then(function(b){b.errorCode||(a.resetViaSMS=b.body.switchedOn,d.changeView(c.VIEWS.forgotPasscodeDetails))})}function m(){e(function(){window.scrollTo(0,0);var a=document.querySelector('[name="globalErrorAlert"]');a&&(a.setAttribute("tabindex","-1"),a.focus(),a.removeAttribute("tabindex"))},0)}function n(a){if(void 0!==a&&null!=a)return a.replace(/^[\'|\-|\s]+|[\'|\-|\s]+$/gi,"")}function o(){return window.innerWidth<768}function p(){var b=4;return a.userData.data&&a.userData.data.authenticationTokenSpecificationList&&(angular.forEach(a.userData.data.authenticationTokenSpecificationList,function(a){"TFA"===a.method&&(b=a.digits)}),f.scaCardLastDigits.INP1="Last digits of your card number must contain exactly "+b+" characters",f.lastDigits.INP1="Last digits of your card number must contain exactly "+b+" characters"),b}function q(){return{alt:"back of credit card showing location of security code at the end of the signature box",src:g("cvv-code.svg")}}function r(){return{alt:"Card last digits",src:g("card-last-digits.svg")}}function t(){var a=document.querySelector('[name="$$submit"]');void 0!=a&&a.addEventListener("click",function(){void 0!=AppName.Module.formInstance?AppName.Module.formInstance.formSubmitted=!0:AppName.Module.formInstance={formSubmitted:!0}})}function u(a){return i.post(j(a),{})}function v(){return!b.isEmpty(a.userData)||(d.changeView(c.VIEWS.identification),!1)}function w(){return void 0!==a.userData||(d.changeView(c.VIEWS.identification),!1)}function x(a,b){return b.find(function(b){return b.mobileNumberId===a})}return{formatCardNumber:k,getResetViaSMSSwitch:l,setFocusOnGlobalErrors:m,trimLastname:n,isMobileView:o,getCardLastDigits:p,setCardLastDigitsIcon:r,setCVVIcon:q,addSubmitEventListener:t,loadCMAContent:u,isUserDataSet:v,isRemembermePage:w,getNumberByMobileId:x}};a.$inject=["$rootScope","services","CONSTANT","secureRoute","$timeout","ERROR_MSG","imageUrl","$interval","$http","contentUrl"],angular.module("appBdlLogin.services").factory("authLoginUtilService",a)}(),function(){"use strict";angular.module("appBdlLogin.config").constant("ENV",{apiBasePath:"/olb/authlogin"}).constant("CONSTANT",{VIEWS:{identification:"/identification",authentication:"/authentication",authTFA:"/authTFA",interstitial:"/interstitial",identifyJointAccount:"/identifyJointAccount",rememberMe:"/rememberme",forgotPasscodeDetails:"/forgotPasscodeDetails",forgotPasscodeConfirm:"/forgotPasscodeConfirm",forgotPasscodeSuccess:"/forgotPasscodeSuccess",lockedOut:"/lockedOut",ForgotMembershipDetails:"/forgotMembership",ForgotMembershipSuccess:"/forgotMembershipSuccess",MultipleMemberships:"/multipleMembership",loginMultipleMemDetails:"/logMultipleMemDetails",loginMultipleMemSuccess:"/logMultipleMemSuccess",forgotPasscodeDeliveryMethod:"/forgotPasscodeDeliveryMethodSelection",forgotPasscodeMobileNumber:"/forgotPasscodeMobileNumberConfirm",forgotPasscodeVerificationCode:"/forgotPasscodeVerificationCode",forgotPasscodeReset:"/forgotPasscodeReset",changeFirstTimePasscode:"/changeFirstTimePasscode",dynamicInterstitial:"/dynamicInterstitial",scaCardAuthentication:"/scaCardAuthentication",scaOtpAuthentication:"/scaOtpAuthentication",selfServeMemLockedOut:"/selfServeMemLockedOut",selfServeMemUnlockUserDetails:"/selfServeMemUnlockUserDetails",selfServeMemUnlockOtpAuth:"/selfServeMemUnlockOtpAuth",selfServeMemUnlockSuccess:"/selfServeMemUnlockSuccess",solusMerchantTnc:"/solusMerchantTnc",confirmIdentity:"/confirmIdentity",notification:"/notification",mobilePINSentry:"/mobilePINSentry"},JSON:{contentPath:"content/",loginStep1NoSavedMember:"content/LoginStep1NoSavedMemberDecoupled.json",LoginStep1SingleSavedMember:"content/LoginStep1SingleSavedMemberDecoupled.json",LoginStep1MultipleSavedMembers:"content/LoginStep1MultipleSavedMembersDecoupled.json",firstTimeDFAContent:"content/LoginFirstTimeAsADfaUser.json",DFAContent:"content/LoginStep2DfaUserDecoupled.json",SFAContent:"content/LoginStep2SingleFactor.json",TFAContent:"content/LoginStep2TwoFactorDecoupled.json",MTFAContent:"content/LoginStep2TwoFactorMobileDecoupled.json",LockedOutContent:"content/LockedOutErrorFtb.json",LockedOutStep1Content:"content/LockedOutStep1FtbFragment.json",LockedOutStep2Content:"content/LockedOutStep2FtbFragment.json",LockedOutStep3Content:"content/LockedOutStep3PasscodeReorderedFtbFragment.json",ForgotPasscodeStep1Content:"content/LoginStep2ReorderPasscode.json",ForgotPasscodeStep2Content:"content/LoginStep2ReorderPasscodeConfirmAddress.json",ForgotPasscodeStep3Content:"content/LoginStep2ReorderPasscodeReceived.json",LoginWealthHelpContent:"content/LoginWealthHelpContent.json",LoginPrvBnkHelpContent:"content/LoginPrvBnkHelpContent.json",identifyMembership:"identifyMembership.json",identifyDebitcard:"identifyDebitcard.json",identifyAccountNumber:"identifyAccountNumber.json",identifyRememberMe:"identifyRememberMe.json",identifyMoreInfo:"identifyMoreInfo.json",ForgetUser:"forgetUser.json",rememberUser:"rememberUser.json",getHiddenHelpCards:"getHiddenHelpCards.json",addHiddenHelpCards:"addHiddenHelpCards.json",updateInterstitialPageData:"updateInterstitialPageData.json",getInterstitialPageContent:"getInterstitialPageContent.json",updateInterstitialMarker:"updateInterstitialMarker.json",processError:"processError.json",getAddress:"getAddress.json",getAddressToUnlockUser:"getAddressForLockout.json",reorderPasscode:"reorderPasscode.json",reorderPasscodeToUnlockUser:"reorderPasscodeForLockout.json",FirstTimeSFALogin:"createNewMemorableWord.json",SFALogin:"singleFactorAuthentication.json",TFALogin:"twoFactorAuthentication.json",MTFALogin:"mobileTwoFactorAuthentication.json",FLDMembershipNumberStep1:"content/FLDMembershipNumberStep1.json",FLDMembershipNumberStep2:"content/FLDMembershipNumberStep2.json",FLDMembershipNumberStep3:"content/FLDMembershipNumberStep3.json",retrieveForgotMembershipNumber:"retrieveForgotMembershipNumber.json",retrieveMultipleMembershipNumbers:"retrieveMultipleMembershipNumbers.json",EnhancedCookiesNoticeAuth:"content/EnhancedCookiesNoticeAuth.json",browserAdvisory:"content/browserAdvisory.json",LoginLinkDisplayBrowserAlert:"content/LoginLinkDisplayBrowserAlert.json",browserData:"browserData.json",lockedOutResetPinViaMobilePinSentry:"content/lockedOutResetPinViaMobilePinSentry.json",passCodeViaSMSSwitch:"passCodeViaSMSSwitch.json",reorderPasscodeDeliveryMethodSelection:"reorderPasscodeDeliveryMethodSelection.json",getMobileNumber:"getMobileNumber.json",sendVerificationCodeViaSMS:"sendVerificationCodeViaSMS.json",validateVerificationCode:"validateVerificationCode.json",ForgotPasscodeStep2bDeliveryMethod:"content/LoginStep2ReorderPasscodeSelection.json",ForgotPasscodeStep2bMobileNumber:"content/LoginStep2ReorderPasscodeConfirmMobileNumber.json",NewPasscodeAndMemorableWordSFALogin:"createNewPasscodeAndMemorableWord.json",authSFA:"content/authSFA.json",forgotPasscodeVerificationCodeEntry:"content/forgotPasscodeVerificationCodeEntry.json",ForgotPasscodeStep3VerificationCode:"content/LoginStep2ReorderPasscodeEnterAuthCode.json",changeFirstTimePasscodeSwitch:"changeFirstTimePasscodeSwitch.json",validateFirstTimePasscode:"validateFirstTimePasscode.json",loginStep2ChangeFirstTimePasscode:"content/LoginStep2ReorderPasscodeViaPost.json",identityAccountInfo:"identityAccountInfo.json",tiaaDropoff:"tiaaDropoff.json",tiaaPickup:"tiaaPickup.json",identityProviderAuthentication:"identityProviderAuthentication.json",identityCustomerAndAccountDetails:"identityCustomerAndAccountDetails.json",checkSolusSwitch:"checkSolusSwitch.json",retrieveAccountTypes:"retrieveAccountTypes.json",retrieveCountryList:"retrieveCountryList.json",SRPFooterContent:"content/SRPFooterContent.json",threatMetrixProfiling:"threatMetrixProfiling.json",scaCardAuthentication:"scaAuthentication.json",scaCardAuthenticationContent:"content/LoginStrongCustomerAuthentication.json",getScaMobileNumber:"getScaMobileNumber.json",validateOneTimeCode:"validateOneTimeCode.json",sendOneTimeCode:"sendOneTimeCode.json",scaOtpAuthenticationContent:"content/LoginOneTimePassCodeAuthentication.json",getMobileDetails:"getMobileDetails.json",validateMembershipUnlockOneTimeCode:"validateMembershipUnlockOneTimeCode.json",SelfServeMembershipUnlock:"content/SelfServeMembershipUnlock.json",SelfServeMembershipUnlockOTPAuthentication:"content/SelfServeMembershipUnlockOTPAuthentication.json",SelfServeMembershipUnlockSuccess:"content/SelfServeMembershipUnlockSuccess.json",SelfServeMembershipLockedOut:"/content/SelfServeMembershipLockedOut.json",keepAlive:"keepAlive.json",sessionTimeoutCheck:"sessionTimeoutCheck.json",merchantAuthentication:"merchantSingleFactorAuthentication.json",sendPushNotification:"sendPushNotification.json",pushNotificationAuthenticationVerification:"pushNotificationAuthenticationVerification.json",identifyTrustAnchor:"identifyTrustAnchor.json",confirmNotification:"confirmNotification.json",validateOTPCode:"validateOTPCode.json"},SC:{},Identification:{},IdentityProvider:{},Authentication:{},VAR:{PERSONAL:"PERSONAL",BUSINESS_AND_PERSONAL:"BUSINESS_AND_PERSONAL",BUSINESS:"BUSINESS",MEMBER_SUSPEND:"MEMBER_SUSPEND",TFA_MTFA_LOCKOUT:"TFA_MTFA_LOCKOUT",SFA_LOCKOUT:"SFA_LOCKOUT",DFA:"DFA",SFA_MTFA:"SFA_MTFA",DFA_MTFA:"DFA_MTFA",UNKNOWN:"UNKNOWN",SFA_LOCKOUT_REORDER:"SFA_LOCKOUT_REORDER",NORMAL:"NORMAL",SOLUS_SFA:"SOLUS_SFA",SFA:"SFA",TFA_MTFA:"TFA_MTFA",TFA:"TFA",PASSCODE_EXPIRED:"PASSCODE_EXPIRED",Passcode_expired:"Passcode expired",MEMBERSHIP_LOCKED:"Membership locked",Member_suspended:"Member suspended",PASSCODE_ONLY:"Passcode log-in only",PASSODE_WITHOUT_PINSENTRY:"Passcode log-in only - no PINsentry set-up",MOBILE_PINSENTRY_OR_PASSCODE:"App ID/Mobile PINsentry or passcode log-in",MBILE_AND_CARD_PINSENTRY_OR_PASSCODE:"App ID/Mobile PINsentry, card PINsentry or passcode log-in",MOBILE_AND_CARD_PINSENTRY_NO_PASSCODE:"App ID/Mobile PINsentry or card PINsentry log-in only - no passcode set-up",CARD_PINSEMTRY_NO_PASSCODE:"Card PINsentry log-in only - no passcode set-up",CARD_PINSENTRY_PASSCODE:"Card PINsentry or passcode log-in",MOBILE_OR_CARD_PINSENTRY_AND_PASSCODE_LOCKED:"App ID/Mobile PINsentry or Card PINsentry log-in only - passcode locked",CARD_PINSENTRY_AND_PASSCODE_LOCKED:"Card PINsentry log-in only - passcode locked",MOBILE_AND_PASSCODE_LOCKED:"App ID/Mobile PINsentry log-in only - passcode locked",PERSONAL_ONLY_MEMBERSHIP:"Personal only membership",BUSINESS_ONLY_MEMBERSHIP:"Business only membership",BAP_ONLY_MEMBERSHIP:"Business and Personal membership",PERSONAL_TPA_MEMBERSHIP:"Personal membership (with Third Party Access / Power of Attorney)",BUSINESS_TPA_MEMBERSHIP:"Business only membership (with Third Party Access / Power of Attorney)",BAP_TPA_MEMBERSHIP:"Business and Personal membership (with Third Party Access / Power of Attorney)",NO_CREDENTIAL:"NO_CREDENTIAL",ORDER_A_NEW_PASSCODE:"Order a new passcode",HOW_TO_UNLOCK_YOUR_MEMBERSHIP:"How to unlock your membership",CANNOT_REORDER:"CANNOT_REORDER",SUCCESS:"SUCCESS",CURRENT_SAVINGS_ACCOUNT:"Current-savings account",MORTGAGE:"Mortgage",SOLUS_MERCHANT_ACCOUNT:"Merchant account",PASSCODE_DELIVERY_METHODS:{SMS:"text",POST:"post"},FORGOT_PASSCODE:"forgottenPasscode",UNLOCK_MEMBERSHIP:"unlockmembership",SUBMIT_SUSPENDED:"submitSuspend",SELF_SERVE_UNLOCK:"SELF_SERVE_UNLOCK",LOGIN_TIMEOUT_DURATION:"600000",LOGIN_TIMER_COUNTDOWN:"600",MERCHANT_SOLUS:"MERCHANT_SOLUS",POLLING_INITIAL_DELAY:"30000",POLLING_INTERVAL:"5000",TA_SERVER_ERROR_CODE:80223},URL:{BTRHome:"/olb/balances/PersonalFinancialSummary.action",LogOff:"/olb/authlogin/logoff.do",SuspendedMembership:"http://www.personal.barclays.co.uk/goto/pfs_olb_accountsuspended",registrationURL:"/olb/auth/RegistrationLink_display.action",wealthRegistrationURL:"/olb/auth/SpeedyRegistrationStep1.action",decoupledRegistrationURL:"/olb/registration/registerAppContainer.do",decoupledLoginURL:"/olb/authlogin/loginAppContainer.do",decoupledLoginURLSessionError:"/olb/authlogin/loginAppContainer.do?error=505",contactUsURL:"/olb/authlogin/contactUsContainer.do#/contactUs",contactUsLegacyURL:"http://www.barclays.co.uk/Contactus/Contactus/P1242561757335",redirectUrlError1:"/olb/auth/LoginLink.action?error=501",LogOffDecoupled:"/olb/authlogin/logoff.do",BarclaysHomePage:"https://www.barclays.co.uk/",NeedMoreHelpWintc:"https://wealth.barclays.com/en_gb/home/international-banking/others/contact-us.html",NeedMoreHelpPbc:"https://privatebank.barclays.com/contact-us/",NeedMoreHelp:"https://www.barclays.co.uk/help/contact-us/"},ViewRouteTo:{decoupledSpeedyRegStep1:"#/speedy-user-details"},RequestParameters:{WealthParameter:"mbrtyp"}})}(),function(){"use strict";angular.module("appBdlLogin.config").constant("ERROR_MSG",{surname:{required:"You must enter your last name",INP1:"You must enter at least 2 characters",INP2:"Your name must contain only letters, spaces, or the characters ' or -",INP3:"Your name cannot contain consecutive spaces, apostrophes or hyphens"},membership:{required:"You must enter a membership number",INP1:"Membership number must contain exactly 12 characters",INP2:"Membership number must contain only numeric characters",INP3:"Please check that you've entered the correct membership number"},cardNumber:{required:"You must enter a card number",INP1:"Card number must be exactly 16 digits",INP2:"Please enter a valid card number",INP3:"Please enter your card number again and check that all 16 digits are correct"},sortCode:{required:"You must enter sort code",INP1:"You must enter a valid  sort code",INP2:"Please check that you've entered the correct sort code and account number"},accountNumber:{required:"You must enter an account number",INP1:"Your account number must be exactly eight digits",INP2:"Your account number must contain only numeric characters"},mortgage:{required:"You must enter an mortage number",INP1:"Mortgage number must be exactly 9 digits",INP2:"Mortgage number must contain only numeric characters"},secCode:{required:"You must enter a security code",INP1:"Security must be exactly 3 digits",INP2:"Secuurity number must contain only numeric characters"},investment:{required:"You must enter an investment account number",INP1:"Security must be exactly 3 digits",INP2:"Secuurity number must contain only numeric characters"},passcode:{required:"You must enter your passcode",INP1:"Passcode must contain exactly 5 characters",INP2:"Passcode must contain only numeric characters"},newPasscode:{required:"You must enter your passcode",INP1:"Passcode must contain exactly 5 characters",INP2:"Passcode must contain only numeric characters",INP3:"Your passcodes must match"},newPasscodeConfirm:{required:"You must enter your passcode",INP1:"Passcode must contain exactly 5 characters",INP2:"Passcode must contain only numeric characters",INP3:"Your passcodes must match"},memWord:{required:"You must enter your memorable word",INP1:"Your memorable word must be between six and eight characters , and can contain letters and/ or numbers",INP2:"Your memorable word must be between six and eight characters , and can contain only letters",INP3:"Your memorable words must match"},memWordConfirm:{required:"You must enter your memorable word",INP1:"Your memorable word must be between six and eight characters , and can contain letters and/ or numbers",INP2:"Your memorable word must be between six and eight characters , and can contain only letters",INP3:"Your memorable words must match"},memorableCharacters:{required:"The memorable word field is required",INP1:"The details you have entered are incorrect"},mobilePinsentryCode:{required:"You must enter your PINsentry number",INP1:"You must enter a valid PINsentry number"},lastDigits:{required:"You must enter the last digits of your card number",INP1:"Last digits of your card number must contain exactly 4 characters",INP2:"Last digits of your card number must contain only numeric characters"},scaCardLastDigits:{required:"You must enter the last digits of your card number",INP1:"Last digits of your card number must contain exactly 4 characters",INP2:"Last digits of your card number must contain only numeric characters"},browserAlertConfirmation:{required:"You must check the box to continue"},phoneNumber:{required:"Please enter a phone number first.",INP1:"Please enter a valid mobile phone number (starting 07 or +447).",INP2:"Your telephone number may only contain numbers 0-9 and the + symbol.",INP3:"The mobile number entered is not the correct length. Please double check and try again."},securityCode:{required:"You must enter a valid security code",INP1:"Security code must be exactly 3 digits",INP2:"Security code must contain only numeric characters"},scaSecurityCode:{required:"You must enter a valid security code",INP1:"Security code must be exactly 3 digits",INP2:"Security code must contain only numeric characters"},mortgageNumber:{required:"You must enter your mortgage number",INP1:"Your mortgage number should contain 10 digits",INP2:"Your mortgage number must start with 9 followed by 9 digits"},solusAccountNumber:{required:"You must enter your account number",INP1:"Your account number must contain two letters followed by ten digits"},verificationCode:{required:"You must enter a valid verification code",INP1:"Verification code must contain exactly 6 characters",INP2:"Verification code must contain only numeric characters"},scaVerificationCode:{required:"You must enter a valid verification code",INP1:"Verification code must contain exactly 6 characters",INP2:"Verification code must contain only numeric characters"},confirmation:{required:"You must check the box to continue"},countryDropdown:{required:"Please select country of nationality"},emailInput:{required:"Please enter your email address",INP1:"Please enter a valid email address"},merchantId:{required:"Please enter your merchant ID",INP1:"Please enter a valid merchant ID",INP2:"Please enter a valid merchant ID"},settlementAccNo:{required:"Please enter your settlement account number",INP1:"Please enter a valid settlement account number",INP2:"Please enter a valid settlement account number"},settlementAccSortcode:{required:"Please enter your settlement account sort code",INP1:"Please enter a valid settlement account sort code",INP2:"Please enter a valid settlement account sort code"}})}(),function(){"use strict";var a=function(a){function b(a){return void 0==a||void 0==a.content||""==a.content?null:{arrowPosition:"left center",boxPosition:"right center",qtipContent:{text:a.content,customAriaText:$("<div>").html(a.content).text()},iconClass:"icon-question",mobileConfig:{arrowPosition:"bottom center",boxPosition:"top center"}}}return{dssTooltipConfig:b}};a.$inject=["$rootScope"],angular.module("appBdlLogin.services").factory("dssTooltipService",a)}(),function(){"use strict";var a=function(a,b,c,d,e,f){function g(){return{dateOfBirth:{value:""},accountType:{accounts:[{id:"Current-savings account",accountId:"Current-savings account",accountName:"Current/savings account"}],value:"Current-savings account"},countryList:{countries:[],value:-1},securityCode:{value:null,label:"Security code"},mortgageNumber:{value:"9"},solusAccNumber:{value:"ID"},cardNumber:{value:null},merchantId:{value:null},sortCode:{value:""},settlementAccNo:{value:null},resetViaSMS:a.resetViaSMS,unlockMembership:void 0!==a.unlockMembership&&a.unlockMembership}}function h(){return[{number:1,text:"Your details",active:!0},{number:2,text:"Passcode delivery"},{number:3,text:"Confirmation"},{number:4,text:"Complete"}]}function i(){return[{number:1,text:"Your details",complete:!0},{number:2,text:"Passcode delivery",active:!0},{number:3,text:"Confirmation"},{number:4,text:"Complete"}]}function j(){return[{number:1,text:"Your details",complete:!0},{number:2,text:"Passcode delivery",active:!0,ProgressRange:"50%"},{number:3,text:"Confirmation"},{number:4,text:"Complete"}]}function k(){return[{number:1,text:"Your details",complete:!0},{number:2,text:"Passcode delivery",complete:!0,ProgressRange:"100%"},{number:3,text:"Confirmation",active:!0},{number:4,text:"Complete"}]}function l(){return[{number:1,text:"Your details",active:!0},{number:2,text:"Confirmation"},{number:3,text:"Complete"}]}function m(){return[{number:1,text:"Your details",complete:!0},{number:2,text:"Confirmation",active:!0},{number:3,text:"Complete"}]}function n(){return{dayClass:"DOBInput",monthClass:"DOBInput",yearClass:"DOBInput"}}function o(){return{1:{cls:"col-xs-6 col-sm-3 col-md-4 col-lg-3",ariaLbl:"First pair of Account number"},2:{cls:"col-xs-3 col-sm-2 col-md-2 col-lg-2",ariaLbl:"second pair of Account number"}}}function p(b){var c={};switch(b.accountType.value){case"Current-savings account":var d=b.cardNumber.value.split(" ");c={debitCardToken:{debitCard1:d[0],debitCard2:d[1],debitCard3:d[2],debitCard4:d[3],securityCode:b.securityCode.value},dateOfBirth:b.dateOfBirth.value.replace(/\//g,"")};break;case"Mortgage":c={dateOfBirth:b.dateOfBirth.value.replace(/\//g,""),accountType:b.accountType.value,accountNumber:b.mortgageNumber.value};break;case"Merchant account":c={dateOfBirth:b.dateOfBirth.value.replace(/\//g,""),accountType:b.accountType.value,merchantId:b.merchantId.value,sortcode:b.sortCode.value,settlementAccNo:b.settlementAccNo.value};break;default:c={dateOfBirth:b.dateOfBirth.value.replace(/\//g,""),accountType:b.accountType.value,accountNumber:b.solusAccNumber.value,countryCode:b.countryList.value}}return a.forgotUserData=r(b),c}function q(b){var c={};switch(b.accountType.value){case"Current-savings account":var d=b.cardNumber.value.split(" ");c={identityToken:{debitCard:{debitCard1:d[0],debitCard2:d[1],debitCard3:d[2],debitCard4:d[3]},dateOfBirth:b.dateOfBirth.value.replace(/\//g,""),surname:b.surname.value.toString()}};break;case"Mortgage":c={identityToken:{dateOfBirth:b.dateOfBirth.value.replace(/\//g,""),accountType:b.accountType.value,accountNumber:b.mortgageNumber.value,surname:b.surname.value.toString()}};break;case"Merchant account":c={identityToken:{surname:b.surname.value.toString(),dateOfBirth:b.dateOfBirth.value.replace(/\//g,""),accountType:b.accountType.value,merchantId:b.merchantId.value,sortcode:b.sortCode.value,settlementAccNo:b.settlementAccNo.value}};break;default:c={identityToken:{dateOfBirth:b.dateOfBirth.value.replace(/\//g,""),accountType:b.accountType.value,accountNumber:b.solusAccNumber.value,countryCode:b.countryList.value,surname:b.surname.value.toString()}}}return a.forgotUserData=r(b),c}function r(a){var b={};switch(a.accountType.value){case"Current-savings account":b={model:{dateOfBirth:a.dateOfBirth,accountType:a.accountType,cardNumber:a.cardNumber,securityCode:a.securityCode},forgotAccountDetails:{name:"Card number",value:a.cardNumber.value}};break;case"Mortgage":b={model:{dateOfBirth:a.dateOfBirth,accountType:a.accountType,mortgageNumber:a.mortgageNumber},forgotAccountDetails:{name:"Mortgage number",value:a.mortgageNumber.value}};break;case"Merchant account":b={model:{dateOfBirth:a.dateOfBirth,accountType:a.accountType,merchantId:a.merchantId,sortCode:a.sortCode,settlementAccNo:a.settlementAccNo},forgotAccountDetails:{name:"Settlement account number",value:a.settlementAccNo.value}};break;default:b={model:{dateOfBirth:a.dateOfBirth,accountType:a.accountType,solusAccNumber:a.solusAccNumber,countryList:a.countryList},forgotAccountDetails:{name:"Account number",value:a.solusAccNumber.value}}}return b}function t(c){var d=p(c.model),e=b.JSON.getAddress;return!0===a.resetViaSMS&&(e=b.JSON.reorderPasscodeDeliveryMethodSelection),{apiName:e,requestParam:d}}function u(c){var d={};return window.otpServiceApiMigrationSwitch?(d.requestParam={mobileNumberIdentifier:e.getNumberByMobileId(c.model.mobileNumber.value,fa)},d.apiName=b.JSON.sendOneTimeCode):(d.requestParam=p(a.forgotUserData.model),d.apiName=b.JSON.sendVerificationCodeViaSMS,d.requestParam.textSMSRadioButton=!0),d}function v(){var c=p(a.forgotUserData.model);return c.textSMSRadioButton=!0,{apiName:b.JSON.getMobileNumber,requestParam:c}}function w(c){var d=p(a.forgotUserData.model);return d.textSMSRadioButton=!0,d.verificationCode=c.model.verificationCode.value,{apiName:b.JSON.validateVerificationCode,requestParam:d}}function x(){if("Mortgage"!==a.forgotUserData.model.accountType.value&&"Current-savings account"!==a.forgotUserData.model.accountType.value)var c=p(a.forgotUserData.model);return{apiName:b.JSON.reorderPasscode,requestParam:c}}function y(a,c){var d={passcode:a.model.newPasscode.value,secondPasscode:a.model.newPasscodeConfirm.value,firstMemorableWord:a.model.memWord.value,secondMemorableWord:a.model.memWordConfirm.value,mobile:c,forgotPasscode:!0};return{apiName:b.JSON.NewPasscodeAndMemorableWordSFALogin,requestParam:d}}function z(a){var c=q(a.model);return{apiName:b.JSON.retrieveForgotMembershipNumber,requestParam:c}}function A(a){var b,c="";if(null!==a.accessDate.lastSuccessfulLoginDate&&""!==a.accessDate.lastSuccessfulLoginDate?b=a.accessDate.lastSuccessfulLoginDate:null!==a.accessDate.registerDate&&""!==a.accessDate.registerDate&&(b=a.accessDate.registerDate),null!==b&&""!==b&&void 0!==b){var d=new Date(b.substring(2,4)+"/"+b.substring(0,2)+"/"+b.substring(4,8)),e=["January","February","March","April","May","June","July","August","September","October","November","December"],f=e[d.getMonth()];c=b.substring(0,2)+" "+f+" "+b.substring(4,8)}return{lastSuccessfulLogin:c}}function B(a){var c;return a.loginStatus!==b.VAR.MEMBER_SUSPEND&&(a.memberType===b.VAR.PERSONAL&&a.thirdPartyAccess&&(c=b.VAR.PERSONAL_TPA_MEMBERSHIP),a.memberType===b.VAR.BUSINESS_AND_PERSONAL&&a.thirdPartyAccess&&(c=b.VAR.BAP_TPA_MEMBERSHIP),a.memberType===b.VAR.BUSINESS&&a.thirdPartyAccess&&(c=b.VAR.BUSINESS_TPA_MEMBERSHIP),a.memberType!==b.VAR.BUSINESS||a.thirdPartyAccess||(c=b.VAR.BUSINESS_ONLY_MEMBERSHIP),a.memberType!==b.VAR.PERSONAL||a.thirdPartyAccess||(c=b.VAR.PERSONAL_ONLY_MEMBERSHIP),a.memberType!==b.VAR.BUSINESS_AND_PERSONAL||a.thirdPartyAccess||(c=b.VAR.BAP_ONLY_MEMBERSHIP),a.memberType===b.VAR.MERCHANT_SOLUS&&(c=b.VAR.SOLUS_MERCHANT_ACCOUNT)),{membershipType:c}}function C(a){var c;if(a.loginStatus===b.VAR.NORMAL)switch(a.loginOption){case b.VAR.SOLUS_SFA:c=b.VAR.PASSCODE_ONLY;break;case b.VAR.SFA:c=b.VAR.PASSODE_WITHOUT_PINSENTRY;break;case b.VAR.SFA_MTFA:c=b.VAR.MOBILE_PINSENTRY_OR_PASSCODE;break;case b.VAR.DFA_MTFA:c=b.VAR.MBILE_AND_CARD_PINSENTRY_OR_PASSCODE;break;case b.VAR.TFA_MTFA:c=b.VAR.MOBILE_AND_CARD_PINSENTRY_NO_PASSCODE;break;case b.VAR.TFA:c=b.VAR.CARD_PINSEMTRY_NO_PASSCODE;break;case b.VAR.DFA:c=b.VAR.CARD_PINSENTRY_PASSCODE;break;default:c=""}else if(a.loginOption&&D(a))c=b.VAR.MEMBERSHIP_LOCKED;else if(a.loginStatus===b.VAR.SFA_LOCKOUT_REORDER)switch(a.loginOption){case b.VAR.DFA_MTFA:c=b.VAR.MOBILE_OR_CARD_PINSENTRY_AND_PASSCODE_LOCKED;break;case b.VAR.DFA:c=b.VAR.CARD_PINSENTRY_AND_PASSCODE_LOCKED;break;case b.VAR.SFA_MTFA:c=b.VAR.MOBILE_AND_PASSCODE_LOCKED}else a.loginOption&&a.loginStatus===b.VAR.PASSCODE_EXPIRED?c=b.VAR.Passcode_expired:a.loginOption===b.VAR.SELF_SERVE_UNLOCK&&a.loginStatus===b.VAR.SELF_SERVE_UNLOCK?c=b.VAR.MEMBERSHIP_LOCKED:a.loginStatus===b.VAR.MEMBER_SUSPEND&&(c=b.VAR.Member_suspended);return{loginMethod:c}}function D(a){var c=a.loginStatus,d=a.loginOption;return""!==d&&d!==b.VAR.UNKNOWN&&((c===b.VAR.TFA_MTFA_LOCKOUT||c===b.VAR.SFA_LOCKOUT_REORDER||c===b.VAR.SFA_LOCKOUT||c===b.VAR.SELF_SERVE_UNLOCK)&&(c!==b.VAR.SFA_LOCKOUT_REORDER||d!==b.VAR.DFA&&d!==b.VAR.SFA_MTFA&&d!==b.VAR.DFA_MTFA))}function E(a){var c,d,e=!1;return a.loginOption&&a.loginStatus===b.VAR.PASSCODE_EXPIRED||a.loginOption===b.VAR.SFA_MTFA&&a.loginStatus===b.VAR.SFA_LOCKOUT_REORDER||a.loginOption===b.VAR.SFA_MTFA&&a.loginStatus===b.VAR.TFA_MTFA_LOCKOUT||a.loginOption&&a.loginOption!==b.VAR.DFA_MTFA&&a.loginOption!==b.VAR.DFA&&a.loginOption!==b.VAR.SFA_MTFA&&a.loginOption!==b.VAR.UNKNOWN&&(a.loginStatus===b.VAR.TFA_MTFA_LOCKOUT||a.loginStatus===b.VAR.SFA_LOCKOUT_REORDER)&&(a.loginOption!==b.VAR.TFA||a.loginStatus!==b.VAR.TFA_MTFA_LOCKOUT)?(c=b.VAR.ORDER_A_NEW_PASSCODE,e=!0,d=b.VAR.FORGOT_PASSCODE):a.loginStatus===b.VAR.SFA_LOCKOUT?(c=b.VAR.ORDER_A_NEW_PASSCODE,e=!0,d=b.VAR.UNLOCK_MEMBERSHIP):a.loginOption!==b.VAR.TFA&&a.loginOption!==b.VAR.DFA&&a.loginOption!==b.VAR.DFA_MTFA||a.loginStatus!==b.VAR.TFA_MTFA_LOCKOUT?a.loginOption===b.VAR.SELF_SERVE_UNLOCK&&a.loginStatus===b.VAR.SELF_SERVE_UNLOCK?(c=b.VAR.HOW_TO_UNLOCK_YOUR_MEMBERSHIP,e=!0,d=b.VAR.SELF_SERVE_UNLOCK):a.loginStatus===b.VAR.MEMBER_SUSPEND?(c=b.VAR.HOW_TO_UNLOCK_YOUR_MEMBERSHIP,e=!0,d=b.VAR.SUBMIT_SUSPENDED):a.loginStatus!==b.VAR.NO_CREDENTIAL&&a.loginOption!==b.VAR.UNKNOWN||(c=b.VAR.HOW_TO_UNLOCK_YOUR_MEMBERSHIP,e=!0,d=b.VAR.UNLOCK_MEMBERSHIP):(c=b.VAR.HOW_TO_UNLOCK_YOUR_MEMBERSHIP,e=!0,d=b.VAR.UNLOCK_MEMBERSHIP),{eligible:e,label:c,eventMethod:d}}function F(){return"Card number"===a.forgotUserData.forgotAccountDetails.name?"**** **** **** "+a.forgotUserData.forgotAccountDetails.value.slice(-4):a.forgotUserData.forgotAccountDetails.value}function G(){return{columns:[{field:"surname",display:"Surname/Last name"},{field:"dob",display:"Date of birth"},{field:"cardNo",display:a.forgotUserData.forgotAccountDetails.name},{field:"address",display:"Delivery address"}],rows:{surname:[{text:a.userData.surname,class:"light inline"}],dob:[{text:a.forgotUserData.model.dateOfBirth.value,class:"light inline"}],cardNo:[{text:F(),class:"light inline"}],address:[{text:a.forgotPasscodeAddressInfo.body.address[0],class:"light block"},{text:a.forgotPasscodeAddressInfo.body.address[1],class:"light block"}]}}}function H(){return{columns:[{field:"surname",display:"Last name"},{field:"dob",display:"Date of birth"},{field:"merchantId",display:"Merchant ID"},{field:"sortcode",display:"Settlement sort code"},{field:"settlementAccNo",display:"Settlement account number"},{field:"address",display:"Delivery address"}],rows:{surname:[{text:a.userData.surname,class:"light inline"}],dob:[{text:a.forgotUserData.model.dateOfBirth.value,class:"light inline"}],merchantId:[{text:a.forgotUserData.model.merchantId.value,class:"light inline"}],settlementAccNo:[{text:a.forgotUserData.model.settlementAccNo.value,class:"light inline"}],sortcode:[{text:a.forgotUserData.model.sortCode.value,class:"light inline"}],address:[{text:a.forgotPasscodeAddressInfo.body.address[0],class:"light block"},{text:a.forgotPasscodeAddressInfo.body.address[1],class:"light block"}]}}}function I(a,c){var d,e=!1;if(a.dormant){var f=!1,g=!1;a.memberType!==b.VAR.BUSINESS&&a.memberType!==b.VAR.BUSINESS_AND_PERSONAL||!0===a.thirdPartyAccess||(f=!0),a.memberType!==b.VAR.BUSINESS&&a.memberType!==b.VAR.PERSONAL&&a.memberType!==b.VAR.BUSINESS_AND_PERSONAL||!0!==a.thirdPartyAccess||(g=!0),(f||g&&f)&&(d=c.snippets.FTB_business_dormant_membership.content,e=!0),g&&!f&&(d=c.snippets.FTB_TPA_dormant_membership.content,e=!0)}return{content:d,isEligible:e}}function J(a){return{columns:[{field:"accountType",display:"Account type"},{field:"lastLogin",display:null!=a.accessDate.lastSuccessfulLoginDate?"Last log in":"Registered"},{field:"loginMethod",display:"Ways to log in"}],rows:{accountType:[{text:this.getMembershipType(a).membershipType,class:"light inline"}],lastLogin:[{text:this.getLastLoginDate(a).lastSuccessfulLogin,class:"light inline"}],loginMethod:[{text:this.getLoginMethod(a).loginMethod,class:"light inline"}]}}}function K(a,c){return a.loginStatus===b.VAR.MEMBER_SUSPEND?{membershipNumber:a.membershipNumber,dormant:a.dormant,isSuspended:!0,loginStatus:a.loginStatus,loginOption:a.loginOption,showForgetIdLink:!1,suspendedMessage:c.snippets.BDL_FTB_suspended_membership.content}:{membershipNumber:a.membershipNumber,memberType:a.memberType,thirdPartyAccess:a.thirdPartyAccess,forename:a.forename,surname:a.surname,dormant:a.dormant,isSuspended:!1,buttonDetails:this.getButtonEligibilityAndData(a),lockedUser:this.getLoginStatusCheck(a),loginOption:a.loginOption,loginStatus:a.loginStatus,showForgetIdLink:!1,membershipInformationTable:this.getMembershipInformationTable(a),checkbox:this.getMembershipRememberMeCheckboxConfig(),rememberMeChecked:[],radioModel:[{value:a.membershipNumber,label:a.membershipNumber}]}}function L(a,c){var e=d.assist2;return a.loginStatus===b.VAR.MEMBER_SUSPEND?{membershipNumber:a.membershipNumber,loginStatus:a.loginStatus,isSuspended:!0,suspendedMessage:c.snippets.BDL_FTB_suspended_membership.content}:{isSuspended:!1,membershipNumber:a.membershipNumber,forename:a.forename,surname:a.surname,buttonDetails:this.getButtonEligibilityAndData(a),membershipInformationTable:this.getMembershipInformationTable(a),loginOption:a.loginOption,loginStatus:a.loginStatus,showForgetIdLink:!!(e&&e.indexOf(a.membershipNumber)>-1),checkbox:this.getMembershipRememberMeCheckboxConfig()}}function M(){a.userData.data.memberInfos.sort(function(a,b){return a.membershipNumber-b.membershipNumber})}function N(){var c;for(var d in a.userData.data.memberInfos){var e=a.userData.data.memberInfos[d];if(e.loginStatus!==b.VAR.MEMBER_SUSPEND&&!this.getLoginStatusCheck(e)&&"SELF_SERVE_UNLOCK"!==e.loginOption){c=!1;break}c=!0}return c}function O(){return[{value:"checked",display:"Remember my membership number on this device",disabled:!1}]}function P(a){var b=_.find(a,function(a){return!a.membershipInfo.isDisabled});return void 0!==b?b.membershipInfo.membershipNumber:{}}function Q(a){for(var c,d=0;d<a.length;d++){var e=a[d].membershipInfo;if(!e.isDisabled&&""!==e.membershipNumber&&!e.dormant){if(e.loginStatus!==b.VAR.TFA_MTFA_LOCKOUT&&e.loginStatus!==b.VAR.SFA_LOCKOUT_REORDER&&e.loginStatus!==b.VAR.SFA_LOCKOUT&&e.loginStatus!==b.VAR.SELF_SERVE_UNLOCK){c=e.membershipNumber;break}c=""}}return c}function R(){return{show:!0,showBackButton:!1,notification:{type:"success",data:{heading:"We've got your membership number",subheading:["Your membership number is below"]}}}}function S(e,f){var g=d.assist2;g&&angular.forEach(g.split("&"),function(d,g){if(d&&d.split("#")[0]===f){var h={index:g},i=b.JSON.ForgetUser;c.apiService(i,h).then(function(b){b.errorCode||(!1===b.header.stopFlow?e&&e.length>0&&angular.forEach(e,function(a,b){a.membershipInfo.membershipNumber===f&&(a.membershipInfo.showForgetIdLink=!1)}):(a.serviceError=!0,a.contentResponse.errorJSON=b))})}})}function T(c){var d=!0;angular.forEach(c.header.messages,function(g){"SELF_SERVE_UNLOCK"===g.type?(a.errorPageRedirect=!0,a.contentResponse.errorJSON=c,f.changeView(b.VIEWS.selfServeMemLockedOut),d=!1):"LOCKED"===g.type?(a.contentResponse.errorJSON=c,a.lockedOut=!0,f.changeView(b.VIEWS.lockedOut),d=!1):"UNLOCK"===g.type&&(a.errorPageRedirect=!0,a.contentResponse.errorJSON=c,a.userData.dateOfBirth=null,a.userData.cardNumber=null,a.forgotMembership=!1,e.getResetViaSMSSwitch(),d=!1,c.body&&(a.userData.data=c.body,a.tfaSwitched=c.body.tfaSwitched))}),d&&(a.serviceError=!0,a.contentResponse.errorJSON=c)}function U(b){a.forgotUserData={},a.userData.loginType="membership",a.userData.membershipNum=b,a.identityRequired=!0,e.getResetViaSMSSwitch(!1)}function V(e){var f,g;if(e.fromRememberMeCookie)f=b.JSON.identifyRememberMe,g={index:0};else{a.userData.loginType="membership",a.userData.surname=a.userData.surname.toString(),void 0===e.user||1===e.usersInfo.length?a.userData.membershipNum=e.userData.data.memberInfos[0].membershipNumber.toString():a.userData.membershipNum=e.user.membershipNumbers,g={identityToken:{surname:a.userData.surname,membershipNumber:a.userData.membershipNum},rememberToken:!1};var h=new Array;angular.forEach(e.usersInfo,function(b){void 0!==b.membershipInfo.rememberMeChecked&&"checked"===b.membershipInfo.rememberMeChecked[0]&&""!==b.membershipInfo.membershipNumber&&(h.push({forename:b.membershipInfo.forename,identityToken:{surname:b.membershipInfo.surname,membershipNumber:b.membershipInfo.membershipNumber}}),a.userData.membershipNum===b.membershipInfo.membershipNumber&&(g.rememberToken=!0))}),f=b.JSON.identifyMembership}var i=c.setRememberMeInfoPreAuthentication(h);i&&i.rememberMeDVOs&&i.rememberMeDVOs.length>0?(a.rememberMeInfoStep1=[],c.apiService(b.JSON.rememberUser,i).then(function(b){window.scrollTo(0,0),a.contentResponse={},a.contentResponse.errorJSON={},!1===b.header.stopFlow?(d.assist2&&d.assist2.indexOf(g.identityToken.membershipNumber)>-1&&(a.authForgetId=!0),ha.continueToAuthenticationScreen(f,g)):a.contentResponse.errorJSON=b})):ha.continueToAuthenticationScreen(f,g)}function W(d,e){c.apiService(d,e).then(function(c){window.scrollTo(0,0),a.contentResponse={},a.contentResponse.errorJSON={},c.errorCode||(!1===c.header.stopFlow?(a.userData.data=c.body,c.body.trustAnchorIdentificationToken&&c.body.trustAnchorIdentificationToken.trustAnchorEligible?f.changeView(b.VIEWS.confirmIdentity):c.body.authenticationTokenSpecificationList?f.changeView(b.VIEWS.authentication):a.contentResponse.errorJSON=c):(ha.routeOnError(c),a.contentResponse.errorJSON=c))})}function X(a,b){return!((a.showForgetIdLink||a.isSuspended||a.isDisabled)&&(a.showForgetIdLink||b||!a.isDisabled||!a.lockedUser))}function Y(a,b){return!!(a.showForgetIdLink&&!a.isSuspended&&!a.isDisabled||a.showForgetIdLink&&!b&&a.isDisabled&&a.lockedUser)}function Z(c){a.errorPageRedirect=!0,a.userData.membershipNum=c,a.userData.loginType="membership",a.userData.surname=a.userData.surname,a.userData.routedFromMembershipFlow=!0,f.changeView(b.VIEWS.selfServeMemUnlockUserDetails)}function $(a){fa=a||[]}function aa(){return fa}function ba(a){ga.deliveryMethod=a.delivery.value,a.delivery.value===b.VAR.PASSCODE_DELIVERY_METHODS.SMS?ga.mobileNumber=e.getNumberByMobileId(a.mobileNumber.value,fa):delete ga.mobileNumber}function ca(){return ga}function da(){ga={}}function ea(){return a.resetViaSMS&&fa.length>0}var fa=[],ga={},ha={initializeModelValues:g,getDetailsProgressStatus:l,getConfirmationProgressStatus:m,getDateOfBirthClasses:n,getSolusAccountNumber:o,getSmsDetailsProgressStatus:h,getRequestPayload:p,getSmsConfirmationProgressStatus:k,getSmsCodeDeliveryProgressStatus:i,getSmsDeliveryProgressStatus:j,getDeliveryRequestPayload:u,getSMSVerificationRequestPayload:w,getPasscodeMemWordRequestPayload:y,getConfirmRequestPayload:x,getDetailsRequestPayload:t,getMembershipDetailsRequestPayload:z,getLastLoginDate:A,getMembershipType:B,getLoginMethod:C,getLoginStatusCheck:D,getButtonEligibilityAndData:E,getConfirmationDetails:G,getMembershipInformationTable:J,checkDormateEligibility:I,getMembershipInformationObj:K,getSingleMembershipInformationObj:L,sortUserMembershipData:M,checkUserDisabled:N,setUserMembershipNumber:P,getFirstSelectedUser:Q,getHeroDetails:R,getMembershipRememberMeCheckboxConfig:O,removeUserFromAssistCookie:S,routeOnError:T,forgottenPasscode:U,getUserDetails:V,continueToAuthenticationScreen:W,isForgotIdEligible:Y,isCheckboxEligible:X,selfServeMemUnlock:Z,getConfirmationDetailsForSolusMerchant:H,setUserMobileNumber:$,storeDeliveryMethodModelValues:ba,isEligibleForMobileSMSReset:ea,getUserMobileNumberDetails:aa,getDeliveryMethodModelValues:ca,clearPasscodeDeliveryData:da,getMobileNumberRequestPayload:v};return ha};a.$inject=["$rootScope","CONSTANT","services","$cookies","authLoginUtilService","secureRoute"],angular.module("appBdlLogin.services").factory("forgotUtilService",a)}(),function(){"use strict";var a=function(a,b){function c(){return{surnameMem:{value:""},surnameCardno:{value:""},surnameSortcode:{value:""},membershipNum:{value:""},sortCode:{value:""},cardNumber:{value:""},accountNumber:{value:""},rememberToken:[],loginType:"membership"}}function d(){return[{value:"membership",dsdname:"Membership number",extraLabelSelector:"loginHeader"},{value:"cardNumber",dsdname:"Card number",extraLabelSelector:"loginHeader"},{value:"sortCode",dsdname:"Sort code and account number",extraLabelSelector:"loginHeader"}]}function e(){return[{value:"Y",display:"Remember my last name and login method (optional)",displayMobile:"Remember my last name and login method (optional).Don't tick the box if you're using a public or shared device",disabled:!1}]}function f(){return{1:{cls:"col-xs-4 col-sm-4 col-md-4 col-lg-4",ariaLbl:"sort code First 2 digits"},2:{cls:"col-xs-4 col-sm-4 col-md-4 col-lg-4",ariaLbl:"sort code Second 2 digits"},3:{cls:"col-xs-4 col-sm-4 col-md-4 col-lg-4",ariaLbl:"sort code Third 2 digits"}}}function g(c,d){var e,f={identityToken:{},rememberToken:c.rememberToken};if(a.userData.loginType=c.model.loginType,a.userData.selectedTab=c.selectedTab,d)e=b.JSON.identifyRememberMe,f={index:0};else switch(a.userData.rememberToken=c.model.rememberToken,c.model.loginType){case"membership":a.userData.membershipNum=c.model.membershipNum.value,a.userData.surname=c.model.surnameMem.value,f.identityToken={surname:c.model.surnameMem.value,membershipNumber:c.model.membershipNum.value},e=b.JSON.identifyMembership;break;case"cardNumber":a.userData.surname=c.model.surnameCardno.value,a.userData.cardNumber=angular.copy(c.model.cardNumber.value);var g=c.model.cardNumber.value.split(" ");a.userData.cardNumberMasked="**** **** **** "+g[3],f.identityToken={surname:c.model.surnameCardno.value,debitCard1:g[0],debitCard2:g[1],debitCard3:g[2],debitCard4:g[3]},e=b.JSON.identifyDebitcard;break;case"sortCode":var h=c.model.sortCode.value.split("-");a.userData.sortCodeMasked=c.model.sortCode.value,a.userData.sortCode=h,a.userData.accountNumber=c.model.accountNumber.value,a.userData.accountNumberMasked="****"+c.model.accountNumber.value.substring(4),a.userData.surname=c.model.surnameSortcode.value,f.identityToken={surname:c.model.surnameSortcode.value,sortCode1:h[0],sortCode2:h[1],sortCode3:h[2],accountNumber:c.model.accountNumber.value},e=b.JSON.identifyAccountNumber}return c.rememberToken&&(a.rememberMeInfoStep1=new Array,a.rememberMeInfoStep1[0]=f),{apiName:e,requestParam:f}}function h(){return[{heading:"Membership number"},{heading:"Card number"},{heading:"Sort code and account number"}]}return{initializeModelValues:c,getRdoLoginTypeValues:d,getRememberMeCheckValues:e,getSortCodeClasses:f,getRequestPayload:g,getLoginTabs:h}};a.$inject=["$rootScope","CONSTANT"],angular.module("appBdlLogin.services").factory("identificationUtilService",a)}(),function(){"use strict";var a=function(a,b){function c(){return{dateOfBirth:{id:"dateOfBirth",value:""},cardNumber:{id:"cardNumber",value:""},securityCode:{id:"securityCode",label:"Security code for card",value:""}}}function d(){f.getlogMultipleMemDetails()}function e(){f.getlogMultipleMemDetailStep1()}var f=b.get("siteAnalyticsUtilService");return{initializeModelValues:c,setSCTags:d,setSCTagsMultiple:e}};a.$inject=["$rootScope","$injector"],angular.module("appBdlLogin.services").factory("multipleMembershipUtilService",a)}(),function(){"use strict";angular.module("appBdlLogin.services").factory("errorHandlingHTTPInterceptor",["secureRoute","$rootScope","siteTrackingService",function(a,b,c){return{response:function(d){var e=d.data;try{var f={header:{stopFlow:!0,stepIdentifier:"1",messages:[{code:"",text:"",level:"error",location:"header"}]}};(e&&e.errorCode||d&&"500"==d.status||d&&"400"==d.status)&&(b.contentResponse={},b.contentResponse.errorJSON={},e&&e.errorCode?(f.header.messages[0].code=e.errorCode,f.header.messages[0].text=e.message,b.errorPageRedirect=!0,b.contentResponse.errorJSON=f):"400"!=d.status&&"500"!=d.status||(f.header.messages[0].code=d.status,f.header.messages[0].text=d.statusText,b.serviceError=!1,c.tagErrorCodeEvent(d.status)),b.step1StopFlow=f,b.stopFlow=!0,a.changeView("/identification"))}catch(a){$log.info("Exception in error handling interceptor :: "+a)}return d}}}])}(),function(){"use strict";var a=function(a,b){function c(){return{dateOfBirth:{value:void 0!=f.dateOfBirth?f.dateOfBirth:""},accountType:{accounts:[{id:"Current-savings account",accountId:"Current-savings account",accountName:"Current/savings account"}],value:void 0!=f.accountType?f.accountType:"Current-savings account"},countryList:{countries:[],value:void 0!=f.countryList?f.countryList:-1},securityCode:{value:null,label:"Security code"},mortgageNumber:{value:void 0!=f.mortgageNumber?f.mortgageNumber:"9"},solusAccNumber:{value:void 0!=f.solusAccNumber?f.solusAccNumber:"ID"},cardNumber:{value:void 0!=f.cardNumber?f.cardNumber:null},merchantId:{value:void 0!=f.merchantId?f.merchantId:""},sortCode:{value:void 0!=f.sortCode?f.sortCode:""},settlementAccNo:{value:void 0!=f.settlementAccNo?f.settlementAccNo:""}}}function d(c){var d={};switch(c.accountType.value){case"Current-savings account":var e=c.cardNumber.value.split(" ");d={debitCardToken:{debitCard1:e[0],debitCard2:e[1],debitCard3:e[2],debitCard4:e[3],securityCode:c.securityCode.value},dateOfBirth:c.dateOfBirth.value.replace(/\//g,"")};break;case"Mortgage":d={dateOfBirth:c.dateOfBirth.value.replace(/\//g,""),accountType:c.accountType.value,accountNumber:c.mortgageNumber.value};break;case"Merchant account":d={dateOfBirth:c.dateOfBirth.value.replace(/\//g,""),accountType:c.accountType.value,merchantId:c.merchantId.value,sortcode:c.sortCode.value,settlementAccNo:c.settlementAccNo.value};break;default:d={dateOfBirth:c.dateOfBirth.value.replace(/\//g,""),accountType:c.accountType.value,accountNumber:c.solusAccNumber.value,countryCode:c.countryList.value}}return a.userData.routedFromMembershipFlow&&(d.membershipIdentityToken={membershipNumber:a.userData.membershipNum,surname:a.userData.surname}),{apiName:b.JSON.getMobileDetails,requestParam:d}}function e(a,b){var c=[{number:1,text:"Your details",ProgressRange:void 0!=b?b:0},{number:2,text:"Text verification",ProgressRange:void 0!=b?b:0},{number:3,text:"Complete",ProgressRange:void 0!=b?b:0}];switch(a){case 1:c[0].active=!0;break;case 2:c[0].complete=!0,c[1].active=!0;break;case 3:c[0].complete=!0,c[1].complete=!0,c[2].active=!0}return c}var f={};return{getRequestPayload:d,initializeModelValues:c,getStepsData:e,setUserDetails:function(a){switch(f.dateOfBirth=a.dateOfBirth.value,f.accountType=a.accountType.value,a.accountType.value){case"Current-savings account":f.cardNumber=a.cardNumber.value;break;case"Mortgage":f.mortgageNumber=a.mortgageNumber.value;break;case"Merchant account":f.merchantId=a.merchantId.value,f.sortCode=a.sortCode.value,f.settlementAccNo=a.settlementAccNo.value;break;default:f.solusAccNumber=a.solusAccNumber.value,f.countryList=a.countryList.value}},clearUserDetails:function(){f={}}}};a.$inject=["$rootScope","CONSTANT"],angular.module("appBdlLogin.services").factory("selfServeMemUnlockUtilService",a)}(),function(){"use strict";angular.module("appBdlLogin.services").factory("cookieService",["$rootScope",function(a){return{setCookie:function(a,b,c){var d=new Date,e="";c&&(d.setTime(d.getTime()+24*c*60*60*1e3),e="expires="+d.toUTCString()),document.cookie=a+"="+b+"; "+e},getCookie:function(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "===e.charAt(0);)e=e.substring(1);if(0===e.indexOf(b))return e.substring(b.length,e.length)}return""},setEncodedCookie:function(a,b,c){var d=new Date;d.setTime(d.getTime()+24*c*60*60*1e3);var e=d.toUTCString(),f=window.location.hostname;f.indexOf(".barclays.co.uk")>-1?(f=".barclays.co.uk",document.cookie=a+"="+encodeURIComponent(b)+";expires="+e+";domain="+f+";path=/"):document.cookie=a+"="+encodeURIComponent(b)+";expires="+e+";path=/"}}}])}(),function(){"use strict";angular.module("appBdlLogin.services").factory("services",["ENV","$http","$q","$cookies","$rootScope","$filter","cookieService","$timeout","CONSTANT","secureRoute","timeoutService",function(a,b,c,d,e,f,g,h,i,j,k){var l;return{sortAccountTypes:function(a,b){return a.accountName<b.accountName?-1:a.accountName>b.accountName?1:0},isMobile:function(){return void 0===l&&(l=navigator.userAgent.match(/iPad|iPhone|iPod|Android|BlackBerry|Windows Phone|webOS/i),l=!!l),l},isEmpty:function(a){for(var b in a)return!1;return!0},forgetUser:function(a){var b={index:this.getIndexOfMemberInAssistCookie(a)},c=i.JSON.ForgetUser;this.apiService(c,b).then(function(a){window.scrollTo(0,0),e.contentResponse={},e.contentResponse.errorJSON={},a.errorCode||(!1===a.header.stopFlow?(e.userData={},j.changeView(i.VIEWS.identification)):(e.serviceError=!0,e.contentResponse.errorJSON=a))})},getIndexOfMemberInAssistCookie:function(a){var b=d.assist2;if(b&&a){var c=b.split("&");angular.forEach(c,function(b,c){if(b.indexOf(a)>-1)return c})}return 0},setRememberMeInfoPostAuthentication:function(a){var b=new Object,c=new Array,f=d.assist2;if(f){var g=f.split("&");angular.forEach(g,function(b,d){b.indexOf(a.body.verificationToken.membershipNumber)>-1&&b.indexOf(a.body.verificationToken.surname)<0&&(c[0]={},c[0].identityToken={},c[0].identityToken.surname=a.body.verificationToken.surname,c[0].identityToken.membershipNumber=a.body.verificationToken.membershipNumber,c[0].memberNumber=a.body.verificationToken.membershipNumber,c[0].forename=a.body.verificationToken.forename)})}return e.rememberMeInfoStep1&&e.rememberMeInfoStep1.length>0&&(c[0]={},c[0].identityToken=e.rememberMeInfoStep1[0].identityToken,c[0].identityToken.surname=a.body.verificationToken.surname,c[0].memberNumber=a.body.verificationToken.membershipNumber,c[0].forename=a.body.verificationToken.forename),b.rememberMeDVOs=c,b.errorOnOverflow=!1,b},setRememberMeInfoPreAuthentication:function(a){var b={},c=new Array,d=0;return angular.forEach(a,function(b,e){c[d]={},c[d].identityToken=a[e].identityToken,a[e].forename&&(c[d].forename=a[e].forename),a[e].identityToken.membershipNumber&&(c[d].memberNumber=a[e].identityToken.membershipNumber),d++}),b.rememberMeDVOs=c,b.errorOnOverflow=!0,b},apiService:function(d,e,f){k.startLoginTimeout();var g,h=c.defer();return void 0===f&&(f="post"),void 0===e&&(e={}),b({method:f,url:a.apiBasePath+"/"+d,data:e}).success(function(a){g=a}).error(function(a){g=a}).then(function(){h.resolve(g)},function(){h.resolve(g)}),h.promise},smsApiService:function(a,d){k.startLoginTimeout();var e,f=c.defer(),g="https://www.forms.barclays.co.uk/staging/appDownload.php";return void 0===d&&(d="post"),void 0===a&&(a={}),b({method:d,url:g,data:a,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(a){e=a}).error(function(a){e=a}).then(function(){f.resolve(e)},function(){f.resolve(e)}),f.promise},browserMatrixConverter:function(a,b){for(var c=0;c<a.length;c++)b[a[c].name]={},b[a[c].name].approved=a[c].minRecommended,b[a[c].name].rejected=a[c].minRequired-1,1e3===a[c].minRecommended&&1e3===a[c].minRequired&&(b[a[c].name].unsupported=!0);return b},evaluateBrowser:function(a,b,c){if(!a)return"rejectedBrand";var d=c[a.toLowerCase()];if(!d||d.unsupported)return"rejectedBrand";if(d.rejected>=b)return"rejected";if(d.rejectedList)for(var e=0;e<d.rejectedList.length;e+=1)if(d.rejectedList[e]===b)return"rejected";return d.approved<=b?"approved":"advised"},getBrowserInformation:function(){function a(a){var b=d.match(a);return b&&b.length>1&&b[1]||""}function b(a){var b=d.match(a);return b&&b.length>1&&b[2]||""}var c,d=navigator.userAgent,e=!0,f=a(/(ipod|iphone|ipad)/i).toLowerCase(),g=/like android/i.test(d),h=!g&&/android/i.test(d),i=/nexus\s*[0-6]\s*/i.test(d),j=(!i&&/nexus\s*[0-9]+/i.test(d),/CrOS/.test(d)),k=/silk/i.test(d),l=/sailfish/i.test(d),m=/tizen/i.test(d),n=/(web|hpw)os/i.test(d),o=/windows phone/i.test(d),p=(/SamsungBrowser/i.test(d),!o&&/windows/i.test(d),!f&&!k&&/macintosh/i.test(d),!h&&!l&&!m&&!n&&/linux/i.test(d),a(/edge\/(\d+(\.\d+)?)/i)),q=a(/version\/(\d+(\.\d+)?)/i),r=/tablet/i.test(d);!r&&/[^-]mobi/i.test(d),/xbox/i.test(d);/opera/i.test(d)?c={name:"opera",nameToDisplay:"Opera",opera:e,version:q||a(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr\/|opios/i.test(d)?c={name:"opera",nameToDisplay:"Opera",opera:e,version:a(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||q}:/blackberry|\bbb\d+/i.test(d)||/rim\stablet/i.test(d)?c={name:"blackberry browser",nameToDisplay:"Blackberry Browser",blackberry:e,version:q||a(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:/maxthon/i.test(d)?c={name:"maxthon",nameToDisplay:"Maxthon Browser",maxthon:e,version:q||a(/(?:maxthon)[\s\/](\d+(\.\d+)?)/i)}:/yabrowser/i.test(d)?c={name:"yandex",nameToDisplay:"Yandex Browser",yabrowser:e,version:q||a(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/qqbrowser/i.test(d)?c={name:"qqbrowser",nameToDisplay:"QQ Browser",qqbrowser:e,version:q||a(/(?:qqbrowser)[\s\/](\d+(\.\d+)?)/i)}:/aol/i.test(d)?c={name:"aol explorer",nameToDisplay:"AOL Browser",aol:e,version:q||a(/(?:aol)[\s\/](\d+(\.\d+)?)/i)}:/up.browser/i.test(d)?c={name:"openwave mobile browser",nameToDisplay:"UP Browser",openwavemobilebrowser:e,version:q||a(/(?:up.browser)[\s\/](\d+(\.\d+)?)/i)}:/Camino/i.test(d)?c={name:"camino",nameToDisplay:"Camino",camino:e,version:q||a(/(?:camino)[\s\/](\d+(\.\d+)?)/i)}:/nokiabrowser|nokia/i.test(d)&&/Symbian/i.test(d)&&!o?c={name:"ibrowse",nameToDisplay:"Nokia Browser",ibrowse:e,version:q||a(/(?:nokiabrowser)[\s\/](\d+(\.\d+)?)/i)}:/BrowserNG/i.test(d)?c={name:"nokia web browser",nameToDisplay:"Nokia Browser",browserng:e,version:q||a(/(?:browserng)[\s\/](\d+(\.\d+)?)/i)}:/wOSBrowser/i.test(d)?c={name:"wosbrowser",nameToDisplay:"Web OS Browser",wosbrowser:e,version:q||a(/(?:wosbrowser)[\s\/](\d+(\.\d+)?)/i)}:/Navigator/i.test(d)?c={name:"netscape navigator",nameToDisplay:"Netscape Navigator",netscapenavigator:e,version:q||a(/(?:navigator)[\s\/](\d+(\.\d+)?)/i)}:/netfront/i.test(d)?c={name:"netfront browser",nameToDisplay:"Netfront Browser",netfront:e,version:q||a(/(?:netfront)[\s\/](\d+(\.\d+)?)/i)}:/Kindle/i.test(d)?c={name:"kindle browser",nameToDisplay:"Kindle Browser",kindle:e,version:q||a(/(?:kindle)[\s\/](\d+(\.\d+)?)/i)}:/Konqueror/i.test(d)?c={name:"konqueror",nameToDisplay:"Konqueror",konqueror:e,version:q||a(/(?:konqueror)[\s\/](\d+(\.\d+)?)/i)}:/OneBrowser/i.test(d)?c={name:"one browser",nameToDisplay:"One Browser",onebrowser:e,version:q||a(/(?:onebrowser)[\s\/](\d+(\.\d+)?)/i)}:/SEMC/i.test(d)?c={name:"semc browser",nameToDisplay:"SEMC",semc:e,version:q||a(/(?:semc)[\s\/](\d+(\.\d+)?)/i)}:/lynx/i.test(d)?c={name:"lynx",nameToDisplay:"Lynx Browser",olynx:e,version:q||a(/(?:lynx)[\s\/](\d+(\.\d+)?)/i)}:/brew|obigo/i.test(d)?c={name:"obigo",nameToDisplay:"Obigo Browser",obigo:e,version:q||a(/(?:brew|obigo)[\s\/](\d+(\.\d+)?)/i)}:/polaris/i.test(d)?c={name:"polaris",nameToDisplay:"Polaris Browser",polaris:e,version:q||a(/(?:polaris)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(d)?c={name:"uc browser",nameToDisplay:"UC Browser",ucbrowser:e,version:a(/(?:ucbrowser)(\d+)\.(\d+)\.(\d+)/i)}:/firefox|iceweasel|fxios/i.test(d)?(c={name:"firefox",nameToDisplay:"Mozilla Firefox",firefox:e,version:a(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(d)&&(c.firefoxos=e)):k?c={name:"silk",nameToDisplay:"Silk by Amazon",silk:e,version:q||a(/silk\/(\d+(\.\d+)?)/i)}:/dolfin|dolphin/i.test(d)?c={name:"dolphin",nameToDisplay:"Dolphin",dolfin:e,version:a(/dolfin\/(\d+(\.\d+)?)/i)}:o?(c={name:"Windows Phone",nameToDisplay:"Windows Phone",windowsphone:e},p?(c.name="microsoft edge",c.msedge=e,c.version=p):(c.name="ie",c.msie=e,c.version=a(/iemobile\/(\d+(\.\d+)?)/i))):j?c={name:"Chrome",nameToDisplay:"Google Chrome",chromeos:e,chromeBook:e,chrome:e,version:a(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/chrome.+? edge/i.test(d)?c={name:"microsoft edge",nameToDisplay:"Microsoft Edge",msedge:e,version:p}:/miuibrowser|miui/i.test(d)?c={name:"miui",nameToDisplay:"MIUI Browser",miui:e,version:q||a(/(?:miui|miuibrowser)[\s\/](\d+(\.\d+)?)/i)}:/nintendobrowser|nintendo/i.test(d)?c={name:"nintendo",nameToDisplay:"Nintendo browser",nintendo:e,version:a(/(?:nintendobrowser|nintendo)[\s\/](\d+(?:\.\d+)+)/i)}:/.*(Linux;.*AppleWebKit\/\d+\.\d+.*Mobile).*/gi.test(d)?c={name:"android browser",nameToDisplay:"Android Browser",androidbrowser:e,version:a(/(?:android )(\d+(\.\d+)?)/i)}:/(android)|(crios)/gi.test(d)?c={name:"chrome mobile",nameToDisplay:"Chrome Mobile",chrome:e,version:a(/(?:chrome|crios|crmo|android)\/(\d+(\.\d+)?)/i)}:/chrome|crios|crmo/i.test(d)?c={name:"chrome",nameToDisplay:"Google Chrome",chrome:e,version:a(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/(iPod|iPhone|iPad)|(safari\/[.0-7]* (?!mobile))/gi.test(d)?c={name:"mobile safari",nameToDisplay:"Safari",safari:e,version:q||a(/(?:iPod|iPhone|iPad);.*CPU.*OS (\d+)_(\d+)(?:_(\d+))?.*Mobile/i)}:/safari/i.test(d)?(c={name:"safari",nameToDisplay:"Safari",safari:e},q&&(c.version=q)):/metasr|SE 2\.X/i.test(d)?c={name:"sogou explorer",nameToDisplay:"SouGou Browser",sogou:e,version:q||a(/metasr|SE 2\.X[\d]+\/(\d+(\.\d+)?)/i)}:/msie|trident/i.test(d)?c={name:"ie",nameToDisplay:"Internet Explorer",msie:e,version:a(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:n?c={name:"WebOS",nameToDisplay:"WebOS",webos:e,version:q||a(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)}:/SamsungBrowser/i.test(d)?c={name:"Samsung Internet for Android",nameToDisplay:"Samsung Internet for Android",samsungBrowser:e,version:q||a(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/epiphany/i.test(d)?c={name:"Epiphany",nameToDisplay:"Epiphany",epiphany:e,version:a(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(d)?c={name:"Puffin",nameToDisplay:"Puffin",puffin:e,version:a(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(d)?c={name:"Sleipnir",nameToDisplay:"Sleipnir",sleipnir:e,version:a(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(d)?c={name:"K-Meleon",nameToDisplay:"K-Meleon",kMeleon:e,version:a(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:/vivaldi/i.test(d)?c={name:"Vivaldi",nameToDisplay:"Vivaldi",vivaldi:e,version:a(/vivaldi\/(\d+(\.\d+)?)/i)||q}:l?c={name:"Sailfish",nameToDisplay:"Sailfish",sailfish:e,version:a(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(d)?c={name:"SeaMonkey",nameToDisplay:"SeaMonkey",seamonkey:e,version:a(/seamonkey\/(\d+(\.\d+)?)/i)}:/phantom/i.test(d)?c={name:"PhantomJS",nameToDisplay:"PhantomJS",phantom:e,version:a(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(d)?c={name:"SlimerJS",nameToDisplay:"SlimerJS",slimer:e,version:a(/slimerjs\/(\d+(\.\d+)?)/i)}:m?c={name:"Tizen",nameToDisplay:"Tizen",tizen:e,version:a(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||q}:/qupzilla/i.test(d)?c={name:"QupZilla",nameToDisplay:"QupZilla",qupzilla:e,version:a(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||q}:/chromium/i.test(d)?c={name:"Chromium",nameToDisplay:"Chromium",chromium:e,version:a(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||q}:h?c={name:"Android",nameToDisplay:"Android Browser",version:q}:f?(c={name:"iphone"===f?"iPhone":"ipad"===f?"iPad":"iPod"},q&&(c.version=q)):c=/googlebot/i.test(d)?{name:"Googlebot",nameToDisplay:"Googlebot",googlebot:e,version:a(/googlebot\/(\d+(\.\d+))/i)||q}:{name:a(/^(.*)\/(.*) /),version:b(/^(.*)\/(.*) /)},!c.msedge&&/(apple)?webkit/i.test(d)?(/(apple)?webkit\/537\.36/i.test(d)?(c.name=c.name||"Blink",c.nameToDisplay=c.nameToDisplay||"Blink",c.blink=e):(c.name=c.name||"Webkit",c.nameToDisplay=c.nameToDisplay||"Webkit",c.webkit=e),!c.version&&q&&(c.version=q)):!c.opera&&/gecko\//i.test(d)&&(c.name=c.name||"Gecko",c.nameToDisplay=c.nameToDisplay||"Gecko",c.gecko=e,c.version=c.version||a(/gecko\/(\d+(\.\d+)?)/i));var t=[];return t[0]=c.name,t[1]=c.version,t[2]=c.nameToDisplay,t},browserAlert:function(){var a=c.defer(),b={},d=[{name:"chrome",minRecommended:49,minRequired:21,unsupported:!1,browserNameToDisplay:"Google Chrome"},{name:"safari",minRecommended:9,minRequired:5,unsupported:!1,browserNameToDisplay:"Safari"},{name:"android browser",minRecommended:5,minRequired:1,unsupported:!1,browserNameToDisplay:"Android Browser"},{name:"silk",minRecommended:51,minRequired:1,unsupported:!1,browserNameToDisplay:"Silk by Amazon"},{name:"firefox",minRecommended:46,minRequired:31,unsupported:!1,browserNameToDisplay:"Mozilla Firefox"},{name:"ie",minRecommended:11,minRequired:9,unsupported:!1,browserNameToDisplay:"Internet Explorer"},{name:"microsoft edge",minRecommended:12,minRequired:1,unsupported:!1,browserNameToDisplay:"Microsoft Edge"},{name:"mobile safari",minRecommended:7,minRequired:5,unsupported:!1,browserNameToDisplay:"Safari"},{name:"chrome mobile",minRecommended:49,minRequired:21,unsupported:!1,browserNameToDisplay:"Chrome Mobile"},{name:"maxthon",minRecommended:1e3,minRequired:1e3,unsupported:!1,browserNameToDisplay:"Maxthon Browser"},{name:"blackberry browser",minRecommended:1e3,minRequired:1e3,unsupported:!1,browserNameToDisplay:"Blackberry Browser"},{name:"yandex",minRecommended:1e3,minRequired:1e3,unsupported:!1,browserNameToDisplay:"Yandex Browser"},{name:"qqbrowser",minRecommended:1e3,minRequired:1e3,unsupported:!1,browserNameToDisplay:"QQ Browser"},{name:"uc browser",minRecommended:1e3,minRequired:1e3,unsupported:!1,browserNameToDisplay:"UC Browser"},{name:"opera",minRecommended:1e3,minRequired:1e3,unsupported:!1,browserNameToDisplay:"Opera"},{name:"aol explorer",minRecommended:1e3,minRequired:1e3,unsupported:!1,browserNameToDisplay:"AOL Browser"},{name:"openwave mobile browser",minRecommended:1e3,minRequired:1e3,unsupported:!1,browserNameToDisplay:"UP Browser"},{name:"camino",minRecommended:1e3,minRequired:1e3,unsupported:!1,browserNameToDisplay:"Camino"},{name:"sogou explorer",minRecommended:10,minRequired:1e3,unsupported:!1,browserNameToDisplay:"SouGou Browser"},{name:"ibrowse",minRecommended:1e3,minRequired:1e3,unsupported:!1,browserNameToDisplay:"Nokia Browser"},{name:"nokia web browser",minRecommended:1e3,minRequired:1e3,unsupported:!1,browserNameToDisplay:"Nokia Browser"},{name:"wosbrowser",minRecommended:1e3,minRequired:1e3,unsupported:!1,browserNameToDisplay:"Web OS Browser"},{name:"dolphin",minRecommended:1e3,minRequired:1e3,unsupported:!1,browserNameToDisplay:"Dolphin"},{name:"netscape navigator",minRecommended:1e3,minRequired:1e3,unsupported:!1,browserNameToDisplay:"Netscape Navigator"},{name:"kindle browser",minRecommended:1e3,minRequired:1e3,unsupported:!1,browserNameToDisplay:"Kindle Browser"},{name:"konqueror",minRecommended:1e3,minRequired:1e3,unsupported:!1,browserNameToDisplay:"Konqueror"},{name:"one browser",minRecommended:1e3,minRequired:1e3,unsupported:!1,browserNameToDisplay:"One Browser"},{name:"semc browser",minRecommended:1e3,minRequired:1e3,unsupported:!1,browserNameToDisplay:"SEMC"},{name:"lynx",minRecommended:1e3,minRequired:1e3,unsupported:!1,browserNameToDisplay:"Lynx Browser"},{name:"obigo",minRecommended:1e3,minRequired:1e3,unsupported:!1,browserNameToDisplay:"Obigo Browser"},{name:"polaris",minRecommended:1e3,minRequired:1e3,unsupported:!1,browserNameToDisplay:"Polaris Browser"},{name:"miui",minRecommended:1e3,minRequired:1e3,unsupported:!1,browserNameToDisplay:"MIUI Browser"},{name:"nintendo",minRecommended:1e3,minRequired:1e3,unsupported:!1,browserNameToDisplay:"Nintendo browser"}],e=this;return this.apiService(i.JSON.browserData).then(function(c){if(c&&c.header&&!1===c.header.stopFlow&&c.body){d=c.body.browserAcceptanceInformation;var f=c.body.regex}b=e.browserMatrixConverter(d,b);var g=e.getBrowserInformation(new RegExp(f,"i"));a.resolve(e.evaluateBrowser(g[0],g[1],b))}),a.promise},setBrowserConsolidationMessage:function(a,b){var c=new Array;return"State_1"===a?(c[0]=b.contentContainer.content.snippets.BDL_FTBLoginLinkCB_warn_nonrec_versionP1.content.replace("</p>"," ")+" "+this.getBrowserInformation()[2]+b.contentContainer.content.snippets.BDL_FTBLoginLinkCB_warn_nonrec_versionP2.content.replace('<p class="bc-inline">'," ")+b.contentContainer.content.snippets.FTBLoginLinkCB_warn_nonrec_versionP3.content,c[1]=b.contentContainer.content.snippets.BDL_FTBLoginLinkCB_warn_nonrec_versionP1.content.replace("</p>"," ")+" "+this.getBrowserInformation()[2]+b.contentContainer.content.snippets.BDL_FTBLoginLinkCB_warn_nonrec_versionP2.content.replace('<p class="bc-inline">'," ")):"State_2"===a?(c[0]=b.contentContainer.content.snippets.BDL_FTBLoginLinkCB_block_unsup_version.content,c[1]=c[0]):"State_3"===a?(c[0]=b.contentContainer.content.snippets.BDL_FTBLoginLinkCB_warn_unsup_browserP1.content+b.contentContainer.content.snippets.FTBLoginLinkCB_warn_unsup_browserP2.content,c[1]=b.contentContainer.content.snippets.BDL_FTBLoginLinkCB_warn_unsup_browserP1.content):"State_4"===a&&(c[0]=b.contentContainer.content.snippets.FTBLoginLinkCB_block_unsup_browser.content,c[1]=c[0]),c},setFaqContent:function(a){var b=!1;return Object.keys(a.contentContainer.content.helpCards).length>0&&(b=!0),{contents:a.contentContainer.content.helpCards,needHelpContents:a.contentContainer.content.channelHelp,eligible:b}}}}])}(),function(){"use strict";angular.module("appBdlLogin.services").factory("siteTrackingService",["$rootScope","cookieService","$routeParams","snippetServices",function($rootScope,cookieService,$routeParams,snippetServices){function setPageLoadTags(){scClearSetTags(),scSetTags(),callToPageTracking()}function scSetTags(){angular.forEach(trackingObjMapping,function(a,b){pageLoadTagsToSet.hasOwnProperty(b)&&void 0!==pageLoadTagsToSet[b]&&null!==pageLoadTagsToSet[b]&&(s[a]=pageLoadTagsToSet[b])}),void 0!=errorCodesToTrack&&""!=errorCodesToTrack&&(s.eVar11=errorCodesToTrack,void 0!=s.events&&""!=s.events?s.events+=",event15":s.events="event15",errorCodesToTrack="")}function scClearSetTags(){angular.forEach(trackingObjMapping,function(a,b){angular.isDefined(s[a])&&delete s[a]})}function scSetInitial(){s&&(s.server="bank.barclays.co.uk",s.channel="UKRBB",s.cookieDomainPeriods="3",s.currencyCode="GBP",s.useForcedLinkTracking=!1,s.__tx_e="",s.prop1="onl",s.prop39="Fixed Secure",s.prop49=s.currencyCode,s.prop16="/olb/auth/LoginLink.action")}function tagErrorCode(a){a&&(s.eVar11=a,callToPageTracking(),delete s.eVar11)}function tagAlertsOnPage(a){if(a){s.linkTrackVars="prop17,eVar53",s.linkTrackEvents="None";var b=pageLoadTagsToSet.pageName+":alertMessage";s.eVar53=_.camelCase(a),s.prop17=pageLoadTagsToSet.pageName,callToActionTracking(b,!0),resetLinkTrackVars()}}function setLoginMechanismForTracking(a){var b="default_method";if(cookieService.getCookie(b))switch(cookieService.getCookie(b)){case"C":a="membership";break;case"B":a="cardNumber";break;case"A":a="sortCode"}switch(a){case"sortCode":loginMechanism="AccountAndSortCode";break;case"cardNumber":loginMechanism="CardNumber";break;default:loginMechanism="MembershipID"}}function getType(a){var b=a.getAttribute("analytics-Tag");return void 0!=b&&""!=b||(b=a.nodeName.toLowerCase()),b}function getLabel(a){var b;return a.getAttribute("analytics-label")?b=a.getAttribute("analytics-label"):("A"===a.nodeName&&(a.textContent||a.innerText)?b=(a.textContent||a.innerText||"").replace(/\s/g,""):a.getAttribute("field-name")?b=a.getAttribute("field-name"):a.attributes.name&&(b=a.attributes.name.value),void 0!==b&&(b=_.camelCase(b.replace(/[^a-zA-Z ]/g,"")))),b}function getValue(element,modelObj){var value;if(!element.getAttribute("customAnalyticsValue"))return element.getAttribute("ng-model")&&eval("modelObj."+element.getAttribute("ng-model"))?value=eval("modelObj."+element.getAttribute("ng-model")):void 0!==element.selectedOptions&&(value=element.selectedOptions[0].label.replace(/\s/g,"")),_.camelCase(value);value=element.getAttribute("customAnalyticsValue")}function getActionName(element,modelObj,value){var actionName,eventType=getType(element),label=getLabel(element),pageName=pageLoadTagsToSet.pageName;if("button"===eventType)actionName=pageName+":button:"+label;else if("a"===eventType||"b-alert"===eventType||"section"===eventType)actionName=pageName+":link:"+label;else if("input"===eventType||"b-check"===eventType||"b-dateinput"===eventType)actionName="b-check"===eventType&&element.getAttribute("ng-model")&&0===eval("modelObj."+element.getAttribute("ng-model")).length?pageName+":form:"+label+":untick":pageName+":form:"+label+":tick";else if("select"===eventType||"b-radio"===eventType){var value=void 0==value?getValue(element,modelObj):value;actionName=pageName+":form:"+label+":"+value}else"nav"===eventType&&(actionName=pageName+":nav:tick");return actionName}function bindTrackEvent(a,b){var c=getType(a[0]);"select"===c||"b-check"===c?$(a).bind("change",function(){s.linkTrackVars="prop17,prop60",setEventTrackingData(a[0],b,null,this)}):"input"===c?$(a).bind("blur",function(){s.linkTrackVars="prop17,prop60",setEventTrackingData(a[0],b,null,this)}):$(a).bind("click",function(){var c,d=getLabel(a[0]);s.linkTrackVars="prop17,prop60","loginType"===d?(s.linkTrackVars=s.linkTrackVars+",eVar36,eVar41",s.eVar36=loginMechanism,s.eVar41="D=pageName",c=loginMechanism):"loginMethod"===d&&(s.linkTrackVars=s.linkTrackVars+",eVar37,eVar38,eVar41",s.eVar37=loginMethod,s.eVar38=loginRoute,s.eVar41="D=pageName",c=loginMethod),setEventTrackingData(a[0],b,c,this)})}function setEventTrackingData(a,b,c,d){if(s){var e=getActionName(a,b,c);if(void 0!=e&&prevActionName!==e){prevActionName=e;var f=!d.href||d;s.linkTrackEvents="None",s.prop17=pageLoadTagsToSet.pageName,s.prop60=getLabel(a),callToActionTracking(e,f)}}}function resetLinkTrackVars(){if(void 0!=s.linkTrackVars&&""!==s.linkTrackVars){var a=s.linkTrackVars.split(",");for(var b in a)void 0!=s[a[b]]&&delete s[a[b]];s.linkTrackVars=""}if(void 0!=s.linkTrackEvents&&""!==s.linkTrackEvents&&"none"!==s.linkTrackEvents){var a=s.linkTrackEvents.split(",");for(var b in a)void 0!=s[a[b]]&&delete s[a[b]];s.linkTrackEvents=""}}function callToPageTracking(){"on"===snippetServices.getCookiePref("cat2")&&s.t()}function callToActionTracking(a,b){"on"===snippetServices.getCookiePref("cat2")&&s.tl(b,"o",a)}var pageLoadTagsToSet={},loginMechanism,prevActionName,loginRoute,loginMethod,prevPageLoadTags,errorCodesToTrack,trackingObjMapping={pageName:"pageName",customLink:"actionName",segment:"prop2",subsection:"prop3",pageVersion:"prop54",linkByPageName:"prop17",uniqueLinkName:"prop60",linkDestination:"prop61",interactionType:"prop62",formName:"eVar10",duplicateV10:"prop30",formStep:"prop31",applicationID:"eVar21",applicationType:"eVar22",impressionsV53:"eVar53",impressionsC53:"prop53",membershipID:"eVar25",errorFields:"prop32",errorName:"eVar11",loginSegment:"eVar36",loginMethod:"eVar37",loginRoute:"eVar38",pageNameDuplicate:"eVar41",events:"events"};scSetInitial();var if_s=function(a){return window.s?a:function(){}};return{trackPageLoad:function(a){pageLoadTagsToSet=a,!0===window.digitalDataSwitch&&(window.digitalDataPageName=pageLoadTagsToSet.pageName,authloginDigitalData.init()),dataLayer.ViewName=pageLoadTagsToSet.pageName,if_s(function(){setPageLoadTags()})()},tagErrorCodeEvent:if_s(function(a){tagErrorCode(a)}),trackDialogBox:if_s(function(a){prevPageLoadTags=pageLoadTagsToSet,pageLoadTagsToSet=a,setPageLoadTags()}),bindTrackEvent:if_s(function(a,b){bindTrackEvent(a,b)}),tagAlertsOnPage:if_s(function(a){tagAlertsOnPage(a)}),setLoginMechanism:if_s(function(a){setLoginMechanismForTracking(a)}),getLoginMechanism:function(){return loginMechanism},setLoginMethod:if_s(function(a){loginMethod=a}),getLoginMethod:function(){return loginMethod},setLoginRoute:if_s(function(a){loginRoute=a}),getLoginRoute:function(){return loginRoute},setErrorCode:if_s(function(a){errorCodesToTrack=a}),getPageVersion:if_s(function(){var a;switch($routeParams.mbrtyp){case"pbc":a="Wealth";break;case"wintc":a="WealthInt";break;default:a="BUK"}return a}),isAssistCookieSet:if_s(function(){var a=cookieService.getCookie("assist2");if(a&&a.split("&").length-1!=0)return!0}),trackTimeoutActions:if_s(function(a){if(s){var b=pageLoadTagsToSet.pageName+":"+a;s.linkTrackVars="prop17,prop60,prop62",s.linkTrackEvents="None",s.prop17=pageLoadTagsToSet.pageName,s.prop60=a,s.prop62="link",callToActionTracking(b,!0),resetLinkTrackVars(),scClearSetTags(),pageLoadTagsToSet=prevPageLoadTags,scSetTags()}})}}])}(),function(){"use strict";var a=function(a,b){function c(){var a={pageName:"onl:logon:Login:Step1YourDetails",segment:"onl:logon",subsection:"onl:logon:Login",pageVersion:b.getPageVersion(),formName:"Login",duplicateV10:"D=v10",formStep:"onl:Login:Step1",impressionsV53:"",loginSegment:b.getLoginMechanism(),pageNameDuplicate:"D=pageName",events:"event7"};b.trackPageLoad(a)}function d(){var a={pageName:"onl:logon:Login:Step1YourDetails:multipleRememberedMemberships",segment:"onl:logon",subsection:"onl:logon:Login",duplicateV10:"D=v10",pageNameDuplicate:"D=pageName"};b.trackPageLoad(a)}function e(){var a={pageName:"onl:logon:Login:Step2:ConfirmYourIdentity:AppNotificationInitiate",segment:"onl:logon",subsection:"onl:logon:Login",duplicateV10:"ConfirmYourIdentityUsingBarclaysApp",formStep:"onl:Login:Step2"};b.trackPageLoad(a)}function f(){var a={pageName:"onl:logon:Login:Step2:ConfirmYourIdentity",segment:"onl:logon",subsection:"onl:logon:Login",duplicateV10:"ConfirmYourIdentityUsingBarclaysApp",formStep:"onl:Login:Step2"};b.trackPageLoad(a)}function g(){var a={pageName:"onl:logon:Login:Step1YourDetails:Joint",segment:"onl:logon",subsection:"onl:logon:Login",duplicateV10:"D=v10",pageNameDuplicate:"D=pageName"};b.trackPageLoad(a)}function h(){var a={pageName:"onl:logon:Login:Step1YourDetails:MultipleMembership",segment:"onl:logon",subsection:"onl:logon:Login",duplicateV10:"D=v10",pageNameDuplicate:"D=pageName"};b.trackPageLoad(a)}function i(){var a={pageName:"onl:logon:Login:Step1YourDetails:MultipleMembership:Select",segment:"onl:logon",subsection:"onl:logon:Login",duplicateV10:"D=v10",pageNameDuplicate:"D=pageName"};b.trackPageLoad(a)}function j(a){var c={pageName:"onl:logon:Login:LockedOut:ReorderPasscode",segment:"onl:logon",subsection:"onl:logon:Login",duplicateV10:"D=v10",errorName:a,pageNameDuplicate:"D=pageName"};b.trackPageLoad(c)}function k(a){var c={pageName:"onl:logon:Login:Step2ConfirmYourID",segment:"onl:logon",subsection:"onl:logon:Login",duplicateV10:"D=v10",formStep:"onl:Login:Step2",impressionsV53:a,impressionsC53:"D=v53",loginSegment:b.getLoginMechanism(),loginMethod:b.getLoginMethod(),loginRoute:b.getLoginRoute(),pageNameDuplicate:"D=pageName"};b.isAssistCookieSet()&&(c.events="event7",c.formName="LoginDetailsRemembered",c.pageVersion="DetailsRemembered"),b.trackPageLoad(c)}function l(){var a={pageName:"onl:logon:Login:FirstTime:EnterPasscode",segment:"onl:logon",subsection:"onl:logon:Login",formName:"LoginFirstTime",duplicateV10:"D=v10",formStep:"onl:Login:FirstTime:Step2:EnterPasscode",loginMethod:"Passcode",loginRoute:"SFA",pageNameDuplicate:"D=pageName"};b.trackPageLoad(a)}function m(){var a={pageName:"onl:logon:Login:FirstTime:SetPasscode",segment:"onl:logon",subsection:"onl:logon:Login",duplicateV10:"D=v10",formStep:"onl:Login:FirstTime:Step2:SetPasscode",loginMethod:"Passcode",loginRoute:"SFA",pageNameDuplicate:"D=pageName"};b.trackPageLoad(a)}function n(){var c={pageName:"onl:logon:Login:Step3PSD2",segment:"onl:logon",subsection:"onl:logon:Login",pageVersion:"AskCardNum",duplicateV10:"D=v10",formStep:"onl:Login:PSD2",impressionsV53:a.scaIdentifier&&a.scaIdentifier.mobile?"CVV|OTP":"CVV",impressionsC53:"D=v53",loginMethod:"passcode_CVV",loginRoute:"SFA_CVV",pageNameDuplicate:"D=pageName"};b.trackPageLoad(c)}function o(){var a={pageName:"onl:logon:Login:Step3PSD2",segment:"onl:logon",subsection:"onl:logon:Login",duplicateV10:"D=v10",formStep:"onl:Login:PSD2",impressionsV53:"CVV|OTP",impressionsC53:"D=v53",loginMethod:"passcode_OTV",loginRoute:"SFA_OTV",pageNameDuplicate:"D=pageName"};b.trackPageLoad(a)}function p(){var a={pageName:"onl:reorder:ForgottenPasscode:YourDetails",segment:"onl:reorder",subsection:"onl:reorder:ForgottenPasscode",formName:"Forgotten_Passcode",duplicateV10:"D=v10",formStep:"onl:forgottenpasscode:step1",pageNameDuplicate:"D=pageName",events:"event7"};b.trackPageLoad(a)}function q(){var a={pageName:"onl:reorder:ForgottenPasscode:DeliveryOptions",segment:"onl:reorder",subsection:"onl:reorder:ForgottenPasscode",duplicateV10:"D=v10",formStep:"onl:forgottenpasscode:step2",impressionsV53:"SMS|Post",impressionsC53:"D=v53",pageNameDuplicate:"D=pageName"};b.trackPageLoad(a)}function r(){var a={pageName:"onl:reorder:ForgottenPasscode:VerificationCode",segment:"onl:reorder",subsection:"onl:reorder:ForgottenPasscode",duplicateV10:"D=v10",formStep:"onl:forgottenpasscode:step3:sms:code",pageNameDuplicate:"D=pageName"};b.trackPageLoad(a)}function t(){var a={pageName:"onl:reorder:ForgottenPasscode:CreateNew",segment:"onl:reorder",subsection:"onl:reorder:ForgottenPasscode",duplicateV10:"D=v10",formStep:"onl:forgottenpasscode:step3:sms:createnew",pageNameDuplicate:"D=pageName"};b.trackPageLoad(a)}function u(){var a={pageName:"onl:reorder:ForgottenPasscode:CheckPostDetails",segment:"onl:reorder",subsection:"onl:reorder:ForgottenPasscode",duplicateV10:"D=v10",formStep:"onl:forgottenpasscode:step3:post",pageNameDuplicate:"D=pageName"};b.trackPageLoad(a)}function v(){var c={pageName:"onl:reorder:ForgottenPasscode:Success",segment:"onl:reorder",subsection:"onl:reorder:ForgottenPasscode",duplicateV10:"D=v10",pageVersion:"/forgotPasscodeReset"===a.previousRoute?"Updated":"Ordered",formStep:"onl:forgottenpasscode:success",pageNameDuplicate:"D=pageName",events:"event8"};b.trackPageLoad(c)}function w(){var a={pageName:"onl:reorder:ForgottenMembership:YourDetails",segment:"onl:reorder",subsection:"onl:reorder:ForgottenMembership",formName:"Forgotten_Membership",duplicateV10:"D=v10",formStep:"onl:forgottenmembership:step1",pageNameDuplicate:"D=pageName",events:"event7"};b.trackPageLoad(a)}function x(){var c={pageName:"onl:reorder:ForgottenMembership:Success",segment:"onl:reorder",subsection:"onl:reorder:ForgottenMembership",pageVersion:_.camelCase(a.selectedAccountType),duplicateV10:"D=v10",formStep:"onl:forgottenpasscode:success",pageNameDuplicate:"D=pageName",events:"event8"};b.trackPageLoad(c)}function y(){var a={pageName:"onl:accounts:EnhancedCookieNotice:EnhancedCookiesNotice",segment:"onl:accounts",subsection:"onl:accounts:EnhancedCookieNotice",pageVersion:"",pageNameDuplicate:"D=pageName"};b.trackPageLoad(a)}function z(){var a={pageName:"onl:accounts:EnhancedCookieNotice:CookieConsentPreferences",segment:"onl:accounts",subsection:"onl:accounts:EnhancedCookieNotice",pageVersion:"",pageNameDuplicate:"D=pageName"};b.trackPageLoad(a)}function A(){var a={pageName:"onl:interstitial:welcome",segment:"onl:interstitial",subsection:"onl:interstitial:welcome",pageNameDuplicate:"D=pageName",loginMethod:b.getLoginMethod(),loginRoute:b.getLoginRoute(),events:"event14,event8"};b.trackPageLoad(a)}function B(){var a={pageName:"onl:reorder:UnlockAccount:Selfserve:YourDetails",segment:"onl:reorder",subsection:"onl:reorder:UnlockAccount",formName:"self_serve_unlockAccount",duplicateV10:"D=v10",formStep:"onl:unlockaccount:yourDetails",pageNameDuplicate:"D=pageName",events:"event7"};b.trackPageLoad(a)}function C(){var a={pageName:"onl:reorder:UnlockAccount:Selfserve:SMSverification",segment:"onl:reorder",subsection:"onl:reorder:UnlockAccount",duplicateV10:"D=v10",formStep:"onl:unlockaccount:SMSverification",pageNameDuplicate:"D=pageName"};b.trackPageLoad(a)}function D(){var a={pageName:"onl:reorder:UnlockAccount:Selfserve:Success",segment:"onl:reorder",subsection:"onl:reorder:UnlockAccount",duplicateV10:"D=v10",formStep:"onl:unlockaccount:complete",pageNameDuplicate:"D=pageName",events:"event8"};b.trackPageLoad(a)}function E(a){var c={pageName:"onl:logon:Login:Membership:Locked",segment:"onl:logon",subsection:"onl:logon:Login",errorName:a};b.trackPageLoad(c)}function F(){var a={pageName:"onl:logon:Login:SessionTimeOut",segment:"onl:logon",subsection:"onl:logon:Login"};b.trackDialogBox(a)}function G(a){var c={pageName:"onl:logon:UnsupportedBrowser:"+a,segment:"onl:logon",subsection:"onl:logon:UnsupportedBrowser",pageNameDuplicate:"D=pageName"};b.trackPageLoad(c)}function H(){var a={pageName:"onl:logon:Login:TermsAndConditions",segment:"onl:logon",subsection:"onl:logon:Login"};b.trackPageLoad(a)}return{getIdentificationAnalyticsData:c,getIdentifyJointOwnerDetails:g,getLockedOutDetails:j,getlogMultipleMemDetails:h,getlogMultipleMemDetailStep1:i,getAuthenticationAnalyticsData:k,getForgotMembershipDetail:w,getForgotPasscodeDetail:p,getForgotPasscodeDeliveryMethod:q,forgotPasscodeVerificationCode:r,forgotPasscodeReset:t,forgotPasscodeSuccess:v,forgotPasscodeConfirm:u,getForgotMembershipSuccess:x,getCookiePolicy:y,getCookiePref:z,getAssistCookieAnalyticsData:d,changeFirstTimePasscodeStep1AnalyticsData:l,changeFirstTimePasscodeStep2AnalyticsData:m,scaCardAuthenticationAnalyticsData:n,scaOtpAuthenticationAnalyticsData:o,getInterstitialAnalyticsData:A,getSelfServeUnlockUserDetailsAnalyticsData:B,getSelfServeUnlockOtpAuthAnalyticsData:C,getSelfServeUnlockSuccessAnalyticsData:D,getSelfServeLockedOutAnalyticsData:E,timeoutAnalytics:F,setBrowserAlertAnalyticsTag:G,setSolusTnCAnalyticsTag:H,initiateTrustAnchorTrackingDetail:e,getTrustAnchorTrackingDetail:f}};a.$inject=["$rootScope","siteTrackingService"],angular.module("appBdlLogin.services").factory("siteAnalyticsUtilService",a)}(),function(){"use strict";angular.module("appBdlLogin.services").factory("snippetServices",["$q","$rootScope","$filter","cookieService",function(a,b,c,d){return{getDiffInMillis:function(a){var b,c;a.indexOf("+")>-1?(b=a.split("+")[0].trim().split("/"),c=a.split("+")[1].trim().split(":")):(b=a.split(" ")[0].trim().split("/"),c=a.split(" ")[1].trim().split(":"));var d=parseInt(b[1])-1,e=new Date(b[2],d,b[0],c[0],c[1],0,0);return new Date-e},isExpiredForPublicSiteCookie:function(a){return!(!a||!a.hasOwnProperty("publicuser"))&&this.getDiffInMillis(a.publicuser.createStamp)/6e4>=10},getCookiePref:function(a){try{var b=decodeURIComponent(d.getCookie("CCP")),c=decodeURIComponent(d.getCookie("CCP_CURRENT")),e={},f=this;return b?f.isValidJSON(b)?(e=JSON.parse(b),c&&e.hasOwnProperty(c)?e[c][a]:e.hasOwnProperty("publicuser")?e.publicuser[a]:"on"):"on":"off"}catch(a){return"on"}},isValidCategory:function(a){return"on"===a||"off"===a},isValidTimeStamp:function(a){try{return new Date-this.getDiffInMillis(a)>0}catch(a){return!1}},isValidJSON:function(a){var b,c={},d=this;try{c=JSON.parse(a),b=Object.keys(c)}catch(a){return!1}for(var e=0;e<b.length;e++){var f=b[e];if("publicuser"!==f&&12!==f.length)return!1;if("publicuser"!==f&&12===f.length&&isNaN(f))return!1;var g=c[f];if(null==g||5!==Object.keys(g).length)return!1;if(!d.isValidTimeStamp(g.catStamp))return!1;if(!d.isValidTimeStamp(g.createStamp))return!1;if(!d.isValidCategory(g.cat2))return!1;if(!d.isValidCategory(g.cat3))return!1;if(!d.isValidCategory(g.cat4))return!1}return!0},displayOTM:function(a,b){try{var c={},d=this;return!a||(!d.isValidJSON(a)||(c=JSON.parse(a),!(!b||c.hasOwnProperty(b))&&!c.hasOwnProperty("publicuser")))}catch(a){return!1}},displayRPM:function(a,b){try{var c=JSON.parse(a),d=this;if(!(c&&b&&c.hasOwnProperty(b)))return!1;if(!(d.getDiffInMillis(c[b].catStamp)/864e5>180))return!1;if("on"!==c[b].cat2||"on"!==c[b].cat3||"on"!==c[b].cat4)return!0}catch(a){return!1}},displayCFM:function(a,b,c){try{var d=JSON.parse(a);return!!d&&(!(!c||d.hasOwnProperty(c))&&(!!d.hasOwnProperty("publicuser")&&!(!b||!this.isExpiredForPublicSiteCookie(d))))}catch(a){return!1}},setSegmentSnippet:function(){try{b.memberType=decodeURIComponent(d.getCookie("tabIndex")),b.memberType?"1"===b.memberType?window.privateBankValue&&window.privateBankSwitch||window.wealthValue&&window.wealthSwitch?b.snippetName="FTBLogin_Decoupled_Wealth":b.snippetName="FTBLogin_Personal_Decoupled":"2"===b.memberType?window.privateBankValue&&window.privateBankSwitch||window.wealthValue&&window.wealthSwitch?b.snippetName="FTBLogin_Decoupled_Wealth":b.snippetName="FTBLogin_Premier_Decoupled":"3"===b.memberType?window.privateBankValue&&window.privateBankSwitch||window.wealthValue&&window.wealthSwitch?b.snippetName="FTBLogin_Decoupled_Wealth":b.snippetName="FTBLogin_Business_Decoupled":b.snippetName="":b.snippetName=""}catch(a){b.snippetName=""}},setSnippetContent:function(){var c=decodeURIComponent(d.getCookie("CCP")),e=decodeURIComponent(d.getCookie("CCP_CURRENT")),f=decodeURIComponent(d.getCookie("CCP_OTM")),g=(decodeURIComponent(d.getCookie("CCP_CURRENT")),a.defer()),h=this;return!0===b.tfaSwitched?(window.privateBankValue&&window.privateBankSwitch?b.snippetName="FTBLogin_Lockedout_TFA_Switched_Decoupled_pb":window.wealthValue&&window.wealthSwitch?b.snippetName="FTBLogin_Lockedout_TFA_Switched_Decoupled_Wlb":b.snippetName="BDL_FTBLogin_Lockedout_TFA_Switched_Decoupled",g.resolve(!0)):window.cookieBannerSwitch&&(h.displayOTM(c,e)?(window.privateBankValue&&window.privateBankSwitch||window.wealthValue&&window.wealthSwitch?b.snippetName="BDL_FTBLogin_cookie_OneTime_Decoupled_Wlb":b.snippetName="BDL_FTBLogin_cookie_OneTime_Decoupled",g.resolve(!0)):h.displayRPM(c,e)?(window.privateBankValue&&window.privateBankSwitch||window.wealthValue&&window.wealthSwitch?b.snippetName="FTBLogin_cookie_Repeat_Decoupled_Wlb":b.snippetName="FTBLogin_cookie_Repeat_Decoupled",g.resolve(!0)):h.displayCFM(c,f,e)?(window.privateBankValue&&window.privateBankSwitch||window.wealthValue&&window.wealthSwitch?b.snippetName="FTBLogin_cookie_CarryForward_Decoupled_Wlb":b.snippetName="FTBLogin_cookie_CarryForward_Decoupled",g.resolve(!0)):(h.setSegmentSnippet(),g.resolve(!0))),g.promise},removeOldMemberFromCCP:function(a){var b,d=this,e=0;for(var f in a)"publicuser"!==f&&++e;var g=c("date")(new Date,"dd/MM/yyyy+H:mm ");return e>14?(angular.forEach(a,function(c,e){"publicuser"!==e&&d.getDiffInMillis(g)<d.getDiffInMillis(a[e].catStamp)&&(g=a[e].catStamp,b=e)}),b&&delete a[b],a):a},isPublicUserLatest:function(a){var b=this,c=!0;return angular.forEach(a,function(d,e){"publicuser"!==e&&c&&b.getDiffInMillis(a.publicuser.catStamp)>b.getDiffInMillis(a[e].catStamp)&&(c=!1)}),c},updateCCPCookie:function(b){var e=a.defer(),f={},g=this;if(decodeURIComponent(d.getCookie("CCP"))&&(f=JSON.parse(decodeURIComponent(d.getCookie("CCP")))),f&&f.hasOwnProperty("publicuser")){if(f.hasOwnProperty(b))g.isPublicUserLatest(f)&&(f[b].cat2=f.publicuser.cat2,f[b].cat3=f.publicuser.cat3,f[b].cat4=f.publicuser.cat4,f[b].catStamp=c("date")(new Date,"dd/MM/yyyy+H:mm "));else{var h={};h[b]={},h[b].cat2=f.publicuser.cat2,h[b].cat3=f.publicuser.cat3,h[b].cat4=f.publicuser.cat4,h[b].catStamp=c("date")(new Date,"dd/MM/yyyy+H:mm "),h[b].createStamp=c("date")(new Date,"dd/MM/yyyy+H:mm "),f=this.removeOldMemberFromCCP(f),f=angular.extend({},f,h)}d.setEncodedCookie("CCP_CURRENT",b),d.setEncodedCookie("CCP",JSON.stringify(f),7300),e.resolve(!0)}else e.resolve(!1);return e.promise}}}])}(),function(){"use strict";var a=function(a,b){function c(a){return{apiName:b.JSON.sendNotification,requestParam:{identityToken:{}}}}return{getRequestPayload:c}};a.$inject=["$rootScope","CONSTANT"],angular.module("appBdlLogin.services").factory("taUtilService",a)}(),function(){"use strict";var a=function(a,b,c,d,e,f){function g(){return v.cancelLoginTimeout(),u.includes(f.path())||(p=b(function(){a.$broadcast("openTimeoutModal")},e.VAR.LOGIN_TIMEOUT_DURATION)),p}function h(){angular.isDefined(p)&&(b.cancel(p),p=void 0)}function i(a,b){return r=d(a,b,e.VAR.LOGIN_TIMER_COUNTDOWN)}function j(){angular.isDefined(r)&&(d.cancel(r),r=void 0)}function k(a){angular.isDefined(a)&&(q=a)}function l(){angular.isDefined(q)&&q()}function m(){return{heading:"Please log in again",description:"We limit the time you have to log in to ten minutes, to help keep your money safe. Please enter your details again.",isClosable:!1,showIcon:!0,isScrollable:!1,buttons:[{label:"Go back to step one",name:"goToStepOne",class:"btn-primary",type:"close",onClick:"goToStepOne"}]}}function n(){return{radius:t,cx:"64",cy:"64",strokeDasharray:2*Math.PI*t,strokeOffset:0}}function o(a){return 2*Math.PI*(t-a*(t/e.VAR.LOGIN_TIMER_COUNTDOWN))}var p,q,r,t=60,u=["/identification","/rememberme","/cookiePref"],v={startLoginTimeout:g,cancelLoginTimeout:h,startCountdownTimer:i,cancelCountdownTimer:j,registerTimeoutCallbackFn:k,executeTimeoutCallbackFn:l,getModalDataObj:m,getCircleData:n,calculateStrokeOffset:o};return v};a.$inject=["$rootScope","$timeout","partial","$interval","CONSTANT","$location"],angular.module("appBdlLogin.services").factory("timeoutService",a)}(),function(){"use strict";var a=function(a,b,c,d,e,f,g,h){function i(a){return{apiName:b.JSON.sendPushNotification,requestParam:{identityToken:{}}}}function j(b,d,g){function i(){var f=a.userData.data.trustAnchorIdentificationToken.failRetry;c({method:g,url:h.apiBasePath+"/"+b,data:d}).success(function(a){j=a}).error(function(a){e.cancel(p),k<f&&(i(),k++),j=a}).then(function(){r=!0,l.resolve(j)},function(){l.resolve(j)})}r=!1;var j,k=1,l=f.defer();return void 0===g&&(g="post"),void 0===d&&(d={}),i(),l.promise}function k(b,c,e){var g=f.defer(),h=a.userData.data.trustAnchorIdentificationToken.initiatePoll;return e?q=d(function(){l(b,c,g,e)},h):l(b,c,g,e),g.promise}function l(b,c,d,f){var g=a.userData.data.trustAnchorIdentificationToken.pollingFrequency;f&&m(b,c,d),p=e(function(){m(b,c,d)},g)}function m(a,b,c){r&&j(a,b).then(function(a){return e.cancel(p),c.resolve(a)})}function n(a){return e.cancel(p),p=void 0,a.resolve()}function o(){var a=f.defer();return n(a),q&&d.cancel(q),a.promise}var p,q,r=!0;return a.$on("$destroy",function(){angular.isDefined(p)&&(e.cancel(p),p=void 0),q&&d.cancel(q)}),{getRequestPayload:i,postPollingApiRequest:k,stopPolling:o}};a.$inject=["$rootScope","CONSTANT","$http","$timeout","$interval","$q","timeoutService","ENV"],angular.module("appBdlLogin.services").factory("trustAnchorService",a)}();var AppName=window.AppName||{};AppName.Module=AppName.Module||{},AppName.Module={patternNum:/^([0-9]+)$/,patternNonNum:/^([a-zA-Z]+)$/,patternAlphaNum:/^([a-zA-Z0-9]+)$/,formInstance:{},validateEmptyOnSubmit:function(a){return void 0!=a&&void 0!=this.formInstance&&this.formInstance.formSubmitted?"required":void 0!=a&&a.$dirty?"required":void 0},nameValidation:function(a){var b=/^[a-zA-Z\s\u2010\u002D\']+$/,c=/([\s\'\u002D]{2,}(?!\\S))/i,d=void 0!=a?a.$modelValue:"";return d?b.test(d)?c.test(d)?"INP3":d.length<2?"INP1":void 0:"INP2":this.validateEmptyOnSubmit(a)},membershipValidation:function(a){var b=void 0!=a?a.$modelValue:"",c=[/(20)[1-5]0[0-9]{8}/];return b?12!==b.length?"INP1":this.patternNum.test(b)?c[0].test(b)||12!==b.length?void 0:"INP3":"INP2":this.validateEmptyOnSubmit(a)},cardNumberValidation:function(a){var b=[453978,453979,465858,465859,465860,465861,465862,465863,465864,465865,465866,465867,465901,465902,465911,465921,465922,465923,484419,484420,491748,491749,492822,492823,492824,492825,492826,492827,492828,492829,492830,492831,459630,459631,459632,459633,459634,459635,492890,492891,492892,492893],c=b.map(function(a){return String(a)}),d=!0,e=/(\d{4} *\d{4} *\d{4} *\d{4})/,f=void 0!=a?a.$modelValue:"";if(!f||f instanceof Array)return this.validateEmptyOnSubmit(a);var f=f.replace(/\s/g,""),g=f.substring(0,6);if(!e.test(f))return"INP2";if(16!==f.length)return"INP1";if(16===f.length){for(var h=0;h<c.length;h++){if(angular.equals(g,c[h]))return void(d=!0);d=!1}if(!d)return"INP3"}},sortCodeValidation:function(a){a=a.join("")?a.join("-"):a.join("");var b=[/^(?!(?:0{6}|00-00-00))(?:\d{6}|\d\d-\d\d-\d\d)$/],c=[/2[0-3]-[0-9]{2}-[0-9]{2}/];return a?b[0].test(a)?c[0].test(a)?void 0:"INP2":"INP1":"required"},merchantSortCodeValidation:function(a){a=a.join("")?a.join("-"):a.join("");var b=[/^(?!(?:0{6}|00-00-00))(?:\d{6}|\d\d-\d\d-\d\d)$/];return a?b[0].test(a)?void 0:"INP1":"required"},accountNumberValidation:function(a){var b=[/^[0-9]+$/,/^[0-9]+$/,/^[0-9]+$/,/^[0-9]+$/],c=void 0!=a?a.$modelValue:"";return c?b[0].test(c)?8!==c.length?"INP1":void 0:"INP2":this.validateEmptyOnSubmit(a)},secCodeValidation:function(a){var b=void 0!=a?a.$modelValue:"";return b?3!==b.length?"INP1":this.patternNum.test(b)?void 0:"INP2":this.validateEmptyOnSubmit(a)},investmentValidation:function(a){var b=/(\d{7}-*\d{3})/,c=void 0!=a?a.$modelValue:"";return"-"!==c?b.test(c)?11!==c.length?"INP1":void 0:"INP2":this.validateEmptyOnSubmit(a)},passcodeValidation:function(a){var b=void 0!=a?a.$modelValue:"";return b?this.patternNum.test(b)?5!==b.length?"INP1":void 0:"INP2":this.validateEmptyOnSubmit(a)},newPasscodeValidation:function(a,b){var c=void 0!=a?a.$modelValue:"";return c?this.patternNum.test(c)?5!==c.length?"INP1":b&&b!==c?"INP3":void 0:"INP2":this.validateEmptyOnSubmit(a)},memorableWordValidation:function(a,b,c){var d=[/^([a-zA-Z0-9]+){6,8}$/],e=/^([a-zA-Z]+){6,8}$/,f=void 0!=a?a.$modelValue:"";return f?b&&!d[0].test(f)?"INP1":b||e.test(f)?c&&c!==f?"INP3":void 0:"INP2":this.validateEmptyOnSubmit(a)},memorableCharValidation:function(a){var b=[/^(?:([a-zA-Z0-9]){2}|([a-zA-Z0-9])-([a-zA-Z0-9]))$/];return a=a.join("")?a.join("-"):a.join(""),a&&"-"!==a?b[0].test(a)?void 0:"INP1":"required"},mobilePinsentryCode:function(a){var b=[/^(?!(?:0{8}|0000-0000))(?:\d{8}|\d\d\d\d-\d\d\d\d)$/];return a=a.join("")?a.join("-"):a.join(""),a&&"-"!==a?b[0].test(a)?void 0:"INP1":"required"},cardLastDigitsValidation:function(a,b){var c=void 0!=a?a.$modelValue:"";return c?this.patternNum.test(c)?c.length!==b?"INP1":void 0:"INP2":this.validateEmptyOnSubmit(a)},browserAlertCheckValidation:function(a){return void 0!==a&&0===a.length?"required":void 0},phoneNumberValidation:function(a){var b=/^(07?[0-9]+|\+447?[0-9]+)$/,c=/^[0-9\+]+$/g,d=void 0!=a?a.$modelValue:"";return d?c.test(d)?b.test(d)?"+"==d[0]&&13!==d.length?"INP3":"0"==d[0]&&11!==d.length?"INP3":void 0:"INP1":"INP2":this.validateEmptyOnSubmit(a)},securityCodeValidation:function(a){var b=/^[0-9]+$/,c=void 0!=a?a.$modelValue:"";return c?3!==c.length?"INP1":b.test(c)?void 0:"INP2":this.validateEmptyOnSubmit(a)},mortgageNumberValidation:function(a){var b=/^9[0-9]{9}$/,c=void 0!=a?a.$modelValue:"";return c?10!==c.length?"INP1":b.test(c)?void 0:"INP2":this.validateEmptyOnSubmit(a)},solusAccNosValidation:function(a){var b=/^ID(\d{7}-*\d{3})$/;return a=a.join("")?a.join("-"):a.join(""),a?13!==a.length?"INP1":b.test(a)?void 0:"INP1":"required"},smsCode:function(a){var b=/^[0-9]{6}$/,c=void 0!=a?a.$modelValue:"";return c?6!==c.length?"INP1":b.test(c)?void 0:"INP2":this.validateEmptyOnSubmit(a)},interstitialCheckValidation:function(a){return void 0!==a&&0===a.length?"required":void 0},countryDropdownValidator:function(a){return void 0!==a&&-1==a?"required":void 0},emailValidation:function(a){var b=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,c=void 0!=a?a.$modelValue:"";return c?b.test(c)?void 0:"INP1":this.validateEmptyOnSubmit(a)},settlementAccNoValidator:function(a){var b=void 0!=a?a.$modelValue:"";return b?this.patternNum.test(b)?8!==b.length?"INP1":void 0:"INP2":this.validateEmptyOnSubmit(a)},merchantIdValidator:function(a){var b=void 0!=a?a.$modelValue:"";return b?this.patternNum.test(b)?7!==b.length?"INP1":void 0:"INP2":this.validateEmptyOnSubmit(a)}},function(){"use strict";angular.module("rolb.services").factory("jumpTo",["$document",function(a){var b=a[0].getElementById("bmb-integration-iframe");return function(a){b&&(b.src=a)}}]).factory("invalidateSession",["$injector","jumpTo","webContext",function(a,b,c){var d=0;return function(e){0==d&&(d++,a.get("$http").post(c("InvalidateSession.json"),{}).success(function(){b(e)}).error(function(){}))}}]).factory("containerInterface",["jumpTo","invalidateSession",function(a,b){return{startSpinner:function(){a("barclayload://startSpinner")},stopSpinner:function(){a("barclayload://stopSpinner")},home:function(){b("barclayload://done")},error:function(a,c){b("barclayload://error?error="+a+"&message="+c)},logout:function(a,c){b("barclayload://error?error="+a+"&message="+c)},locationChange:function(a,b,c){}}}])}(),function(){"use strict";angular.module("rolb.services").factory("locationUtil",["$document",function(a){return{parseHash:function(b){var c=a[0].createElement("a");return c?(c.href=b,c.hash.replace(/#/,"")):""}}}]).factory("secureRoute",["appName","locationUtil","$location",function(a,b,c){var d=["/"+a+"/identification","/"+a+"/home"],e="";return{changeView:function(a){window.scrollTo(0,0),e=a,c.path(a)},locationChange:function(c,f,g){if(0==b.parseHash(g).indexOf("/"+a)){var h=b.parseHash(f);if(0==h.indexOf("/"+a)){for(var i=0;i<d.length;++i)if(d[i]==h)return;h!=e&&c.preventDefault()}}}}}])}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("authenticationCtrl",["$rootScope","$scope","$injector","partial","authenticationUtilService","$http","siteTrackingService","siteAnalyticsUtilService","authLoginUtilService","timeoutService",function(a,b,c,d,e,f,g,h,i){var j=c.get("secureRoute"),k=c.get("services"),l=c.get("CONSTANT");b.selectedAuthType=0,b.rdoAuth={selected:"MTFA"},b.formsObjArr={passcodeMemWordForm:{formSubmitted:!1},oneTimePasscodeForm:{formSubmitted:!1},MTFAInputForm:{formSubmitted:!1},TFAInputForm:{formSubmitted:!1}},b.browser={valid:!1},b.formsLoaded=!1,b.submitBtnLabel="Log in to Online Banking",b.cancelBtnLabel="Back",b.hideSubmitBtn=!1,b.$on("step2formsLoaded",function(a,c){b.globalErrorFormName=c,b.formsLoaded=!0,AppName.Module.formInstance=b.formsObjArr[c]}),b.$on("displayglobalerrorHandler",function(a,c){b.displayglobalerror=c,i.setFocusOnGlobalErrors()}),b.authLoginOptions=function(){b.authMTFATemplate=d("authentication/authMTFA.html"),b.authSMSFormTemplate=d("authentication/authSMSForm.html"),b.mtfaFormTemplate=d("authentication/mtfaForm.html"),b.authTFATemplate=d("authentication/authTFA.html"),b.authSFATemplate=d("authentication/authSFA.html"),b.changeFirstTimePasscodeFormTemplate=d("authentication/changeFirstTimePasscode.html"),b.passcodeMemorableFormTemplate=d("authentication/passcodeMemorableword.html"),b.scaAuthenticationFormTemplate=d("authentication/scaAuthentication.html"),b.authTypesArr=[{id:0,type:"MTFA",label:"The Barclays app",templateUrl:b.authMTFATemplate,hidden:!1},{id:1,type:"TFA",label:"PINsentry card reader",templateUrl:b.authTFATemplate,hidden:!1},{id:2,type:"SFA",label:"Passcode and memorable word",templateUrl:b.authSFATemplate,hidden:!1}];var c="MTFA";b.showSMS=!0,b.loadSCTag=!0,"NONE"!==b.authType&&b.showDFA?(c=b.authType,b.DFAWithMTFA?(b.showSMS=!1,b.authTypesArr[1].hidden=!0):b.showAll&&(b.showSMS=!1)):"NONE"!==b.authType&&b.showTFA?(b.mtfaAvailable?(b.showSMS=!1,c=b.verifyTFAType):c="TFA",b.showLockedOutOfSFAMsg||(b.authTypesArr[2].hidden=!0)):"NONE"!==b.authType&&b.showMTFA?(b.showSMS=!1,b.authTypesArr[1].hidden=!0,b.showLockedOutOfSFAMsg||(b.authTypesArr[2].hidden=!0)):"NONE"!==b.authType&&b.showSFA&&(b.authTypesArr[1].hidden=!0,c="SFA"),(a.oneTimePasscodeChange||b.showLockedOutOfSFAMsg)&&(c="SFA"),b.isMerchantCustomer||a.userData.data.trustAnchorIdentificationToken&&a.userData.data.trustAnchorIdentificationToken.trustAnchorEligible||(c=a.userData.data.defaultAuthenticationMethod),b.isMerchantCustomer&&(b.authTypesArr[0].hidden=!0),_.remove(b.authTypesArr,function(a){return a.hidden}),b.authTypesConfig=e.getAuthTypeValues(b.authTypesArr),b.authTypeChange(c)},b.mobilPINSentryGridData=e.mobilPINSentryGridData(),b.cardReaderGridData=e.cardReaderGridData(),b.authTypeChange=function(c){var d;_.isObject(c)?(d=c.currentSelected,c=b.authTypesArr[d].type):d=_.findIndex(b.authTypesArr,{type:c}),"SFA"===c?(b.selectedAuthType=d,b.rdoAuth.selected=c,b.authType="SFA",g.setLoginMethod("Passcode"),g.setLoginRoute("SFA_NonPSD2"),b.cancelBtnLabel="Back",b.showLockedOutOfSFAMsg?b.hideSubmitBtn=!0:b.hideSubmitBtn=!1,b.displayFirstTimePasscode?(b.submitBtnLabel="Verify",b.cancelBtnLabel="Cancel"):b.scaEligible?(g.setLoginRoute("SFA"),b.submitBtnLabel="Continue"):b.submitBtnLabel="Log in to Online Banking",b.formsLoaded&&(b.globalErrorFormName=b.displayFirstTimePasscode?"oneTimePasscodeForm":"passcodeMemWordForm")):"TFA"===c?(b.selectedAuthType=d,b.rdoAuth.selected=c,b.authType="TFA",b.verifyTFAType="TFA",a.step="authTFA",b.submitBtnLabel="Log in to Online Banking",b.cancelBtnLabel="Back",b.hideSubmitBtn=!1,g.setLoginMethod("PinSentry"),g.setLoginRoute("TFA"),b.formsLoaded&&(b.globalErrorFormName="TFAInputForm")):(b.selectedAuthType=d,b.rdoAuth.selected=c,b.authType="TFA",b.verifyTFAType="MTFA",a.step="authMTFA",b.submitBtnLabel="Log in to Online Banking",b.cancelBtnLabel="Back",b.hideSubmitBtn=b.showSMS,g.setLoginMethod("MobilePinSentry"),g.setLoginRoute("MTFA"),b.formsLoaded&&(b.globalErrorFormName="MTFAInputForm")),b.formsLoaded&&(AppName.Module.formInstance=b.formsObjArr[b.globalErrorFormName]),b.loadSCTag&&!b.displayFirstTimePasscode&&(a.oneTimePasscodeChange?(h.changeFirstTimePasscodeStep2AnalyticsData(),a.oneTimePasscodeChange=!1):b.setSCTags(),b.loadSCTag=!1)},b.rdoAuthTypeChange=function(){b.authTypeChange(b.rdoAuth.selected)},!1===window.threatMetrixExpansionSwitch&&k.apiService(l.JSON.threatMetrixProfiling).then(function(a){a&&a.tmxServer&&f.jsonp(a.tmxServer+"/fp/tags.js?org_id="+a.orgId+"&session_id="+a.sessionId+"&pageid="+a.pageId+"&callback=JSON_CALLBACK")}),b.back=function(){j.changeView(l.VIEWS.identification)},b.setSCTags=function(){var a;_.forEach(b.authTypesArr,function(c){"SFA"==c?a+=void 0==a?"Passcode":"|Passcode":"TFA"==c?a+=void 0==a?"PinSentry":"|PinSentry":"MTFA"==c&&(b.showSMS?a+=void 0==a?"MobilePinSentry_disabled":"|MobilePinSentry_disabled":a+=void 0==a?"MobilePinSentry":"|MobilePinSentry")}),b.$watch("browser.valid",function(){b.browser.valid&&(h.getAuthenticationAnalyticsData(a),b.showLockedOutOfSFAMsg&&g.tagAlertsOnPage("LockedOutPasscodeLogin"))})},b.showValidationErrorsOnBlur=function(){this.validationErrors=!0},b.getSnippetsForPage=function(c){k.apiService(c).then(function(c){b.contentResponse={},c&&(a.cookieSnippets?(b.contentResponse=c,b.faqContent=k.setFaqContent(c)):k.apiService(l.JSON.loginStep1NoSavedMember).then(function(c){c&&(angular.forEach(c.contentContainer.content.snippets,function(a,b){a.content=a.content.replace("https://bank.barclays.co.uk/olb/auth/InternetCookies.action?authECN=true","#/cookiePref")}),a.cookieSnippets=c.contentContainer.content.snippets,b.contentResponse=c,b.faqContent=k.setFaqContent(c))})),"NONE"===b.authType&&b.showAuthScreen("MTFA")})},b.showAuthScreen=function(a){k.apiService(l.JSON.DFAContent).then(function(c){b.contentResponse={},c&&(b.contentResponse=c,b.faqContent=k.setFaqContent(c)),b.authType=a,b.authLoginOptions()})},b.forwardUser=function(b){"INTERSTITIAL"===b.body.redirectToken.type?b.body.redirectToken.displayTypeCode?(a.interstitial={},a.interstitial.displayTypeCode=b.body.redirectToken.displayTypeCode,j.changeView(l.VIEWS.interstitial)):!0===b.body.redirectToken.dynamicInterstitialEligible&&"CHANNELAPP"===b.body.redirectToken.appName?(a.$broadcast("loader_on"),window.location.href=b.body.redirectToken.dynamicInterstitialAddress):!0===b.body.redirectToken.dynamicInterstitialEligible&&(a.interstitial={},a.interstitial.dyanmicInterstitialAddress=b.body.redirectToken.dynamicInterstitialAddress,a.interstitial.appName=b.body.redirectToken.appName,j.changeView(l.VIEWS.dynamicInterstitial)):(a.$broadcast("loader_on"),window.location.href=b.body.redirectToken.url)},b.sendHiddenHelpCardsAndRoute=function(c){var d=a.hiddenHelpCards.filter(function(b){return-1===a.existingHelpCards.indexOf(b)}),e={helpCards:d},f=l.JSON.addHiddenHelpCards,g=k.setRememberMeInfoPostAuthentication(c);k.apiService(f,e).then(function(a){g&&g.rememberMeDVOs&&g.rememberMeDVOs.length>0?k.apiService(l.JSON.rememberUser,g).then(function(a){b.forwardUser(c)}):b.forwardUser(c)})},b.hasSFANoPasscode=function(){var b=!1;if(a.userData&&a.userData.data&&a.userData.data.authenticationTokenSpecificationList)for(var c=a.userData.data.authenticationTokenSpecificationList,d=0;d<c.length;d++)"SFA"===c[d].method&&a.userData.data.authenticationTokenSpecificationList[d].noPasscode&&(b=!0);return b},k.isEmpty(a.userData)?j.changeView(l.VIEWS.identification):(a.forgotPasscode=!1,k.apiService(l.JSON.getHiddenHelpCards).then(function(c){if(c&&c.body&&c.body.helpCards&&(a.hiddenHelpCards=c.body.helpCards,a.existingHelpCards=angular.copy(c.body.helpCards)),a.userData){b.authMethod=a.userData.data.defaultAuthenticationMethod;var d=a.userData.data.changeFirstTimePasscode;a.changeFirstTimePasscodeSwitch=d,void 0===a.userData.data.changeFirstTimePasscode&&void 0===a.changeFirstTimePasscodeSwitch&&(a.changeFirstTimePasscodeSwitch=!0),d&&!a.resetViaSMS&&b.hasSFANoPasscode()?(b.displayFirstTimePasscode=!0,b.authMethod="SFA"):b.displayFirstTimePasscode=!1;for(var e=a.hiddenHelpCards,f=!0,g=0;g<e.length;g++)"assetId_dfa_firsttime_login"===e[g]&&(f=!1);if(!0===f&&(a.hiddenHelpCards[a.hiddenHelpCards.length]="assetId_dfa_firsttime_login"),"SFA"===b.authMethod?(b.authType="SFA",b.verifyTFAType="TFA"):(b.authType="TFA","MTFA"===b.authMethod?b.verifyTFAType="MTFA":b.verifyTFAType="TFA"),b.contentResponse={},a.userData.data&&a.userData.data.authenticationTokenSpecificationList){var h=a.userData.data.authenticationTokenSpecificationList,i=h.length;if(b.scaEligible=a.userData.data.scaEligible,b.isTwoFactorEnabled=a.userData.data.twoFactorEnabled,b.isMerchantCustomer=a.userData.data.merchantCustomer,1===i)if(a.userData.data.lockedMethods&&a.userData.data.lockedMethods.length){switch(b.showLockedOutOfSFAMsg=!0,b.authMethod){case"TFA":b.showTFA=!0,b.mtfaAvailable=!1,b.showPinsentryImg=!0;break;case"MTFA":b.showMTFA=!0,b.showMobPinsentryImg=!0}!0===f?(b.authMethod="NONE",b.authType="NONE",b.verifyTFAType=b.showMTFA?"MTFA":"TFA",b.getSnippetsForPage(l.JSON.firstTimeDFAContent)):b.getSnippetsForPage(l.JSON.DFAContent)}else switch(b.authMethod){case"NONE":b.getSnippetsForPage(l.JSON.firstTimeDFAContent);break;case"SFA":b.getSnippetsForPage(l.JSON.SFAContent),b.showSFA=!0;break;case"TFA":b.getSnippetsForPage(l.JSON.TFAContent),b.showTFA=!0,b.mtfaAvailable=!1;break;case"MTFA":b.getSnippetsForPage(l.JSON.MTFAContent),b.showMTFA=!0}else if(2===i){for(var g=0;g<h.length;g++)"SFA"===h[g].method?(!1===f?b.getSnippetsForPage(l.JSON.DFAContent):(b.authMethod="NONE",b.authType="NONE",b.verifyTFAType="TFA",b.getSnippetsForPage(l.JSON.firstTimeDFAContent)),b.sfaAvailable=!0):b.tfaMethodAvailable=h[g].method;!0===b.sfaAvailable?a.userData.data.lockedMethods&&a.userData.data.lockedMethods.length?(b.showLockedOutOfSFAMsg=!0,"MTFA"===b.tfaMethodAvailable?b.showMTFA=!0:(b.showTFA=!0,b.mtfaAvailable=!1)):(b.showDFA=!0,"TFA"===b.tfaMethodAvailable?(b.DFAWithTFA=!0,b.showPinsentryImg=!0):(b.DFAWithMTFA=!0,b.showMobPinsentryImg=!0,b.verifyTFAType="MTFA")):(b.showTFA=!0,b.mtfaAvailable=!0,a.userData.data.lockedMethods&&a.userData.data.lockedMethods.length?(b.showLockedOutOfSFAMsg=!0,!0===f?(b.authMethod="NONE",b.authType="NONE",b.verifyTFAType="TFA",b.getSnippetsForPage(l.JSON.firstTimeDFAContent),b.showPinsentryImg=!0):b.getSnippetsForPage(l.JSON.DFAContent)):b.getSnippetsForPage(l.JSON.MTFAContent))}else 3===i&&(f?(b.authMethod="NONE",b.authType="NONE",b.verifyTFAType="TFA",b.getSnippetsForPage(l.JSON.firstTimeDFAContent)):b.getSnippetsForPage(l.JSON.DFAContent),b.showMobPinsentryImg=!0,a.userData.data.lockedMethods&&1===a.userData.data.lockedMethods.length?(b.showLockedOutOfSFAMsg=!0,b.showTFA=!0,b.mtfaAvailable=!0):(b.showDFA=!0,b.showAll=!0))}}b.authForgetId=a.authForgetId,"NONE"!==b.authType&&b.authLoginOptions()}),b.submitAuth=function(){AppName.Module.formInstance.formSubmitted=!0,setTimeout(function(){b.$broadcast("submitAuthForm",b.globalErrorFormName)},300)},b.cancelAuth=function(){"passcodeMemWordForm"==b.globalErrorFormName?b.$broadcast("cancelBtnClick"):window.history.back()},b.mobileView=i.isMobileView(),window.onresize=function(){b.mobileView=i.isMobileView(),b.$apply()})}])}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("authSFACtrl",["$rootScope","$route","$scope","$injector","authenticationUtilService","authLoginUtilService",function(a,b,c,d,e,f){var g=d.get("secureRoute"),h=d.get("services"),i=d.get("snippetServices"),j=d.get("CONSTANT");if(c.forgottenPasscode=function(){a.userData.dateOfBirth=null,a.userData.cardNumber=null,f.getResetViaSMSSwitch(!1)},c.userType=a.wealthUser,angular.element(document).ready(function(){"SFA"!==c.authType||c.displayFirstTimePasscode||c.$emit("step2formsLoaded","passcodeMemWordForm")}),a.resetViaSMS=!1,c.infoAlertContent=e.passcodeInfoAlertContent(),c.lockedSFAAlertContent=e.lockedSFAAlertContent(),c.authenticationToken={},c.memCharConfigFn=function(){c.configForMemChars=e.memCharConfigFn(c.authenticationToken.digit1,c.authenticationToken.digit2)},c.routeOnError=function(c){var d=!0;c.header.messages?angular.forEach(c.header.messages,function(e){"SELF_SERVE_UNLOCK"===e.type?(a.errorPageRedirect=!0,a.selfServeLockedError=c,g.changeView(j.VIEWS.selfServeMemLockedOut),d=!1):"LOCKED"===e.type?(a.errorPageRedirect=!0,a.contentResponse.errorJSON=c,a.lockedOut=!0,g.changeView(j.VIEWS.lockedOut),d=!1):"DFA_LOCK_OUT_SFA"===e.type?(a.contentResponse.errorJSON={},a.userData.data.lockedMethods=new Array,a.userData.data.lockedMethods[0]="SFA",angular.forEach(a.userData.data.authenticationTokenSpecificationList,function(b,c){"SFA"===b.method&&a.userData.data.authenticationTokenSpecificationList.splice(c,1)}),"SFA"===a.userData.data.defaultAuthenticationMethod&&(1===a.userData.data.authenticationTokenSpecificationList.length?a.userData.data.defaultAuthenticationMethod=a.userData.data.authenticationTokenSpecificationList[0].method:a.userData.data.defaultAuthenticationMethod="TFA"),b.reload(),d=!1):"UNLOCK"===e.type?(a.errorPageRedirect=!0,a.contentResponse.errorJSON=c,a.userData.dateOfBirth=null,a.userData.cardNumber=null,f.getResetViaSMSSwitch(),d=!1):"NEW_PASSCODE_AND_MEMORABLE_WORD"===e.type&&(a.contentResponse.errorJSON=c,a.forgotPasscodeSuccess=!0,a.userData.data.defaultAuthenticationMethod="SFA",g.changeView(j.VIEWS.authentication),d=!1)}):c.type&&"CONTEXTUAL_EXCEPTION"===c.type&&(d=!0),d&&(a.errorPageRedirect=!0,a.contentResponse.errorJSON=c,g.changeView(j.VIEWS.identification),a.stopFlow=!0,a.userData={},a.resetViaSMS=!1)},c.showValidationErrorsOnBlur=function(){this.validationErrors=!0},c.resetPasscodeForm=function(){},c.$on("submitAuthForm",function(a,b){"passcodeMemWordForm"==b&&(c.passcodeMemWordForm.$invalid?(c.passcodeMemWordForm.showErrorsIfAny=!0,c.$emit("displayglobalerrorHandler",!0)):c.submitSFADetails())}),c.$on("cancelBtnClick",function(d){c.noPasscode&&c.changeFirstTimePasscodeSwitch?(a.userData=a.identityUserData,delete a.identityUserData,a.oneTimePasscodeChange=!0,b.reload()):g.changeView(j.VIEWS.identification)}),c.submitSFADetails=function(){var b;if(c.noPasscode&&c.changeFirstTimePasscodeSwitch){var d={passcode:c.model.newPasscode.value,secondPasscode:c.model.newPasscodeConfirm.value,firstMemorableWord:c.model.memWord.value,secondMemorableWord:c.model.memWordConfirm.value,mobile:h.isMobile(),tempPasscode:a.tempPasscode};b=j.JSON.NewPasscodeAndMemorableWordSFALogin}else if(c.noMemorableWord){var d={passcode:c.model.passcode.value,firstMemorableWord:c.model.memWord.value,secondMemorableWord:c.model.memWordConfirm.value};b=j.JSON.FirstTimeSFALogin}else{var f=c.model.memorableCharacters.value.split("-"),d={passcode:c.model.passcode.value,firstMemorableCharacter:f[0],secondMemorableCharacter:f[1],mobile:h.isMobile()};b=j.JSON.SFALogin}window.scrollTo(0,0),h.apiService(b,d).then(function(f){a.contentResponse={},a.contentResponse.errorJSON={},f&&(!1===f.header.stopFlow?f.body.merchantCustomer?(e.setMerchantUserData(d,f,b),g.changeView(j.VIEWS.solusMerchantTnc)):(a.userData.data=f.body,a.scaIdentifier=f.body.scaIdentifier,null!=a.scaIdentifier&&!0===a.scaIdentifier.scaEligible?(a.scaUserData={data:d,isSFAEligible:b===j.JSON.SFALogin},!0===a.scaIdentifier.card?g.changeView(j.VIEWS.scaCardAuthentication):!0===a.scaIdentifier.mobile?c.getScaMobileNumber():g.changeView(j.VIEWS.scaCardAuthentication)):(f.body.biocatchToken&&$(document.querySelector("meta[name='bcsid']")).attr("content",""+f.body.biocatchToken.sid),delete a.identityUserData,i.updateCCPCookie(f.body.verificationToken.membershipNumber).then(function(b){"FEDERATION"===f.body.redirectToken.type?(a.$broadcast("loader_on"),window.location.href=f.body.redirectToken.url+"?REF="+f.body.redirectToken.referenceId):c.sendHiddenHelpCardsAndRoute(f)}))):c.routeOnError(f))})},c.getScaMobileNumber=function(){h.apiService(j.JSON.getScaMobileNumber,{}).then(function(b){a.contentResponse={},a.contentResponse.errorJSON={},b&&(!1===b.header.stopFlow?(a.scaIdentifier=b.body.scaIdentifier,g.changeView(j.VIEWS.scaOtpAuthentication)):c.routeOnError(b))})},h.isEmpty(a.userData))g.changeView(j.VIEWS.identification);else{c.model=e.initializeModelValues();var k=!1;if(a.userData&&a.userData.data&&a.userData.data.authenticationTokenSpecificationList){a.scaAuthenticationTokenSpecificationList=a.userData.data.authenticationTokenSpecificationList;var l=a.userData.data.authenticationTokenSpecificationList;a.userData.data.hasOwnProperty("changeFirstTimePasscode")?c.changeFirstTimePasscodeSwitch=a.userData.data.changeFirstTimePasscode:c.changeFirstTimePasscodeSwitch=a.changeFirstTimePasscodeSwitch;for(var m=0;m<l.length;m++)"SFA"===l[m].method&&(k=a.userData.data.authenticationTokenSpecificationList[m].supportNumeric,a.userData.data.authenticationTokenSpecificationList[m].noPasscode?(c.noPasscode=!0,c.noMemorableWord=!0,c.displayMemorableWordTooltips=!1,c.displayPasscodeAndMemorableWordTooltips=!0,a.step="newPasscodeAndMemorableWord",c.model.memWord.supportNumeric=!!k):a.userData.data.authenticationTokenSpecificationList[m].noMemorableWord?(c.noPasscode=!1,c.noMemorableWord=!0,c.displayMemorableWordTooltips=!0,c.displayPasscodeAndMemorableWordTooltips=!1,a.step="newPasscodeAndMemorableWord",c.model.passcode.step="newPasscodeAndMemorableWord",c.model.memWord.supportNumeric=!!k):(c.authenticationToken={},c.noPasscode=!1,c.noMemorableWord=!1,c.authenticationToken.digit1=e.getOrdinalNumber(l[m].digit1),c.authenticationToken.digit2=e.getOrdinalNumber(l[m].digit2),c.model.hasOwnProperty("passcode")&&(c.model.passcode.step="memCharSelection"),a.step="memCharSelection",c.memCharConfigFn()))}c.authForgetId=a.authForgetId,void 0!==a.resetViaSMS&&a.resetViaSMS||a.resetViaPost||(c.memorableCharOptions=e.getMemorableCharOptions(k)),h.apiService(j.JSON.authSFA).then(function(a){a&&(c.contentResponse=a,c.faqContent=h.setFaqContent(a))})}}])}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("authTFACtrl",["$rootScope","$route","$scope","$injector","authenticationUtilService","authLoginUtilService",function(a,b,c,d,e,f){var g=d.get("secureRoute"),h=d.get("services"),i=d.get("snippetServices"),j=d.get("CONSTANT");c.mobilePinsEntryInputConfig=e.mobilePinsEntryInputConfig(),c.infoAlertContent=e.tfaInfoAlertContent(),angular.element(document).ready(function(){"TFA"===c.authType&&"MTFA"===c.verifyTFAType?c.$emit("step2formsLoaded","MTFAInputForm"):"TFA"===c.authType&&"TFA"===c.verifyTFAType&&c.$emit("step2formsLoaded","TFAInputForm")}),c.routeOnError=function(c){window.scrollTo(0,0);var d=!0;angular.forEach(c.header.messages,function(e){"SELF_SERVE_UNLOCK"===e.type?(a.errorPageRedirect=!0,a.selfServeLockedError=c,g.changeView(j.VIEWS.selfServeMemLockedOut),d=!1):"MEMBERSHIP_UNLOCK"===e.type||"LOCKED"===e.type?(a.errorPageRedirect=!0,a.contentResponse.errorJSON=c,a.lockedOut=!0,g.changeView(j.VIEWS.lockedOut),d=!1):"DFA_LOCK_OUT_SFA"===e.type?(a.contentResponse.errorJSON={},a.userData.data.lockedMethods=new Array,a.userData.data.lockedMethods[0]="SFA",angular.forEach(a.userData.data.authenticationTokenSpecificationList,function(b,c){"SFA"===b.method&&a.userData.data.authenticationTokenSpecificationList.splice(c,1)}),"SFA"===a.userData.data.defaultAuthenticationMethod&&(1===a.userData.data.authenticationTokenSpecificationList.length?a.userData.data.defaultAuthenticationMethod=a.userData.data.authenticationTokenSpecificationList[0].method:a.userData.data.defaultAuthenticationMethod="TFA"),b.reload(),d=!1):"UNLOCK"===e.type&&(a.serviceError=!0,a.contentResponse.errorJSON=c,a.userData.dateOfBirth=null,a.userData.cardNumber=null,f.getResetViaSMSSwitch(),d=!1)}),d&&(g.changeView(j.VIEWS.identification),a.stopFlow=!0,a.userData={},a.contentResponse.errorJSON=c)},c.showValidationErrorsOnBlur=function(){this.validationErrors=!0},c.$on("submitAuthForm",function(a,b){"TFAInputForm"==b&&void 0!=c.TFAInputForm?c.submitTFAForm():"MTFAInputForm"==b&&void 0!=c.MTFAInputForm&&(c.showSMS?c.submitSMSForm():c.submitMTFAForm())}),c.submitTFAForm=function(){var a,b={};if(c.TFAInputForm.$invalid)return c.TFAInputForm.showErrorsIfAny=!0,void c.$emit("displayglobalerrorHandler",!0);var d=c.model.mobilePinsentryCode.value.split("-");b={cardDigits:c.model.lastDigits.value,pinsentryCode:{partOnePasscode:d[0],partTwoPasscode:d[1]},mobile:h.isMobile()},a=j.JSON.TFALogin,c.submitFormDetails(a,b)},c.submitMTFAForm=function(){var a,b={};if(c.MTFAInputForm.$invalid)return c.MTFAInputForm.showErrorsIfAny=!0,void c.$emit("displayglobalerrorHandler",!0);var d=c.model.mobilePinsentryCode.value.split("-");b={pinsentryCode:{partOnePasscode:d[0],partTwoPasscode:d[1]},resetPinSentry:"false",mobile:h.isMobile()},a=j.JSON.MTFALogin,c.submitFormDetails(a,b)},c.submitSMSForm=function(){var a={appCode:"BMB",submitted:1,refreshed:"yes",mobile_number:c.model.phoneNumber.value,barclays_segment:"missingSegment",custom_message:"yes",spadc4c70df1f2e2ae70db5f6a8a7e4835:""};window.scrollTo(0,0),h.smsApiService(a).then(function(a){})},c.submitFormDetails=function(b,d){window.scrollTo(0,0),h.apiService(b,d).then(function(b){a.contentResponse={},a.contentResponse.errorJSON={},b&&(!1===b.header.stopFlow?(a.userData.data=b.body,i.updateCCPCookie(b.body.verificationToken.membershipNumber).then(function(d){"FEDERATION"===b.body.redirectToken.type?(a.$broadcast("loader_on"),window.location.href=b.body.redirectToken.url+"?REF="+b.body.redirectToken.referenceId):c.sendHiddenHelpCardsAndRoute(b)})):c.routeOnError(b))})},h.isEmpty(a.userData)?g.changeView(j.VIEWS.identification):(c.authenticationToken={digits:f.getCardLastDigits()},c.model=e.initializeTFAModelValues(),"MTFA"===c.verifyTFAType?(a.step="authMTFA",c.model.step="authMTFA"):(a.step="authTFA",c.model.step="authTFA"))}])}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("changeFirstTimePasscodeCtrl",["$rootScope","$route","$scope","$injector","authLoginUtilService","siteAnalyticsUtilService",function(a,b,c,d,e,f){var g=d.get("secureRoute"),h=d.get("services"),i=d.get("CONSTANT");angular.element(document).ready(function(){"SFA"===c.authType&&c.displayFirstTimePasscode&&c.$emit("step2formsLoaded","oneTimePasscodeForm")}),c.forgottenPasscode=function(){a.contentResponse.errorJSON={},c.model={},e.getResetViaSMSSwitch(!1)},c.getChangeFirstTimePasscodeSwitch=function(){var b={};h.apiService(i.JSON.changeFirstTimePasscodeSwitch,b).then(function(b){b.errorCode||(a.changeFirstTimePasscode=b.body.switchedOn,g.changeView(i.VIEWS.changeFirstTimePasscode))})},c.cancel=function(){a.changeFirstTimePasscode=!1,a.userData={},g.changeView(i.VIEWS.identification)},c.storeUserCookieInfo=function(b){b.body&&(a.userData.data=b.body,a.tfaSwitched=b.body.tfaSwitched)},c.routeOnError=function(c){var d=!0;angular.forEach(c.header.messages,function(f){"SELF_SERVE_UNLOCK"===f.type?(a.errorPageRedirect=!0,a.selfServeLockedError=c,g.changeView(i.VIEWS.selfServeMemLockedOut),d=!1):"LOCKED"===f.type?(a.errorPageRedirect=!0,a.contentResponse.errorJSON=c,a.lockedOut=!0,g.changeView(i.VIEWS.lockedOut),d=!1):"DFA_LOCK_OUT_SFA"===f.type?(a.contentResponse.errorJSON={},a.userData.data.lockedMethods=new Array,a.userData.data.lockedMethods[0]="SFA",angular.forEach(a.userData.data.authenticationTokenSpecificationList,function(b,c){"SFA"===b.method&&a.userData.data.authenticationTokenSpecificationList.splice(c,1)}),"SFA"===a.userData.data.defaultAuthenticationMethod&&(1===a.userData.data.authenticationTokenSpecificationList.length?a.userData.data.defaultAuthenticationMethod=a.userData.data.authenticationTokenSpecificationList[0].method:a.userData.data.defaultAuthenticationMethod="TFA"),b.reload(),d=!1):"UNLOCK"===f.type?(a.errorPageRedirect=!0,a.contentResponse.errorJSON=c,a.userData.dateOfBirth=null,a.userData.cardNumber=null,e.getResetViaSMSSwitch(),d=!1):"DUPLICATE_INCORRCT_LOGIN_EXCEPTION"===f.type?(a.contentResponse.errorJSON=c,a.forgotPasscodeSuccess=!0,a.userData.data.defaultAuthenticationMethod="SFA",g.changeView(i.VIEWS.authentication),d=!1):"EXPIRED_PASSCODE"===f.type&&(a.errorPageRedirect=!0,a.contentResponse.errorJSON=c,a.userData.dateOfBirth=null,a.userData.cardNumber=null,e.getResetViaSMSSwitch(!1),d=!1)}),d&&(a.errorPageRedirect=!0,a.contentResponse.errorJSON=c,g.changeView(i.VIEWS.identification),a.stopFlow=!0,a.userData={})},c.setSCTags=function(){f.changeFirstTimePasscodeStep1AnalyticsData()},c.$on("submitAuthForm",function(a,b){void 0!=c.oneTimePasscodeForm&&"oneTimePasscodeForm"==b&&c.submitFTPDetails()}),c.submitFTPDetails=function(){if(c.oneTimePasscodeForm.$invalid)return c.oneTimePasscodeForm.showErrorsIfAny=!0,void c.$emit("displayglobalerrorHandler",!0);h.apiService(i.JSON.validateFirstTimePasscode,{passcode:c.model.passcode.value}).then(function(d){window.scrollTo(0,0),a.contentResponse={},a.contentResponse.errorJSON={},d.errorCode||(!1===d.header.stopFlow?(a.identityUserData=angular.copy(a.userData),a.userData.data=d.body,a.contentResponse.errorJSON=d,a.membershipNumber=d.body.membershipNumber,a.forgotPasscodeSuccess=!0,a.userData.data.authenticationTokenSpecificationList=d.body.authenticationTokenSpecificationList,a.userData.data.defaultAuthenticationMethod="SFA",a.userData.data.scaEligible=d.body.scaEligibility,a.userData.data.merchantCustomer=d.body.merchantCustomer,a.tempPasscode=c.model.passcode.value,c.displayFirstTimePasscode=!1,a.resetViaPost=!0,c.showSFA=!0,c.showDFA=!1,a.wealthUser=d.body.wealthUser,a.oneTimePasscodeChange=!0,b.reload()):c.routeOnError(d))})},a.step=2;var j=function(){c.model={passcode:{id:"passcode",fieldName:"Enter your Passcode",value:""}}};if(h.isEmpty(a.userData))g.changeView(i.VIEWS.identification);else{if(c.model={},j(),a.userData&&a.userData.data&&a.userData.data.authenticationTokenSpecificationList)for(var k=a.userData.data.authenticationTokenSpecificationList,l=0;l<k.length;l++)"SFA"===k[l].method&&(a.userData.data.authenticationTokenSpecificationList[l].noPasscode?(c.noPasscode=!0,c.noMemorableWord=!0,c.displayMemorableWordTooltips=!1,c.displayPasscodeAndMemorableWordTooltips=!0):a.userData.data.authenticationTokenSpecificationList[l].noMemorableWord?(c.noPasscode=!1,c.noMemorableWord=!0,c.displayPasscodeAndMemorableWordTooltips=!1):(c.authenticationToken={},c.noPasscode=!1,c.noMemorableWord=!1));c.authForgetId=a.authForgetId}h.apiService(i.JSON.loginStep2ChangeFirstTimePasscode).then(function(b){b&&(c.contentResponse=b),a.userData&&c.setSCTags()})}])}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("cookiePrefCtrl",["$rootScope","$scope","$injector","siteAnalyticsUtilService",function(a,b,c,d){var e=c.get("secureRoute"),f=c.get("services"),g=c.get("CONSTANT"),h=c.get("$filter"),i=c.get("cookieService"),j=c.get("snippetServices");window.cookieConsentSwitch?(e.changeView(a.previousRoute),window.open("https://www.barclays.co.uk/important-information/cookies-policy/")):(b.strictness1=[{value:"on",name:"",isDisabled:!0}],b.strictness2=[{value:"off",name:"",isDisabled:!0}],b.strictness1Mobile=[{value:"on",name:"Enable",isDisabled:!0}],b.strictness2Mobile=[{value:"off",name:"Disable",isDisabled:!0}],b.performance1=[{value:"on",name:""}],b.performance2=[{value:"off",name:""}],b.performance1Mobile=[{value:"on",name:"Enable"}],b.performance2Mobile=[{value:"off",name:"Disable"}],b.functionality1=[{value:"on",name:""}],b.functionality2=[{value:"off",name:""}],b.functionality1Mobile=[{value:"on",name:"Enable"}],b.functionality2Mobile=[{value:"off",name:"Disable"}],b.target1=[{value:"on",name:""}],b.target2=[{value:"off",name:""}],b.target1Mobile=[{value:"on",name:"Enable"}],b.target2Mobile=[{value:"off",name:"Disable"}],b.contentAvailable=!1,b.cookieTypes=[{heading:"1. Strictly Necessary Cookies",noTemplate:!0,content:"<p>These cookies are essential as they enable you to move around a website and use its features, such as accessing secure areas. Without these cookies, services you've asked for (such as shopping baskets) can't be provided. These cookies don't gather information about you that could be used for marketing or remembering where you've been on the internet.</p><p>This category <b>cannot be disabled</b></p><p>Cookie name</p><div><ul class='displayDesktop'>    <li>ssuserid</li>    <li>identitytoken</li>    <li>IS2_MatchHistory</li>    <li>IS2_StoredValues</li>    <li>TSd5bb3f, TS1df383</li>    <li>SS_X_JSESSIONID</li>   </ul><ul class='displayDesktop'> <li>JSESSIONID</li>    <li>sessioncookie</li>    <li>requestcookie</li>    <li>identity</li>    <li>assist2</li>    <li>Mrel1cookie</li>  </ul><ul class='displayDesktop'>  <li>olbvisitor</li>    <li>backbutton cookie</li>    <li>Csmod</li>    <li>Csacc</li>    <li>Cstab</li>    <li>Csaaa</li>   </ul><ul class='displayDesktopLast'> <li>CSts</li>    <li>JSESSIONID</li>    <li>tabIndex</li>    <li>Mbox&nbsp;</li></ul></div>"},{heading:"2. Performance Cookies",noTemplate:!0,content:"<p>In most cases the information these cookies collect is anonymous and is only used to improve how a website works and to help us to identify issues you may have when using our online services. In limited cases for online banking issues these cookies enable us to identify specific issues you may have had.</p><p>These cookies are not used to target you with online advertising. Without these cookies we can't learn how our website is performing and make relevant improvements that could better your browsing experience.</p><p>Cookie name</p><div><ul class='displayDesktop'>    <li>ACOOKIE</li>    <li>WT_FPC</li>    <li>metafaqSessionID</li>    <li>WT_FPC</li>    </ul><ul class='displayDesktopLast'><li>ACOOKIE</li><li>NSC_CbsdmbztGjstuQbsuz</li><li>TCID</li></ul></div>"},{heading:"3. Functionality & Profile Cookies",noTemplate:!0,content:""},{heading:"4. Targeting Cookies",noTemplate:!0,content:""}],b.setSCTags=function(){d.getCookiePolicy()},b.setSCTagsCookiePref=function(){d.getCookiePref()},b.showSetCookiePref=function(){b.setSCTagsCookiePref(),window.scrollTo(0,0),b.displaySetCookiePref=!0,b.cat1="on",b.cat2={value:j.getCookiePref("cat2")},b.cat3={value:j.getCookiePref("cat3")},b.cat4={value:j.getCookiePref("cat4")}},b.hideSetCookiePref=function(){window.scrollTo(0,0),b.displaySetCookiePref=!1},b.cancelCookiePref=function(){a.header=!0,e.changeView(a.previousRoute)},b.saveCookiePref=function(){var c;h("date")(new Date,"dd/MM/yyyy+H:mm ");if(c=i.getCookie("CCP")?JSON.parse(decodeURIComponent(i.getCookie("CCP"))):{},c.hasOwnProperty("publicuser"))c.publicuser.cat2=b.cat2.value,c.publicuser.cat3=b.cat3.value,c.publicuser.cat4=b.cat4.value,c.publicuser.catStamp=h("date")(new Date,"dd/MM/yyyy+H:mm ");else{var d={};d.publicuser={},d.publicuser.cat2=b.cat2.value,d.publicuser.cat3=b.cat3.value,d.publicuser.cat4=b.cat4.value,d.publicuser.catStamp=h("date")(new Date,"dd/MM/yyyy+H:mm "),d.publicuser.createStamp=h("date")(new Date,"dd/MM/yyyy+H:mm "),c=angular.extend({},c,d)}i.setEncodedCookie("CCP",JSON.stringify(c),7300),i.setEncodedCookie("CCP_OTM",1),a.header=!0,e.changeView(a.previousRoute)},b.setDefaultValues=function(){a.header=!1,b.displaySetCookiePref=!1},b.setCategoryToDisplay=function(){b.contentResponse.categoryArray={RCMSMigrationDummy2:{display:!0,more:"RCMSMigrationDummy7"},RCMSMigrationDummy13:{display:!0,more:"RCMSMigrationDummy16"},RCMSMigrationDummy11:{display:!0,more:"RCMSMigrationDummy19"},RCMSMigrationDummy20:{display:!0,more:"RCMSMigrationDummy24"},RCMSMigrationDummy1:{display:!0,more:"RCMSMigrationDummy5"}},b.cat1Values="<p>These cookies are essential, as they enable you to move around a website and use its features, such as accessing secure areas.Without these cookies, services you've asked for ( such as access to secure areas) can't be provided.</p><p>These cookies don't gather information about you that could be used for marketing or remembering where you've been on the internet.</p>"},b.expandCategories=!1,b.toogleExpand=function(){a.cookiePrefExpand=!a.cookiePrefExpand,b.expandCategories=a.cookiePrefExpand},b.setDefaultValues(),void 0===a.userData?e.changeView(g.VIEWS.identification):(f.apiService(g.JSON.EnhancedCookiesNoticeAuth).then(function(a){a&&(b.contentResponse=a,b.pageHeader="Barclays Enhanced Cookies Notice",b.setCategoryToDisplay(),b.cookieTypes[2].content=b.contentResponse.contentContainer.content.snippets.BDL_RCMSMigrationCookieTypeFunctionality.content,b.cookieTypes[3].content=b.contentResponse.contentContainer.content.snippets.BDL_RCMSMigrationCookieTypeTarget.content,b.contentAvailable=!0)}),b.setSCTags()))}])}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("dynamicInterstitialCtrl",["$rootScope","$scope","$injector","siteAnalyticsUtilService","timeoutService",function(a,b,c,d,e){var f=c.get("secureRoute"),g=c.get("services"),h=c.get("CONSTANT");b.setSCTags=function(){d.getInterstitialAnalyticsData()},g.isEmpty(a.userData)||g.isEmpty(a.interstitial)?f.changeView(h.VIEWS.identification):(a.showLogout=!0,b.redirectionUrl=a.interstitial.dyanmicInterstitialAddress,b.appName=a.interstitial.appName,""!==b.interstitial&&""!==b.appName||(window.location.href=h.URL.BTRHome),b.setSCTags()),e.registerTimeoutCallbackFn(function(){window.location.href=h.URL.LogOff})}])}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("footerCtrl",["$scope","services","$rootScope","CONSTANT",function(a,b,c,d){a.wealthFooter=!1,a.privateBankFooter=!1,a.wealthInternationalFooter=!1,window.privateBankValue&&window.privateBankSwitch&&"pbc"===window.wealthType&&(a.wealthFooter=!0),window.wealthValue&&window.wealthSwitch&&"wintc"===window.wealthType&&(a.wealthFooter=!0),b.apiService(d.JSON.SRPFooterContent).then(function(b){a.wealthFooter?a.footerSnippet=b.contentContainer.content.snippets.TaskViewAuthLogin_PrivateBankFooter.content:a.footerSnippet=b.contentContainer.content.snippets.BDL_TaskViewAuthLogin_ICookiesFootnote.content}),a.privateBankHeader=!1,a.wealthInternationalHeader=!1,a.defaultHeader=!0,a.wealthCheck=!1,window.serviceStatusSwitch&&(a.serviceStatusSwitch=window.serviceStatusSwitch),window.wealthValue&&window.wealthSwitch?(a.wealthCheck=!0,"wintc"===window.wealthType&&(a.wealthInternationalHeader=!0,a.defaultHeader=!1,a.privateBankHeader=!1)):window.privateBankValue&&window.privateBankSwitch&&(a.wealthCheck=!0,"pbc"===window.wealthType&&(a.privateBankHeader=!0,a.defaultHeader=!1,a.wealthInternationalHeader=!1))}])}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("forgotMembershipDetailsCtrl",["$rootScope","$scope","$injector","forgotUtilService","siteAnalyticsUtilService","dssTooltipService","content","authLoginUtilService","identificationUtilService","partial",function(a,b,c,d,e,f,g,h,i,j){var k=c.get("secureRoute"),l=c.get("services"),m=c.get("CONSTANT");if(void 0===a.userData)return k.changeView(m.VIEWS.identification),void(a.userData={});b.model=d.initializeModelValues(),b.model.surname={id:"surname",fieldName:"Surname\\Last name",value:"",refId:"surname"},b.globalErrorFormName="membershipDetailStep",b.solusMerchantInputTemplate=j("forgot/solusMerchantDetails.html"),b.dateOfBirthClass=d.getDateOfBirthClasses(),b.solusAccNosClass=d.getSolusAccountNumber(),b.setTags=function(){e.getForgotMembershipDetail()},b.setSCTags=function(){b.setTags()},!0===window.mortgageMasterSwitch&&!0===window.mortgagePasscodeSwitch&&b.model.accountType.accounts.push({id:m.VAR.MORTGAGE,accountId:m.VAR.MORTGAGE,accountName:m.VAR.MORTGAGE}),!0===window.merchantSolusLiteSwitch&&(b.model.accountType.accounts.push({id:m.VAR.SOLUS_MERCHANT_ACCOUNT,accountId:m.VAR.SOLUS_MERCHANT_ACCOUNT,accountName:m.VAR.SOLUS_MERCHANT_ACCOUNT}),b.configForSortCode=i.getSortCodeClasses()),b.model.accountType.accounts.length>1&&(b.accountTypeListAvailable=!0),g&&(b.contentResponse=g.data,b.faqContent=l.setFaqContent(g.data),b.setSCTags()),b.backButton=function(){void 0!==a.contentResponse&&(a.contentResponse.errorJSON={}),k.changeView(m.VIEWS.identification)},b.showValidationErrorsOnBlur=function(){this.validationErrors=!0},b.tooltipConfig=function(a){return f.dssTooltipConfig(b.contentResponse.contentContainer.content.tooltips[a])},h.addSubmitEventListener(),b.submit=function(){setTimeout(function(){void 0!=b.membershipDetailStep&&b.membershipDetailStep.$valid?b.submitForm():(b.displayglobalerror=!0,b.membershipDetailStep.showErrorsIfAny=!0,h.setFocusOnGlobalErrors())},100)},b.trimLastname=function(a){b.model.surname.value=h.trimLastname(a)},b.submitForm=function(){a.userData={},a.contentResponse={};var c=d.getMembershipDetailsRequestPayload(b);window.scrollTo(0,0),l.apiService(c.apiName,c.requestParam).then(function(c){c&&(c.header.stopFlow?(a.serviceError=!0,a.contentResponse.errorJSON=c):(a.userData.data=c.body,a.contentResponseData=c,a.memberInfo="",a.selectedAccountType=b.model.accountType.value,a.userData.data.memberInfos.length>1?(a.userData.surname=b.model.surname.value,k.changeView(m.VIEWS.MultipleMemberships)):(a.userData.surname=b.model.surname.value,k.changeView(m.VIEWS.ForgotMembershipSuccess))))})}}])}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("forgotMembershipSuccessCtrl",["$rootScope","$scope","$injector","forgotUtilService","content","authLoginUtilService","siteAnalyticsUtilService",function(a,b,c,d,e,f,g){var h=c.get("secureRoute"),i=c.get("services"),j=c.get("$cookies"),k=c.get("CONSTANT"),l="assist2",m=j[l];if(a.contentResponse={},b.headerMultipleMembership="Multiple membership numbers",b.textMultipleMembership="You have more than one Online Banking membership number. Please select the right membership number based on the information below.",i.isEmpty(a.userData))a.userData={},h.changeView(k.VIEWS.identification);else if(a.userData){b.forgotMembershipHero=d.getHeroDetails(),a.userData.data&&a.memberInfo&&(a.userData.data.memberInfos=a.memberInfo),e&&(b.contentResponse=e.data,b.faqContent=i.setFaqContent(e.data));var n={};b.usersInfo=[],1===a.userData.data.memberInfos.length&&(b.userDisabled=d.checkUserDisabled(),b.usersInfo.push({membershipInfo:d.getSingleMembershipInformationObj(a.userData.data.memberInfos[0],b.contentResponse.contentContainer.content)}),g.getForgotMembershipSuccess()),a.userData.data.memberInfos.length>1&&(b.loginOnlineBankingFlag=!0,d.sortUserMembershipData(),b.userDisabled=d.checkUserDisabled(),angular.forEach(a.userData.data.memberInfos,function(a){var c=d.getMembershipInformationObj(a,b.contentResponse.contentContainer.content);c.isDisabled=a.loginStatus===k.VAR.MEMBER_SUSPEND||d.getLoginStatusCheck(a),b.dormate=d.checkDormateEligibility(a,b.contentResponse.contentContainer.content),b.isShowinCookies=!1,m&&m.indexOf(a.membershipNumber)>-1&&(c.showForgetIdLink=!0,b.isShowinCookies=!0),c.showForgetIdLink||c.isDisabled||a.dormant||""===a.membershipNumber||(b.loginOnlineBankingFlag=!1),b.usersInfo.push({membershipInfo:c})}),n.membershipNumbers=b.loginOnlineBankingFlag?{}:d.setUserMembershipNumber(b.usersInfo),b.firstSelectedUser=d.getFirstSelectedUser(b.usersInfo),n.membershipNumbers=b.firstSelectedUser,g.getForgotMembershipSuccess())}b.isCheckboxEligible=function(a){return d.isCheckboxEligible(a,b.userDisabled)},b.isForgotIdEligible=function(a){return d.isForgotIdEligible(a,b.userDisabled)},b.forgottenPasscode=function(a){d.forgottenPasscode(a)},b.forgetThisUser=function(a){d.removeUserFromAssistCookie(b.usersInfo,a)},b.toggleLinkClass=function(a){return a.showForgetIdLink||b.userDisabled?"text-right mb-24":"pull-right "},b.eventMethod=function(a,c){k.VAR.FORGOT_PASSCODE===a?b.forgottenPasscode(c):k.VAR.UNLOCK_MEMBERSHIP===a?h.changeView(k.VIEWS.lockedOut):k.VAR.SUBMIT_SUSPENDED===a?window.location.href=k.URL.SuspendedMembership:k.VAR.SELF_SERVE_UNLOCK===a&&d.selfServeMemUnlock(c)},b.redirectToHomePage=function(){window.location=k.URL.BarclaysHomePage},b.onMemberChangeRadio=function(a){n.membershipNumbers=a},b.submitForm=function(){a.memberInfo=a.userData.data.memberInfos,d.getUserDetails({user:n,usersInfo:b.usersInfo,userData:b.userData,fromRememberMeCookie:!1}),a.selectedAccountType=null}}])}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("forgotPasscodeConfirmCtrl",["$rootScope","$scope","$injector","forgotUtilService","content","siteAnalyticsUtilService","siteTrackingService",function(a,b,c,d,e,f,g){b.requestParam={};var h=c.get("secureRoute"),i=c.get("services"),j=c.get("CONSTANT");b.resetViaSMS?b.stepsData=d.getSmsConfirmationProgressStatus():b.stepsData=d.getConfirmationProgressStatus(),b.setSCTags=function(){f.forgotPasscodeConfirm()},i.isEmpty(a.userData)?h.changeView(j.VIEWS.identification):("Merchant account"===a.forgotUserData.model.accountType.value?b.confirmationDetails=d.getConfirmationDetailsForSolusMerchant():b.confirmationDetails=d.getConfirmationDetails(),e.data&&(b.contentResponse=e.data,b.faqContent=i.setFaqContent(e.data),b.incorrectPasscodeSnippet=[{heading:"Incorrect address?",noTemplate:!0,content:e.data.contentContainer.content.snippets.FTB_reset_passcode_confirm_address.content}]),a.forgotPasscode=!0,a.forgotPasscodeSuccess=!1),b.submitForm=function(){var b=d.getConfirmRequestPayload();i.apiService(b.apiName,b.requestParam).then(function(b){b.errorCode||(!1===b.header.stopFlow?h.changeView(j.VIEWS.forgotPasscodeSuccess):(a.serviceError=!0,a.contentResponse.errorJSON=b,h.changeView(j.VIEWS.forgotPasscodeDetails)))})},b.setSCTags(),b.backToPasscodeDetails=function(){a.contentResponse.errorJSON={},d.isEligibleForMobileSMSReset()?h.changeView(j.VIEWS.forgotPasscodeDeliveryMethod):h.changeView(j.VIEWS.forgotPasscodeDetails)}}])}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("forgotPasscodeDeliveryMethodCtrl",["$rootScope","$scope","$injector","forgotUtilService","content","siteAnalyticsUtilService","authLoginUtilService",function(a,b,c,d,e,f,g){var h=c.get("secureRoute"),i=c.get("services"),j=c.get("CONSTANT");if(b.stepsData=d.getSmsCodeDeliveryProgressStatus(),b.passcodeDeliveryMethods=j.VAR.PASSCODE_DELIVERY_METHODS,b.addressDetails={columns:[],rows:{}},g.addSubmitEventListener(),b.submit=function(){setTimeout(function(){b.passcodeDeliveryStep.$invalid?b.passcodeDeliveryStep.showErrorsIfAny=!0:b.submitForm()},100)},b.submitForm=function(){if(b.model.delivery.value===j.VAR.PASSCODE_DELIVERY_METHODS.SMS){var c=d.getDeliveryRequestPayload(b);a.contentResponse.errorJSON={},i.apiService(c.apiName,c.requestParam).then(function(c){c.errorCode||(!1===c.header.stopFlow?(d.storeDeliveryMethodModelValues(b.model),void 0!==c.body.attemptRemaining&&(a.otpAttemptsRemaining=c.body.attemptRemaining),h.changeView(j.VIEWS.forgotPasscodeVerificationCode)):(a.serviceError=!0,a.contentResponse.errorJSON=c))})}else h.changeView(j.VIEWS.forgotPasscodeConfirm)},b.back=function(){h.changeView(j.VIEWS.forgotPasscodeDetails)},i.isEmpty(a.userData))h.changeView(j.VIEWS.identification);else{e.data&&(b.faqContent=i.setFaqContent(e.data),b.incorrectPasscodeSnippet=[],b.incorrectPasscodeSnippet=[{heading:"Incorrect number or address?",noTemplate:!0,content:e.data.contentContainer.content.snippets.FTB_reset_passcode_confirm_address.content}]),a.forgotPasscode=!0,a.forgotPasscodeSuccess=!1,b.mobileNumberList=d.getUserMobileNumberDetails()||[];var k=d.getDeliveryMethodModelValues();b.model={delivery:{value:void 0!=k.deliveryMethod?k.deliveryMethod:j.VAR.PASSCODE_DELIVERY_METHODS.SMS},mobileNumber:{value:void 0!==k.mobileNumber?k.mobileNumber.mobileNumberId:b.mobileNumberList[0].mobileNumberId}},b.model.deliveryOptionSMS=[{value:j.VAR.PASSCODE_DELIVERY_METHODS.SMS,name:"Text ("+b.mobileNumberList[0].mobileNumber+")",htmlContent:!0,htmlData:"<p>We'll text you a code to check it's you, then you can reset your passcode.</p>"}],b.mobileNumberList.length>1&&(b.model.deliveryOptionSMS[0].name="Send me a text message"),b.model.deliveryOptionPost=[{value:j.VAR.PASSCODE_DELIVERY_METHODS.POST,name:"Post",htmlContent:!0,htmlData:"<p>We'll send your passcode to the address below. This could take up to <strong>five working days</strong>.</p>"}],b.addressDetails.columns=[{field:"address",display:"Delivery address"}],b.addressDetails.rows={address:[{text:b.forgotPasscodeAddressInfo.body.address[0],class:"light block"},{text:b.forgotPasscodeAddressInfo.body.address[1],class:"light block"}]},f.getForgotPasscodeDeliveryMethod()}}])}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("forgotPasscodeDetailsCtrl",["$rootScope","$scope","$injector","forgotUtilService","dssTooltipService","content","siteAnalyticsUtilService","authLoginUtilService","identificationUtilService","partial",function(a,b,c,d,e,f,g,h,i,j){function k(c){d.setUserMobileNumber(c.body.mobileNumberList),!0===b.cannotReorder?(a.duplicateRequest=!0,n.changeView(p.VIEWS.forgotPasscodeSuccess)):d.isEligibleForMobileSMSReset()?n.changeView(p.VIEWS.forgotPasscodeDeliveryMethod):n.changeView(p.VIEWS.forgotPasscodeConfirm)}function l(c){if(!0===b.cannotReorder)a.duplicateRequest=!0,n.changeView(p.VIEWS.forgotPasscodeSuccess);else if(a.resetViaSMS)if(a.forgotPasscodeAddressInfo.body.failedSMSCheck)n.changeView(p.VIEWS.forgotPasscodeConfirm);else{var e=d.getMobileNumberRequestPayload(b);o.apiService(e.apiName,e.requestParam).then(function(a){a.errorCode||(void 0!==a.header&&!1===a.header.stopFlow?(d.setUserMobileNumber([{mobileNumberId:a.body.formattedMobileNumber,mobileNumber:a.body.formattedMobileNumber}]),n.changeView(p.VIEWS.forgotPasscodeDeliveryMethod)):m(c))})}else n.changeView(p.VIEWS.forgotPasscodeConfirm)}function m(c){a.serviceError=!0,b.model.accountType.value===p.VAR.CURRENT_SAVINGS_ACCOUNT&&(b.model.securityCode.value=null),b.failedLoginAttemptsAlert=!1,a.contentResponse.errorJSON=c}var n=c.get("secureRoute"),o=c.get("services"),p=c.get("CONSTANT");void 0===a.userData&&n.changeView(p.VIEWS.identification),f.data&&(b.faqContent=o.setFaqContent(f.data),b.contentResponse=f.data,void 0!==a.failedLoginAttemptsErrorJSON&&(b.failedLoginAttemptsAlert=!0,angular.forEach(a.failedLoginAttemptsErrorJSON.header.messages,function(a){b.failedLoginAttemptsAlertContent={alertmessage:"<div class='alert-heading marginBottomLockedOut'>You've been locked out</div>",additionalcontent:"<p>"+a.text+"</p>"}}),delete a.failedLoginAttemptsErrorJSON)),b.model=d.initializeModelValues(),b.globalErrorFormName="passcodeDetailStep";var q=!1;void 0!==a.identityRequired&&(q=a.identityRequired,delete a.identityRequired),b.solusMerchantInputTemplate=j("forgot/solusMerchantDetails.html"),b.setSCTags=function(){g.getForgotPasscodeDetail()},b.imageConfig=h.setCVVIcon(),a.resetViaSMS?b.stepsData=d.getSmsDetailsProgressStatus():b.stepsData=d.getDetailsProgressStatus(),b.dateOfBirthClass=d.getDateOfBirthClasses(),b.solusAccNosClass=d.getSolusAccountNumber(),b.siSolusFunctionalityFlag=!1,b.mortgageFunctionalityFlag=!1,b.contentDisplayPasscode={alertmessage:"<div class='alert-heading'>Your passcode delivery</strong></div>",additionalcontent:"<p>We'll send your new passcode to the address we hold for you. This could take up to <b>five working days</b></p>"},!0===window.mortgageMasterSwitch&&!0===window.mortgagePasscodeSwitch&&b.model.accountType.accounts.push({id:p.VAR.MORTGAGE,accountId:p.VAR.MORTGAGE,accountName:p.VAR.MORTGAGE}),!0===window.merchantSolusLiteSwitch&&(b.model.accountType.accounts.push({id:p.VAR.SOLUS_MERCHANT_ACCOUNT,accountId:p.VAR.SOLUS_MERCHANT_ACCOUNT,accountName:p.VAR.SOLUS_MERCHANT_ACCOUNT}),b.configForSortCode=i.getSortCodeClasses()),b.model.accountType.accounts.length>1&&(b.accountTypeListAvailable=!0),b.backToLoginForm=function(){a.contentResponse.errorJSON={},n.changeView(p.VIEWS.identification)},b.showValidationErrorsOnBlur=function(){this.validationErrors=!0},b.tooltipConfig=function(a){return e.dssTooltipConfig(b.contentResponse.contentContainer.content.tooltips[a])},"/authentication"!==a.previousRoute&&void 0!==a.forgotUserData&&void 0!==a.forgotUserData.model&&(b.model.dateOfBirth=a.forgotUserData.model.dateOfBirth,b.model.accountType.value=a.forgotUserData.model.accountType.value,a.forgotUserData.model.accountType.value===p.VAR.CURRENT_SAVINGS_ACCOUNT?b.model.cardNumber=a.forgotUserData.model.cardNumber:a.forgotUserData.model.accountType.value===p.VAR.MORTGAGE?b.model.mortgageNumber=a.forgotUserData.model.mortgageNumber:a.forgotUserData.model.accountType.value===p.VAR.SOLUS_MERCHANT_ACCOUNT?(b.model.merchantId=a.forgotUserData.model.merchantId,b.model.sortCode=a.forgotUserData.model.sortCode,b.model.settlementAccNo=a.forgotUserData.model.settlementAccNo):a.forgotUserData.model.accountType.value!==p.VAR.MORTGAGE&&a.forgotUserData.model.accountType.value!==p.VAR.CURRENT_SAVINGS_ACCOUNT&&a.forgotUserData.model.accountType.value!==p.VAR.SOLUS_MERCHANT_ACCOUNT&&(b.model.solusAccNumber=a.forgotUserData.model.solusAccNumber,b.model.countryList=a.forgotUserData.model.countryList)),b.showValidationErrorsOnBlur=function(){this.validationErrors=!0},a.forgotUserData={},d.clearPasscodeDeliveryData(),h.addSubmitEventListener(),b.submitForm=function(){setTimeout(function(){b.passcodeDetailStep.$valid?r():(b.passcodeDetailStep.showErrorsIfAny=!0,b.displayglobalerror=!0,h.setFocusOnGlobalErrors())},300)};var r=function(){a.contentResponse.errorJSON={};var c=d.getDetailsRequestPayload(b);q&&(c.requestParam.membershipIdentityToken={membershipNumber:a.userData.membershipNum,surname:a.userData.surname}),window.scrollTo(0,0),o.apiService(c.apiName,c.requestParam).then(function(c){c.errorCode?a.forgotUserData={}:!1===c.header.stopFlow?(b.cannotReorder=!1,angular.forEach(c.header.messages,function(a){a.type===p.VAR.CANNOT_REORDER&&(b.cannotReorder=!0)}),a.forgotPasscodeAddressInfo=c,window.otpServiceApiMigrationSwitch?k(c):l(c)):m(c)})};b.setSCTags()}])}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("forgotPasscodeResetCtrl",["$rootScope","$scope","$injector","forgotUtilService","siteAnalyticsUtilService","authLoginUtilService",function(a,b,c,d,e,f){var g=c.get("secureRoute"),h=c.get("CONSTANT"),i=c.get("services");b.stepsData=d.getSmsConfirmationProgressStatus(),b.globalErrorFormName="passcodeResetStep",i.isEmpty(a.userData)?g.changeView(h.VIEWS.identification):(b.model={newPasscode:{id:"newPasscode",value:"",step:"newPasscodeAndMemorableWord"},newPasscodeConfirm:{id:"newPasscodeConfirm",value:"",step:"newPasscodeAndMemorableWord"},memWord:{id:"memWord",value:"",step:"newPasscodeAndMemorableWord"},memWordConfirm:{id:"memWordConfirm",value:"",step:"newPasscodeAndMemorableWord"}},a.userData.data&&a.userData.data.authenticationTokenSpecificationList&&angular.forEach(a.userData.data.authenticationTokenSpecificationList,function(a){"SFA"==a.method&&(b.model.memWord.supportNumeric=!!a.supportNumeric)})),b.setSCTags=function(){e.forgotPasscodeReset()},f.addSubmitEventListener(),b.submit=function(){setTimeout(function(){b.passcodeResetStep.$invalid?(b.passcodeResetStep.showErrorsIfAny=!0,b.displayglobalerror=!0,f.setFocusOnGlobalErrors()):b.submitForm()},100)},b.back=function(){g.changeView(h.VIEWS.forgotPasscodeDetails)},b.submitForm=function(){a.contentResponse.errorJSON={};var c=d.getPasscodeMemWordRequestPayload(b,i.isMobile());i.apiService(c.apiName,c.requestParam).then(function(b){b.errorCode||(void 0!=b.header&&!1===b.header.stopFlow?b.body.success&&(a.resetPasscodeMemWord=!0,g.changeView(h.VIEWS.forgotPasscodeSuccess)):(a.serviceError=!0,a.contentResponse.errorJSON=b))})},b.setSCTags(),b.showValidationErrorsOnBlur=function(){this.validationErrors=!0}}])}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("forgotPasscodeSuccessCtrl",["$rootScope","$scope","$injector","siteAnalyticsUtilService",function(a,b,c,d){var e=c.get("secureRoute"),f=c.get("services"),g=c.get("CONSTANT");if(b.passcodeSuccessBtn="btn-secondary",f.isEmpty(a.userData))return a.userData={},void e.changeView(g.VIEWS.identification);f.apiService(g.JSON.ForgotPasscodeStep3Content).then(function(a){a&&(b.faqContent=f.setFaqContent(a))}),b.setSCTags=function(){var a;a=!1===b.passcodeSMSSuccess?"Ordered":"Updated",d.forgotPasscodeSuccess(a)},b.customerAddress=a.forgotPasscodeAddressInfo,void 0!==a.contentResponse&&(a.contentResponse.errorJSON={}),a.userData={},a.forgotUserData={},a.forgotPasscodeAddressInfo={},void 0!==a.resetPasscodeMemWord&&a.resetPasscodeMemWord?(b.passcodeSMSSuccess=!0,b.forgotPasscodeHero={show:!0,showBackButton:!1,notification:{type:"success",data:{heading:"Your passcode has been updated",subheading:["You can now use this to log in to Online Banking"]}}}):(b.passcodeSMSSuccess=!1,b.passcodeSuccessBtn="btn-primary",b.forgotPasscodeHero={show:!0,showBackButton:!1,notification:{type:"success",data:{heading:"We've ordered your new passcode",subheading:["You should get your passcode within five working days"]}}},b.addressDetails={columns:[{field:"address",display:"Delivery address"}],rows:{address:[{text:b.customerAddress.body.address[0],class:"light block "},{text:b.customerAddress.body.address[1],class:"light block"}]}}),b.setSCTags(),b.redirectToLoginPage=function(){e.changeView(g.VIEWS.identification)},b.redirectToHomePage=function(){window.location=g.URL.BarclaysHomePage},a.step="forgotPasscodeSuccess",a.forgotPasscode=!0,a.forgotPasscodeSuccess=!0,a.resetViaSMS=!1}])}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("forgotPasscodeVerificationCodeCtrl",["$rootScope","$scope","$injector","forgotUtilService","content","siteAnalyticsUtilService","authLoginUtilService","siteTrackingService",function(a,b,c,d,e,f,g,h){var i=c.get("secureRoute"),j=c.get("services"),k=c.get("CONSTANT");if(j.isEmpty(a.userData))i.changeView(k.VIEWS.identification);else{b.stepsData=d.getSmsDeliveryProgressStatus();var l=d.getDeliveryMethodModelValues().mobileNumber;b.message="<p>We've sent a text with your 6-digit passcode to <b>"+l.mobileNumber+"</b> - it could take a few minutes to arrive. Please enter this when you get it as the code will expire after a certain amount of time.</p>",b.model={verificationCode:{value:""}},e.data&&(b.faqContent=j.setFaqContent(e.data))}b.otpSent=!0,b.attemptRemaining=!0,void 0==a.otpAttemptsRemaining||a.otpAttemptsRemaining||(b.attemptRemaining=!1),b.sendToAddress=function(){i.changeView(k.VIEWS.forgotPasscodeConfirm)},b.noAttemptSnippetName={alertmessage:"<p class='alert-heading'>You've tried too many times</p>",additionalcontent:'<p>We can\'t text you any more passcodes - you\'ll need to reset your passcode by post instead.</p><a href="javascript:void(0);" ng-click="sendToAddress()">Post me my code</a>'},b.successAlertContent={alertmessage:b.message,additionalcontent:""},b.globalErrorFormName="passcodeSMSVerificationStep",b.setSCTags=function(){f.forgotPasscodeVerificationCode()},b.resendCode=function(){window.otpServiceApiMigrationSwitch?(b.otpSent=!1,b.passcodeSMSVerificationStep.showErrorsIfAny=!1,b.model.verificationCode.value="",j.apiService(k.JSON.sendOneTimeCode,{mobileNumberIdentifier:l}).then(function(c){a.contentResponse={},a.contentResponse.errorJSON={},c&&(!1===c.header.stopFlow?(b.otpSent=!0,b.attemptRemaining=c.body.attemptRemaining,b.attemptRemaining?(setTimeout(function(){var a=document.querySelector('[name="verificationCode"]');a&&a.focus()},0),h.tagAlertsOnPage("We have sent SMS verification code")):h.tagAlertsOnPage("We can't send you any more codes by text.")):(a.serviceError=!0,a.contentResponse.errorJSON=c))})):(a.contentResponse.errorJSON={},i.changeView(k.VIEWS.forgotPasscodeDeliveryMethod))},g.addSubmitEventListener(),b.submitForm=function(){setTimeout(function(){b.passcodeSMSVerificationStep.verificationCode.$invalid?(b.displayglobalerror=!0,b.passcodeSMSVerificationStep.showErrorsIfAny=!0,g.setFocusOnGlobalErrors()):window.otpServiceApiMigrationSwitch?n():m()},100)};var m=function(){var c=d.getSMSVerificationRequestPayload(b);a.contentResponse.errorJSON={},j.apiService(c.apiName,c.requestParam).then(function(c){c.errorCode||(!1===c.header.stopFlow?c.body.success?(a.forgotPasscodeSuccess=!0,i.changeView(k.VIEWS.forgotPasscodeReset)):(a.contentResponse.errorJSON=c,a.membershipNumber=c.body.membershipNumber,a.forgotPasscodeAddressInfo=c,a.forgotPasscodeAddressInfo.body.failedSMSCheck?(a.failedPasscodeViaSMSMobileNumberChecks=!0,i.changeView(k.VIEWS.forgotPasscodeConfirm)):a.serviceError=!0):(a.serviceError=!0,b.model.verificationCode.value="",a.contentResponse.errorJSON=c))})},n=function(){var c={oneTimeCode:b.model.verificationCode.value};j.apiService(k.JSON.validateOTPCode,c).then(function(c){window.scrollTo(0,0),a.contentResponse={},a.contentResponse.errorJSON={},c&&!1===c.header.stopFlow?(a.forgotPasscodeSuccess=!0,i.changeView(k.VIEWS.forgotPasscodeReset)):(a.serviceError=!0,b.model.verificationCode.value="",a.contentResponse.errorJSON=c)})};b.setSCTags(),b.back=function(){a.contentResponse.errorJSON={},i.changeView(k.VIEWS.forgotPasscodeDeliveryMethod)},b.showValidationErrorsOnBlur=function(){this.validationErrors=!0}}])}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("headerCtrl",["$scope","$rootScope","$injector","timeoutService","siteAnalyticsUtilService","siteTrackingService",function(a,b,c,d,e,f){function g(){}var h=c.get("CONSTANT"),i=c.get("secureRoute");b.showLogout=!1,a.logoutUser=function(){window.location.href=h.URL.LogOff},a.goToBarclaysHomepage=function(){window.location.href=h.URL.BarclaysHomePage};var j=b.$on("openTimeoutModal",function(){a.isModal=!0,a.modalData=d.getModalDataObj()});b.$on("$destroy",function(){j()}),this.startCountdownTimer=function(){e.timeoutAnalytics();var c="Close";setTimeout(function(){document.querySelector("#closebtn").remove(),document.querySelector("#modalbtn_goToStepOne").focus()},100),d.startCountdownTimer(g,1e3).then(function(){c="Expired",a.$broadcast("closeModal")}).finally(function(){f.trackTimeoutActions(c),"Expired"==c?d.executeTimeoutCallbackFn():(b.userData={},b.differentUser=!0,b.initialStep="identification",void 0!=b.contentResponse&&angular.isDefined(b.contentResponse.errorJSON)&&(b.contentResponse.errorJSON={}),i.changeView(h.VIEWS.identification))})},this.cancelCountdownTimer=function(){d.cancelCountdownTimer()},a.goToStepOne=function(){a.$broadcast("closeModal")}}])}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("identificationCtrl",["$rootScope","$scope","$injector","dssTooltipService","partial","authLoginUtilService","identificationUtilService","siteTrackingService","siteAnalyticsUtilService","cmaContent",function(a,b,c,d,e,f,g,h,i,j){var k=c.get("secureRoute"),l=c.get("services"),m=c.get("$cookies"),n=c.get("CONSTANT");b.showValidationErrorsOnBlur=function(){this.validationErrors=!0},b.browser={valid:!1},b.loadBrowserAlert=!0;var o=!1,p=j.data;b.initializeModel=function(){b.model=g.initializeModelValues()},b.initializeModel(),b.rdoLoginTypes=g.getRdoLoginTypeValues(),b.rememberMeCheck=g.getRememberMeCheckValues(),b.configForSortCode=g.getSortCodeClasses(),b.membershipNumberTemplate=e("identification/loginMembershipNumberTemplate.html"),b.sortCodeAndAccNumberTemplate=e("identification/loginSortCodeAccNumberTemplate.html"),b.loginCardNumberTemplate=e("identification/loginCardNumberTemplate.html"),b.tabsLogin=g.getLoginTabs(),b.tooltipConfig=function(a){return d.dssTooltipConfig(p.contentContainer.content.tooltips[a])},b.setSCTags=function(){h.setLoginMechanism(b.model.loginType),h.isAssistCookieSet()&&!o&&"identification"!=a.initialStep||i.getIdentificationAnalyticsData()},b.formsLoaded=!1,b.$on("$includeContentLoaded",function(){"membership"==b.model.loginType&&b.loginStep1.membershipForm?(b.globalErrorFormName="membershipForm",b.formsLoaded=!0):"cardNumber"==b.model.loginType&&b.loginStep1.cardNumberForm?(b.globalErrorFormName="cardNumberForm",b.formsLoaded=!0):"sortCode"==b.model.loginType&&b.loginStep1.sortcodeForm&&(b.globalErrorFormName="sortcodeForm",b.formsLoaded=!0),f.addSubmitEventListener(),AppName.Module.formInstance=b.loginStep1[b.globalErrorFormName]}),b.loginTypeChange=function(a){1==a.currentSelected?(b.model.loginType="cardNumber",b.selectedTab=a.currentSelected,b.formsLoaded&&(b.globalErrorFormName="cardNumberForm")):2==a.currentSelected?(b.model.loginType="sortCode",b.selectedTab=a.currentSelected,b.formsLoaded&&(b.globalErrorFormName="sortcodeForm")):(b.model.loginType="membership",b.selectedTab=a.currentSelected,b.formsLoaded&&(b.globalErrorFormName="membershipForm")),h.setLoginMechanism(b.model.loginType),b.formsLoaded&&(AppName.Module.formInstance=b.loginStep1[b.globalErrorFormName])},b.rdoLoginTypeChange=function(){"membership"==b.model.loginType?(b.selectedTab=0,b.formsLoaded&&(b.globalErrorFormName="membershipForm")):"cardNumber"==b.model.loginType?(b.selectedTab=1,b.formsLoaded&&(b.globalErrorFormName="cardNumberForm")):"sortCode"==b.model.loginType&&(b.selectedTab=2,b.formsLoaded&&(b.globalErrorFormName="sortcodeForm")),h.setLoginMechanism(b.model.loginType),b.formsLoaded&&(AppName.Module.formInstance=b.loginStep1[b.globalErrorFormName])},b.storeUserCookieInfo=function(b){b.body&&(a.userData.data=b.body,a.tfaSwitched=b.body.tfaSwitched)},b.routeOnError=function(c){var d=!0;angular.forEach(c.header.messages,function(e){"SELF_SERVE_UNLOCK"===e.type?(a.errorPageRedirect=!0,a.selfServeLockedError=c,k.changeView(n.VIEWS.selfServeMemLockedOut),d=!1):"LOCKED"===e.type?(a.errorPageRedirect=!0,a.contentResponse.errorJSON=c,a.lockedOut=!0,k.changeView(n.VIEWS.lockedOut),d=!1):"UNLOCK"===e.type?(a.errorPageRedirect=!0,a.failedLoginAttemptsErrorJSON=c,a.userData.dateOfBirth=null,a.userData.cardNumber=null,f.getResetViaSMSSwitch(),d=!1,b.storeUserCookieInfo(c)):"MULTIPLE_MEMBERSHIP"===e.type&&("1372"==e.code?(a.contentResponse={},a.contentResponse.errorJSON={}):a.contentResponse.errorJSON=c,a.loginMultipleMem=!0,k.changeView(n.VIEWS.loginMultipleMemDetails),a.userData.dateOfBirth=null,"sortCode"==b.model.loginType&&(a.userData.cardNumber=null),d=!1)}),d&&(a.serviceError=!0,a.contentResponse.errorJSON=c)},b.forgotMembership=function(){a.forgotMembership=!0,a.contentResponse&&(a.contentResponse.errorJSON={}),k.changeView(n.VIEWS.ForgotMembershipDetails)},b.getUserDetailsResponseHandler=function(c){window.altMvSwitch&&null!==c.body&&null!==c.body.siteIdRedirect&&void 0!==c.body.siteIdRedirect&&c.body.siteIdRedirect&&k.changeView(n.VIEWS.identification),a.contentResponse={},a.contentResponse.errorJSON={},c.errorCode||(!1===c.header.stopFlow?(b.storeUserCookieInfo(c),a.userData.data.trustAnchorIdentificationToken=c.body.trustAnchorIdentificationToken,c.body.trustAnchorIdentificationToken&&c.body.trustAnchorIdentificationToken.trustAnchorEligible?k.changeView(n.VIEWS.confirmIdentity):(c.body.biocatchToken&&$(document.querySelector("meta[name='bcsid']")).attr("content",""+c.body.biocatchToken.sid),b.storeUserCookieInfo(c),c.body.authenticationTokenSpecificationList?k.changeView(n.VIEWS.authentication):c.body.secondaryIdentityTokenSpecifications&&"MembershipNumber"!=c.body.secondaryIdentityTokenSpecifications[0]?(a.userData.dateOfBirth=null,a.userData.gender="",void 0!==a.identifyMembershipData&&delete a.identifyMembershipData,k.changeView(n.VIEWS.identifyJointAccount)):(a.serviceError=!0,a.contentResponse.errorJSON=c))):b.routeOnError(c))},b.getUserDetails=function(a){window.scrollTo(0,0);var c=g.getRequestPayload(b,a);return l.apiService(c.apiName,c.requestParam).then(b.getUserDetailsResponseHandler)},b.submitForm=function(){a.initialStep="identification",b.rememberToken="Y"==b.model.rememberToken[0];var c=b.loginStep1[b.globalErrorFormName];AppName.Module.formInstance.formSubmitted=!0,setTimeout(function(){void 0!=c&&c.$valid?b.getUserDetails(!1):(c.showErrorsIfAny=!0,b.displayglobalerror=!0,f.setFocusOnGlobalErrors())},200)},b.trimLastname=function(a,c){b.model[c].value=f.trimLastname(a)};var q=function(){if(""!=location.search&&!a.stopFlow){var c=location.search.indexOf("error=");if(c>0){var d=location.search.substring(c+6);c=d.indexOf("&");var e="";e=c>0?d.substring(0,c):d;var f={errorCode:e};l.apiService(n.JSON.processError,f).then(function(c){window.scrollTo(0,0),a.contentResponse={},a.contentResponse.errorJSON={},a.stopFlow=!0,c.header.stopFlow?b.routeOnError(c):location.replace(location.href.substr(0,location.href.indexOf("?")))})}}r()},r=function(){var c=m[w];b.defaultMethodCookie=m[x];var d={A:"sortCode",B:"cardNumber",C:"membership"};if(c&&!a.stopFlow)if(a.usersInCookie=b.usersInCookie=c.split(v),c.split(v).length-1!=0&&"identification"!=a.initialStep)if(b.usersInCookie.length-1!=1||a.differentUser){if(a.authForgetId=!1,b.usersInCookie.length-1){var e=b.usersInCookie[0].split("#");b.model.loginType=d[e[2]]}b.usersInCookie.length-1==1&&a.differentUser||(a.changeID=!0,a.initialStep="rememberme",b.loadBrowserAlert=!1,k.changeView(n.VIEWS.rememberMe))}else{var e=b.usersInCookie[0].split("#");b.model.loginType=d[e[2]],a.userData.loginType=d[e[2]],a.userData.surname=e[4],"membership"==b.model.loginType&&(a.userData.membershipNum=e[1]),"cardNumber"==b.model.loginType&&(a.userData.cardNumberMasked="**** **** **** "+e[1].substr(12,4)),"sortCode"==b.model.loginType&&(a.userData.sortCodeMasked=e[1].substr(0,2)+"-"+e[1].substr(2,2)+"-"+e[1].substr(4,2),a.userData.accountNumberMasked="****"+e[1].substring(10)),a.authForgetId=!0,b.loadBrowserAlert=!1,b.getUserDetails(!0)}else{a.authForgetId=!1;var e=b.usersInCookie[0].split("#");b.model.loginType=d[e[2]]}else if(c&&a.stopFlow&&void 0!=a.contentResponse.errorJSON&&!_.isEmpty(a.contentResponse.errorJSON)&&null!=a.contentResponse.errorJSON.header.messages[0].code){if(a.usersInCookie=b.usersInCookie=c.split(v),c.split(v).length-1!=0&&"identification"!=a.initialStep)if(b.usersInCookie.length-1!=1||a.differentUser){if(a.authForgetId=!1,b.usersInCookie.length-1){var e=b.usersInCookie[0].split("#");b.model.loginType=d[e[2]]}b.usersInCookie.length-1==1&&a.differentUser||(a.changeID=!0,a.initialStep="rememberme")}else{var e=b.usersInCookie[0].split("#");b.model.loginType=d[e[2]]}}else a.authForgetId=!1,a.stopFlow=!1;if(o=a.differentUser,a.differentUser=!1,b.defaultMethod=!1,m[x]&&!c)switch(b.defaultMethod=m[x],b.defaultMethod){case"C":b.model.loginType="membership",b.selectedTab=0;break;case"B":b.model.loginType="cardNumber",b.selectedTab=1;break;case"A":b.model.loginType="sortCode",b.selectedTab=2}b.model.loginType||(b.model.loginType="membership"),b.rdoLoginTypeChange()},t=function(){var c=m[u];if(c&&!a.stopFlow&&(b.usersInCookie=c.split(v),c.split(v).length-1!=0&&b.usersInCookie.length-1==1&&!o)){var d=b.usersInCookie[0].split("#");b.model.loginType="membership",b.model.surnameMem.value=d[4],b.model.membershipNum.value=d[1],a.authForgetId=!1,b.loadBrowserAlert=!1,a.initialStep="identification",b.getUserDetails(!1)}},u="register",v="&",w="assist2",v="&",x="default_method";a.lockedOut=!1,a.forgotMembership=!1,a.forgotPasscode=!1,a.forgotPasscodeSuccess=!1,a.loginMultipleMemDetails=!1,a.loginMultipleMem=!1,a.step=1,a.resetViaSMS=!1,b.$watch("browser.valid",function(){b.browser.valid&&b.setSCTags()}),_.isEmpty(a.userData)?a.userData={}:((a.userData.loginType||a.userData.selectedTab)&&(b.model.loginType=a.userData.loginType,b.selectedTab=a.userData.selectedTab),a.userData.surname&&("membership"==b.model.loginType?b.model.surnameMem.value=a.userData.surname:"cardNumber"==b.model.loginType?b.model.surnameCardno.value=a.userData.surname:b.model.surnameSortcode.value=a.userData.surname),"membership"===b.model.loginType&&a.userData.membershipNum&&(b.model.membershipNum.value=a.userData.membershipNum),a.userData.routedFromMembershipFlow=!1),b.wealthUserHelpContent=function(c){window.wealthValue&&window.wealthSwitch?l.apiService(n.JSON.LoginWealthHelpContent).then(function(c){if(c)try{b.faqContent=l.setFaqContent(c),a.faqContent=b.faqContent}catch(a){}}):window.privateBankValue&&window.privateBankSwitch?l.apiService(n.JSON.LoginPrvBnkHelpContent).then(function(c){if(c)try{b.faqContent=l.setFaqContent(c),a.faqContent=b.faqContent}catch(a){}}):b.faqContent=l.setFaqContent(c)},q(),t(),p&&(p.contentContainer&&(angular.forEach(p.contentContainer.content.snippets,function(a,b){a.content=a.content.replace("https://bank.barclays.co.uk/olb/auth/InternetCookies.action?authECN=true","#/cookiePref")}),a.cookieSnippets=p.contentContainer.content.snippets),b.FTBLogin_rememberMe_warning_message="",p.contentContainer.content.snippets.hasOwnProperty("FTBLogin_rememberMe_warning_message")&&(b.FTBLogin_rememberMe_warning_message=p.contentContainer.content.snippets.FTBLogin_rememberMe_warning_message.content.replace("<p>","").replace("</p>","")),b.wealthUserHelpContent(p),a.step1StopFlow&&(a.serviceError=!0,a.contentResponse.errorJSON=a.step1StopFlow,a.step1StopFlow=!1)),b.mobileView=f.isMobileView(),window.onresize=function(){b.mobileView=f.isMobileView(),b.$apply()}}])}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("identifyJointAccountCtrl",["$rootScope","$scope","$injector","forgotUtilService","siteAnalyticsUtilService","authLoginUtilService",function(a,b,c,d,e,f){var g=c.get("secureRoute"),h=c.get("services"),i=c.get("CONSTANT");b.globalErrorFormName="jointAccount",b.setDefaultValues=function(){a.step="jointAccount",b.fields={dob:"DOB",gender:"GENDER"}},b.inititlizeModel=function(){b.model={dateOfBirth:{value:void 0!==a.userData.dateOfBirth&&null!=a.userData.dateOfBirth?a.userData.dateOfBirth:""},gender:{value:void 0!==a.userData.gender&&""!==a.userData.gender?a.userData.gender:"M"},genderRadioList:[{value:"M",name:"Male"},{value:"F",name:"Female"}]}},b.enableFields=function(){b.model.dateOfBirth.disable=!0,b.model.gender.disable=!0,a.userData&&(-1!==a.userData.data.secondaryIdentityTokenSpecifications.indexOf(b.fields.dob)&&(b.model.dateOfBirth.disable=!1),-1!==a.userData.data.secondaryIdentityTokenSpecifications.indexOf(b.fields.gender)&&(b.model.gender.disable=!1))},h.isEmpty(a.userData)?g.changeView(i.VIEWS.identification):(b.setDefaultValues(),void 0!==a.identifyMembershipData&&(a.userData=a.identifyMembershipData,delete a.identifyMembershipData),b.inititlizeModel(),b.enableFields(),h.apiService(i.JSON.loginStep1NoSavedMember).then(function(a){a&&(b.faqContent=h.setFaqContent(a)),e.getIdentifyJointOwnerDetails()})),b.dateOfBirthClass=d.getDateOfBirthClasses(),b.showValidationErrorsOnBlur=function(){this.validationErrors=!0},b.backToLoginForm=function(){g.changeView(i.VIEWS.identification)},f.addSubmitEventListener(),b.submitForm=function(){setTimeout(function(){if(b.jointAccount.$valid){var c=i.JSON.identifyMoreInfo,d={},e={},j={gender:b.model.gender.value};if(10===b.model.dateOfBirth.value.length){var k=b.model.dateOfBirth.value.split("/");e={date:k[0],month:k[1],year:k[2]}}a.userData&&(-1!==a.userData.data.secondaryIdentityTokenSpecifications.indexOf(b.fields.dob)&&(d=angular.extend({},d,e)),-1!==a.userData.data.secondaryIdentityTokenSpecifications.indexOf(b.fields.gender)&&(d=angular.extend({},d,j))),h.apiService(c,d).then(function(c){a.userData.dateOfBirth=b.model.dateOfBirth.value,b.model.gender.disable||(a.userData.gender=b.model.gender.value),c.errorCode||(c&&!1===c.header.stopFlow?(a.identifyMembershipData=angular.copy(a.userData),c.body.trustAnchorIdentificationToken.trustAnchorEligible?g.changeView(i.VIEWS.confirmIdentity):c.body.secondaryIdentityTokenSpecifications&&"MembershipNumber"===c.body.secondaryIdentityTokenSpecifications[0]?(a.serviceError=!0,a.contentResponse.errorJSON=c,g.changeView(i.VIEWS.identification)):(a.userData.data=c.body,a.userData.membershipNum=c.body.membershipId,a.userData.routedFromMembershipFlow=!0,g.changeView(i.VIEWS.authentication))):"MULTIPLE_MEMBERSHIP"===c.header.messages[0].type&&1372===c.header.messages[0].code?b.routeOnError(c):"SELF_SERVE_UNLOCK"===c.header.messages[0].type?(a.errorPageRedirect=!0,a.selfServeLockedError=c,a.userData.membershipNum=c.body.membershipId,a.userData.routedFromMembershipFlow=!0,g.changeView(i.VIEWS.selfServeMemLockedOut)):"LOCKED"===c.header.messages[0].type&&"1524"==c.header.messages[0].code?(a.serviceError=!0,a.contentResponse.errorJSON=c,g.changeView(i.VIEWS.lockedOut),a.userData={}):(a.serviceError=!0,a.contentResponse.errorJSON=c,g.changeView(i.VIEWS.identification),a.userData={}))})}else b.displayglobalerror=!0,b.jointAccount.showErrorsIfAny=!0,f.setFocusOnGlobalErrors()},100)},b.routeOnError=function(b){angular.forEach(b.header.messages,function(c){"MULTIPLE_MEMBERSHIP"===c.type&&(1372===c.code?(a.contentResponse={},a.contentResponse.errorJSON={}):a.contentResponse.errorJSON=b,a.loginMultipleMem=!0,g.changeView(i.VIEWS.loginMultipleMemDetails))})}}])}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("interstitialCtrl",["$rootScope","$scope","$injector","siteAnalyticsUtilService","timeoutService",function(a,b,c,d,e){function f(){return[{value:"Y",display:"Select this box if you do not wish to see this information again.",disabled:!1}]}function g(){return[{value:"Y",display:"Select this box to confirm you have read this information and then select the 'Confirm' button to continue.",disabled:!1}]}var h=c.get("secureRoute"),i=c.get("services"),j=c.get("CONSTANT");if(i.isEmpty(a.userData))h.changeView(j.VIEWS.identification);else{a.showLogout=!0;var k={pageId:a.userData.data.redirectToken.pageId};b.confimCheckValues=g(),b.dontDisplayValues=f(),b.confirmation=[],b.doNotDisplayAgain=[],i.apiService(j.JSON.getInterstitialPageContent,k).then(function(c){window.scrollTo(0,0),a.contentResponse={},a.contentResponse.errorJSON={},c.errorCode||(b.data=c.body,b.interstitialHeaderTitle="Welcome to Online Banking",b.setSCTags())})}b.submitForm=function(){if(b.data.mandatoryTickBoxRequired&&0===b.confirmation.length)return void(b.interstitialForm.showErrorsIfAny=!0);k={confirmation:void 0!==b.confirmation&&"Y"===b.confirmation[0],doNotDisplayAgain:void 0!==b.doNotDisplayAgain&&"Y"===b.doNotDisplayAgain[0]},i.apiService(j.JSON.updateInterstitialPageData,k).then(function(b){b&&(!1===b.header.stopFlow?window.location.href=b.body.url:(h.changeView(j.VIEWS.identification),a.serviceError=!0,a.contentResponse.errorJSON=b,a.stopFlow=!0,a.userData={}))})},b.setSCTags=function(){d.getInterstitialAnalyticsData()},e.registerTimeoutCallbackFn(function(){window.location.href=j.URL.LogOff})}])}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("lockedOutCtrl",["$rootScope","$scope","$injector","content","siteAnalyticsUtilService","siteTrackingService",function(a,b,c,d,e,f){var g=c.get("secureRoute"),h=c.get("services"),i=c.get("CONSTANT"),j="";if(b.setSCTags=function(){e.getLockedOutDetails(j)},b.heroHtmlData={notificationText:"<p class='notification-heading'>You're locked out of Online Banking</p>",type:"error"},a.contentResponse&&a.contentResponse.errorJSON&&a.contentResponse.errorJSON.header&&angular.isArray(a.contentResponse.errorJSON.header.messages)&&a.contentResponse.errorJSON.header.messages.length>0){j=a.contentResponse.errorJSON.header.messages[0].code;var k=a.contentResponse.errorJSON.header.messages[0].text;b.heroHtmlData.notificationText+='<p class="notification-text">Error code: '+j+"</p><br/><p> "+k+" </p>"}void 0!==d&&void 0!==d.data&&(b.contentResponse=d.data,b.faqContent=h.setFaqContent(d.data),a.userData&&b.setSCTags()),b.redirectToHomePage=function(){window.location=i.URL.BarclaysHomePage},b.getLoginMechanismForTracking=function(){switch(a.userData.loginType){case"membership":return"MembershipID";case"sortCode":return"AccountAndSortCode";case"cardNumber":return"CardNumber"}},b.finish=function(){a.lockedOut=!1,a.contentResponse&&(a.contentResponse.errorJSON={}),a.userData={},g.changeView(i.VIEWS.identification)},a.header=!0}])}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("loginMultipleMemDetailsCtrl",["$rootScope","$scope","$injector","forgotUtilService","multipleMembershipUtilService","authLoginUtilService","dssTooltipService","content",function(a,b,c,d,e,f,g,h){var i=c.get("secureRoute"),j=c.get("services"),k=c.get("CONSTANT");b.imageConfig=f.setCVVIcon(),b.showValidationErrorsOnBlur=function(){this.validationErrors=!0},b.globalErrorFormName="multipleMembershipForm",b.tooltipConfig=function(a){return g.dssTooltipConfig(b.contentResponse.contentContainer.content.tooltips[a])},f.addSubmitEventListener(),b.submitForm=function(){window.scrollTo(0,0),a.userData.dateOfBirth=b.model.dateOfBirth.value,a.userData.secCode=b.model.securityCode.value,"sortCode"===a.userData.loginType&&(a.userData.cardNumber=b.model.cardNumber.value),setTimeout(function(){if(b.multipleMembershipForm.$invalid)b.multipleMembershipForm.showErrorsIfAny=!0,b.displayglobalerror=!0,f.setFocusOnGlobalErrors();else{var c=a.userData.cardNumber.split(" "),d={identityToken:{debitCard:{debitCard1:c[0],debitCard2:c[1],debitCard3:c[2],debitCard4:c[3],securityCode:a.userData.secCode.toString()},dateOfBirth:b.model.dateOfBirth.value.replace(/\//g,""),surname:a.userData.surname.toString()}};j.apiService(k.JSON.retrieveMultipleMembershipNumbers,d).then(function(c){c&&(!1===c.header.stopFlow?(a.userData.data=c.body,a.contentResponseData=c,a.memberInfo="",a.userData.data.memberInfos.length>1&&i.changeView(k.VIEWS.loginMultipleMemSuccess)):b.routeOnError(c))})}},100)},b.routeOnError=function(b){angular.forEach(b.header.messages,function(c){a.serviceError=!0,a.contentResponse.errorJSON=b})},b.backToIndentification=function(){a.contentResponse.errorJSON={},i.changeView(k.VIEWS.identification)},a.step="loginMultipleMemDetails",a.loginMultipleMem=!0,a.loginMultipleMemDetails=!0,b.dateOfBirthClass=d.getDateOfBirthClasses(),j.isEmpty(a.userData)?(i.changeView(k.VIEWS.identification),a.userData={}):(h&&(b.contentResponse=h.data,b.faqContent=j.setFaqContent(h.data),e.setSCTags()),b.model=e.initializeModelValues(),"cardNumber"===a.userData.loginType&&(b.model.securityCode.label="Security code for card ending "+a.userData.cardNumberMasked.slice(-4)),a.userData.dateOfBirth&&(b.model.dateOfBirth.value=a.userData.dateOfBirth,a.userData.cardNumber&&(b.model.cardNumber.value=a.userData.cardNumber)))}])}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("loginMultipleMemSuccessCtrl",["$rootScope","$scope","$injector","forgotUtilService","content","multipleMembershipUtilService",function(a,b,c,d,e,f){var g=c.get("secureRoute"),h=c.get("services"),i=c.get("$cookies"),j=c.get("CONSTANT");a.contentResponse={},b.headerMultipleMembership="Select membership to log in",b.textMultipleMembership="You have more than one Online Banking membership number. Please select the right membership number based on the information below.";var k="assist2",l=i[k];if(b.isLoginMultipleMembership=!0,h.isEmpty(a.userData))g.changeView(j.VIEWS.identification),a.userData={};else if(a.loginmethod&&(a.userData.loginType=a.loginmethod),a.userData){a.userData.data&&a.memberInfo&&(a.userData.data.memberInfos=a.memberInfo),e&&(b.contentResponse=e.data,b.faqContent=h.setFaqContent(e.data));var m={};b.usersInfo=[],a.userData.data.memberInfos.length>1&&(b.loginOnlineBankingFlag=!0,d.sortUserMembershipData(),b.userDisabled=d.checkUserDisabled(),angular.forEach(a.userData.data.memberInfos,function(a){var c=d.getMembershipInformationObj(a,b.contentResponse.contentContainer.content);c.isDisabled=a.loginStatus===j.VAR.MEMBER_SUSPEND||d.getLoginStatusCheck(a),b.dormate=d.checkDormateEligibility(a,b.contentResponse.contentContainer.content),b.isShowinCookies=!1,l&&l.indexOf(a.membershipNumber)>-1&&(c.showForgetIdLink=!0,b.isShowinCookies=!0),c.showForgetIdLink||c.isDisabled||a.dormant||""===a.membershipNumber||(b.loginOnlineBankingFlag=!1),b.usersInfo.push({membershipInfo:c})}),m.membershipNumbers=b.loginOnlineBankingFlag?{}:d.setUserMembershipNumber(b.usersInfo),b.firstSelectedUser=d.getFirstSelectedUser(b.usersInfo),m.membershipNumbers=b.firstSelectedUser)}b.isCheckboxEligible=function(a){return d.isCheckboxEligible(a,b.userDisabled)},b.isForgotIdEligible=function(a){return d.isForgotIdEligible(a,b.userDisabled)},b.eventMethod=function(a,c){j.VAR.FORGOT_PASSCODE===a?b.forgottenPasscode(c):j.VAR.UNLOCK_MEMBERSHIP===a?g.changeView(j.VIEWS.lockedOut):j.VAR.SUBMIT_SUSPENDED===a?window.location.href=CONSTANT.URL.SuspendedMembership:j.VAR.SELF_SERVE_UNLOCK===a&&d.selfServeMemUnlock(c)},b.onMemberChangeRadio=function(a){m.membershipNumbers=a},b.submitForm=function(){a.memberInfo=a.userData.data.memberInfos,d.getUserDetails({user:m,usersInfo:b.usersInfo,userData:b.userData,fromRememberMeCookie:!1})},b.backToDetailPage=function(){g.changeView(j.VIEWS.loginMultipleMemDetails)},b.forgetThisUser=function(a){d.removeUserFromAssistCookie(b.usersInfo,a)},b.forgottenPasscode=function(a){d.forgottenPasscode(a)},f.setSCTagsMultiple()}])}(),function(){"use strict";var a=function(a,b,c,d,e,f,g,h,i,j){var k=c.get("secureRoute"),l=c.get("services"),m=c.get("snippetServices"),n=c.get("CONSTANT");b.model={mobilePinsentryCode:""},b.mtfaFormTemplate=j("authentication/mtfaForm.html"),b.mobilePinsEntryInputConfig=e.mobilePinsEntryInputConfig(),b.mobilPINSentryGridData=e.mobilPINSentryGridData(),b.contentResponse=i.data,b.faqContent=l.setFaqContent(i.data),b.hasErrors=!1,l.isEmpty(a.userData)&&k.changeView(n.VIEWS.identification),b.forwardUser=function(b){"INTERSTITIAL"===b.body.redirectToken.type?b.body.redirectToken.displayTypeCode?(a.interstitial={},a.interstitial.displayTypeCode=b.body.redirectToken.displayTypeCode,k.changeView(n.VIEWS.interstitial)):!0===b.body.redirectToken.dynamicInterstitialEligible&&"CHANNELAPP"===b.body.redirectToken.appName?(a.$broadcast("loader_on"),window.location.href=b.body.redirectToken.dynamicInterstitialAddress):!0===b.body.redirectToken.dynamicInterstitialEligible&&(a.interstitial={},a.interstitial.dyanmicInterstitialAddress=b.body.redirectToken.dynamicInterstitialAddress,a.interstitial.appName=b.body.redirectToken.appName,k.changeView(n.VIEWS.dynamicInterstitial)):(a.$broadcast("loader_on"),window.location.href=b.body.redirectToken.url)},b.sendHiddenHelpCardsAndRoute=function(c){var d=a.hiddenHelpCards.filter(function(b){return-1===a.existingHelpCards.indexOf(b)}),e={helpCards:d},f=n.JSON.addHiddenHelpCards,g=l.setRememberMeInfoPostAuthentication(c);l.apiService(f,e).then(function(a){g&&g.rememberMeDVOs&&g.rememberMeDVOs.length>0?l.apiService(n.JSON.rememberUser,g).then(function(a){b.forwardUser(c)}):b.forwardUser(c)})},b.routeOnError=function(b){window.scrollTo(0,0);var c=!0;angular.forEach(b.header.messages,function(e){"SELF_SERVE_UNLOCK"===e.type?(a.errorPageRedirect=!0,a.selfServeLockedError=b,k.changeView(n.VIEWS.selfServeMemLockedOut),c=!1):"MEMBERSHIP_UNLOCK"===e.type||"LOCKED"===e.type?(a.errorPageRedirect=!0,a.contentResponse.errorJSON=b,a.lockedOut=!0,k.changeView(n.VIEWS.lockedOut),c=!1):"DFA_LOCK_OUT_SFA"===e.type?(a.contentResponse.errorJSON={},a.userData.data.lockedMethods=new Array,a.userData.data.lockedMethods[0]="SFA",angular.forEach(a.userData.data.authenticationTokenSpecificationList,function(b,c){"SFA"===b.method&&a.userData.data.authenticationTokenSpecificationList.splice(c,1)}),"SFA"===a.userData.data.defaultAuthenticationMethod&&(1===a.userData.data.authenticationTokenSpecificationList.length?a.userData.data.defaultAuthenticationMethod=a.userData.data.authenticationTokenSpecificationList[0].method:a.userData.data.defaultAuthenticationMethod="TFA"),d.reload(),c=!1):"UNLOCK"===e.type&&(a.serviceError=!0,a.contentResponse.errorJSON=b,a.userData.dateOfBirth=null,a.userData.cardNumber=null,h.getResetViaSMSSwitch(),c=!1)}),c&&(k.changeView(n.VIEWS.identification),a.stopFlow=!0,a.userData={},a.contentResponse.errorJSON=b)},b.submitFormDetails=function(c,d){window.scrollTo(0,0),l.apiService(c,d).then(function(c){a.contentResponse={},a.contentResponse.errorJSON={},c&&(!1===c.header.stopFlow?(a.userData.data=c.body,m.updateCCPCookie(c.body.verificationToken.membershipNumber).then(function(d){"FEDERATION"===c.body.redirectToken.type?(a.$broadcast("loader_on"),window.location.href=c.body.redirectToken.url+"?REF="+c.body.redirectToken.referenceId):b.sendHiddenHelpCardsAndRoute(c)})):b.routeOnError(c))})},b.submitAuth=function(){var a,c={};if(AppName.Module.formInstance.formSubmitted=!1,b.MTFAInputForm.$invalid)return b.MTFAInputForm.showErrorsIfAny=!0,b.hasErrors=!0,b.displayglobalerror=!0,void h.setFocusOnGlobalErrors();var d=b.model.mobilePinsentryCode.value.split("-");c={pinsentryCode:{partOnePasscode:d[0],partTwoPasscode:d[1]},resetPinSentry:"false",mobile:l.isMobile()},a=n.JSON.MTFALogin,b.submitFormDetails(a,c)},b.cancelAuth=function(){window.history.back()},b.model=e.initializeTFAModelValues(),b.globalErrorFormName="MTFAInputForm",l.apiService(n.JSON.getHiddenHelpCards).then(function(b){b&&b.body&&b.body.helpCards&&(a.hiddenHelpCards=b.body.helpCards,a.existingHelpCards=angular.copy(b.body.helpCards))})};a.$inject=["$rootScope","$scope","$injector","$route","authenticationUtilService","siteTrackingService","siteAnalyticsUtilService","authLoginUtilService","cmaContent","partial"],angular.module("appBdlLogin.controllers").controller("mobilePINSentryCtrl",a)}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("rememberMeCtrl",["$rootScope","$scope","$injector","$window","authLoginUtilService","siteAnalyticsUtilService","siteTrackingService","cmaContent",function(a,b,c,d,e,f,g,h){function i(){var c=document.cookie.split("assist2=")[1];if(c.split("&").length-1!=0){var d=c.split("&");2===d.length?(b.model.selectedUser="radio0",b.submitForm(d[0]),a.authForgetId=!0):(a.authForgetId=!1,b.usersInCookie=c.split("&"),j(b.usersInCookie))}}function j(a){for(var c=[],d=0,e=0;e<a.length-1;e++)if(""!==a[e].replace(/^\s+|\s+$/gm,"")){var f=a[e].split("#");c[d]={},c[d].radioConfig=[],c[d].memberShipNumber=f[0],c[d].loginTypeInfo=f[1],c[d].loginType=f[2],c[d].firstNameLetter=f[3],c[d].surname=f[4],c[d].userId="radio"+d,c[d].radioConfig=[{value:"radio"+d,label:c[d].loginTypeInfo}],c[d].tableConfig={columns:[{field:"lastname",display:"Surname/Last name"}],rows:{lastname:[{text:c[d].firstNameLetter+" "+c[d].surname,class:"bold block"}]}},d++}1===c.length&&k.changeView(m.VIEWS.identification),b.users=c,b.model.selectedUser="radio0"}var k=c.get("secureRoute"),l=c.get("services"),m=c.get("CONSTANT");b.step=1,b.model={selectedUser:""},b.browser={validBrowser:!1},b.$watch("browser.valid",function(){b.browser.valid&&(f.getAssistCookieAnalyticsData(),a.step=1)}),b.routeOnError=function(b){var c=!0;angular.forEach(b.header.messages,function(b){"LOCKED"==b.type&&(a.userData.dateOfBirth=null,a.userData.cardNumber=null,e.getResetViaSMSSwitch(),c=!1)}),c&&k.changeView(m.VIEWS.identification)},b.differentDetails=function(){a.initialStep="identification",a.userData={},k.changeView(m.VIEWS.identification)},b.forgetUser=function(b){var c={index:b.split("radio")[1]},d=m.JSON.ForgetUser;l.apiService(d,c).then(function(c){window.scrollTo(0,0),a.contentResponse={},a.contentResponse.errorJSON={},c.errorCode||(!1===c.header.stopFlow?i(b):(a.serviceError=!0,a.contentResponse.errorJSON=c))})},b.submitForm=function(c){var d,e,f=b.model.selectedUser,g=b.users,h={};if(c){var i=c.split("#");h.memberShipNumber=i[0],h.loginTypeInfo=i[1],h.loginType=i[2],h.firstNameLetter=i[3],h.surname=i[4],h.userId="radio0"}else for(var j=0;j<g.length;j++)if(g[j].userId===f){h=g[j];break}switch(a.userData={},a.userData.surname=h.surname,h.loginType){case"A":a.userData.loginType="sortCode",a.userData.sortCodeMasked=h.loginTypeInfo.substring(0,2)+"-"+h.loginTypeInfo.substring(2,4)+"-"+h.loginTypeInfo.substring(4,6),a.userData.accountNumberMasked="****"+h.loginTypeInfo.substring(10);break;case"B":a.userData.loginType="cardNumber",a.userData.cardNumberMasked="**** **** **** "+h.loginTypeInfo.substring(12,16);break;case"C":a.userData.loginType="membership",a.userData.membershipNum=h.memberShipNumber}e={index:h.userId.split("radio")[1]},d=m.JSON.identifyRememberMe,l.apiService(d,e).then(function(c){window.scrollTo(0,0),a.contentResponse={},a.contentResponse.errorJSON={},a.formFieldErrorObj={fieldErrors:{},errorObjArray:{}},c.errorCode||(!1===c.header.stopFlow?(a.userData.data=c.body,c.body.trustAnchorIdentificationToken&&c.body.trustAnchorIdentificationToken.trustAnchorEligible?k.changeView(m.VIEWS.confirmIdentity):k.changeView(m.VIEWS.authentication)):(a.serviceError=!0,b.routeOnError(c),a.contentResponse.errorJSON=c))})},b.cancelRememberMe=function(){d.location.href=m.URL.BarclaysHomePage},h&&void 0!=h.data&&(angular.forEach(h.data.contentContainer.content.snippets,function(a,b){a.content=a.content.replace("https://bank.barclays.co.uk/olb/auth/InternetCookies.action?authECN=true","#/cookiePref")}),b.contentResponse=h.data,b.faqContent=l.setFaqContent(h.data),b.faqContent.eligible=!0,a.cookieSnippets=h.data.contentContainer.content.snippets,j(a.usersInCookie))}])}(),function(){"use strict";var a=function(a,b,c,d,e,f,g,h,i){b.imageConfig=e.setCVVIcon(),b.imageConfigCard=e.setCardLastDigitsIcon(),b.globalErrorFormName="scaCardAuthenticationForm",void 0===a.userData?d.changeView(c.VIEWS.identification):(b.model={},i&&(b.contentResponse=i.data,b.faqContent=f.setFaqContent(i.data),g.scaCardAuthenticationAnalyticsData()),a.userData.data&&a.scaAuthenticationTokenSpecificationList&&(a.userData.data.authenticationTokenSpecificationList=a.scaAuthenticationTokenSpecificationList),b.authenticationToken={digits:e.getCardLastDigits()}),e.addSubmitEventListener(),b.submitForm=function(){setTimeout(function(){if(b.scaCardAuthenticationForm.$invalid)b.displayglobalerror=!0,b.scaCardAuthenticationForm.showErrorsIfAny=!0,e.setFocusOnGlobalErrors();else{var d={cardDigits:b.model.cardLastDigits,securityCode:b.model.securityCode,mobile:a.scaUserData.data.mobile,sfaEligible:a.scaUserData.isSFAEligible};a.scaUserData.isSFAEligible?d.singleFactorAuthenticationToken=a.scaUserData.data:b.scaUserData.isSFANewMemorableWord?b.requestParam.memorableWordAuthenticationToken=b.scaUserData.data:d.newPasscodeAndMemorableWordAuthenticationToken=a.scaUserData.data,h.submitLoginRequest(c.JSON.scaCardAuthentication,d)}},100)},b.getScaMobileNumber=function(){window.scrollTo(0,0),h.getScaMobileNumber()},b.infoAlertContent={alertmessage:"<p class='alert-heading'>Protecting your account</p>",additionalcontent:"<p> As an extra security check, sometimes we&#39;ll ask you to enter the security code (CVV) from the back of your card. Or, if you prefer you can request a one time use verification code by text message instead. Please enter your CVV or request a text to your mobile phone below.</p>"},b.scaCardBackAction=function(){d.changeView(c.VIEWS.identification)}};a.$inject=["$rootScope","$scope","CONSTANT","secureRoute","authLoginUtilService","services","siteAnalyticsUtilService","authenticationUtilService","content"],angular.module("appBdlLogin.controllers").controller("scaCardAuthenticationCtrl",a)}(),function(){"use strict";var a=function(a,b,c,d,e,f,g,h,i,j){if(b.sendOtpBtnLabel="Send Code",b.showLoadingBtn=!1,b.otpSent=!1,b.globalErrorFormName="scaOtpAuthenticationForm",b.attemptRemaining=!0,void 0===a.userData&&void 0===a.scaIdentifier)d.changeView(c.VIEWS.identification);else{g&&(b.contentResponse=g.data,b.faqContent=f.setFaqContent(g.data),h.scaOtpAuthenticationAnalyticsData()),b.mobileNoList=a.scaIdentifier.mobileNumberList,b.model={smsOtp:{value:""},mobileNumber:{value:b.mobileNoList[0].mobileNumberId}},b.sendOneTimeCode=function(){b.otpSent=!1,b.showLoadingBtn=!0,b.scaOtpAuthenticationForm.showErrorsIfAny=!1,b.model.smsOtp.value="",f.apiService(c.JSON.sendOneTimeCode,{mobileNumberIdentifier:b.mobileNoList.find(function(a){return a.mobileNumberId===b.model.mobileNumber.value})}).then(function(c){b.showLoadingBtn=!1,b.otpSent=!0,a.contentResponse={},a.contentResponse.errorJSON={},c&&(!1===c.header.stopFlow?(b.sendOtpBtnLabel="Resend",b.attemptRemaining=c.body.attemptRemaining,b.attemptRemaining?setTimeout(function(){var a=document.querySelector('[name="scaVerificationCode"]');a&&a.focus()},0):j.tagAlertsOnPage("We can't send you any more codes by text.")):i.routeOnError(c))})};var k="FTB_SCAOTP_Mobile_Number"+(void 0!=a.scaIdentifier.snippetType?a.scaIdentifier.snippetType:""),l="";g.data.contentContainer.content.snippets[k]&&(l=g.data.contentContainer.content.snippets[k].content),b.incorrectMobNumAccordionData=[{heading:"Is your phone number up to date?",noTemplate:!0,content:l}];var m="FTB_LoginStepOneTimePassCodeAuthentication_Attempts_Exceeded"+(void 0!=a.scaIdentifier.snippetType?a.scaIdentifier.snippetType:"");b.noAttemptSnippetName={alertmessage:"<p class='alert-heading'>We can't send you any more verification code by text message</p>",additionalcontent:""},void 0!=g.data.contentContainer.content.snippets[m]&&angular.forEach($(g.data.contentContainer.content.snippets[m].content),function(a,c){c>0&&void 0!=a.outerHTML&&(b.noAttemptSnippetName.additionalcontent+=a.outerHTML)}),e.addSubmitEventListener(),b.submitForm=function(){setTimeout(function(){if(b.scaOtpAuthenticationForm.$invalid)b.displayglobalerror=!0,b.scaOtpAuthenticationForm.showErrorsIfAny=!0,e.setFocusOnGlobalErrors();else{var d={otp:b.model.smsOtp.value,sfaEligible:a.scaUserData.isSFAEligible};a.scaUserData.isSFAEligible?d.singleFactorAuthenticationToken=a.scaUserData.data:d.newPasscodeAndMemorableWordAuthenticationToken=a.scaUserData.data,i.submitLoginRequest(c.JSON.validateOneTimeCode,d)}},100)}}b.scaOtpBackAction=function(){d.changeView(c.VIEWS.identification)}};a.$inject=["$rootScope","$scope","CONSTANT","secureRoute","authLoginUtilService","services","content","siteAnalyticsUtilService","authenticationUtilService","siteTrackingService"],angular.module("appBdlLogin.controllers").controller("scaOtpAuthenticationCtrl",a)}(),function(){"use strict";var a=function(a,b,c,d,e,f,g,h){if(void 0===a.userData&&void 0===a.mobileNumberList)return e.changeView(g.VIEWS.identification),!1;var i,j,k;void 0!==c&&void 0!==c.data&&(b.contentResponse=c.data,b.faqContent=f.setFaqContent(c.data),k=c.data.contentContainer.content.snippets.BDL_SelfServeMembershipLockedOut_Alert_Header.content),b.heroHtmlData={notificationText:k,type:"error"},a.selfServeLockedError&&(i=a.selfServeLockedError.header.messages[0].code,j=a.selfServeLockedError.header.messages[0].text,b.heroHtmlData.notificationText+='<p class="notification-text">Error code: '+i+"</p><br/><p> "+j+" </p>"),d.getSelfServeLockedOutAnalyticsData(i),b.cancel=function(){delete a.selfServeLockedError,e.changeView(g.VIEWS.identification)},b.redirectToSelfServe=function(){delete a.selfServeLockedError,h.clearUserDetails(),e.changeView(g.VIEWS.selfServeMemUnlockUserDetails)}};a.$inject=["$rootScope","$scope","cmaContent","siteAnalyticsUtilService","secureRoute","services","CONSTANT","selfServeMemUnlockUtilService"],angular.module("appBdlLogin.controllers").controller("selfServeMemLockedOutCtrl",a)}(),function(){"use strict";var a=function(a,b,c,d,e,f,g,h,i,j){if(b.sendOtpBtnLabel="Send code",b.showLoadingBtn=!1,b.otpSent=!1,b.globalErrorFormName="selfServeMemUnlockOtpAuthForm",b.attemptRemaining=!0,b.stepsData=i.getStepsData(2),void 0===a.userData&&void 0===a.mobileNumberList)d.changeView(c.VIEWS.identification);else{g&&(b.contentResponse=g.data,b.faqContent=f.setFaqContent(g.data),h.getSelfServeUnlockOtpAuthAnalyticsData()),b.mobileNoList=a.mobileNumberList,b.model={smsOtp:{value:""},mobileNumber:{value:b.mobileNoList[0].mobileNumberId}},b.sendOneTimeCode=function(){b.otpSent=!1,b.showLoadingBtn=!0,b.selfServeMemUnlockOtpAuthForm.showErrorsIfAny=!1,b.model.smsOtp.value="",f.apiService(c.JSON.sendOneTimeCode,{mobileNumberIdentifier:b.mobileNoList.find(function(a){return a.mobileNumberId===b.model.mobileNumber.value})}).then(function(c){b.showLoadingBtn=!1,b.otpSent=!0,a.contentResponse={},a.contentResponse.errorJSON={},c&&(!1===c.header.stopFlow?(b.sendOtpBtnLabel="Resend code",b.attemptRemaining=c.body.attemptRemaining,b.attemptRemaining?(setTimeout(function(){var a=document.querySelector('[name="scaVerificationCode"]');a&&a.focus()},0),j.tagAlertsOnPage("We have sent SMS verification code")):j.tagAlertsOnPage("We can't send you any more codes by text.")):(a.serviceError=!0,a.contentResponse.errorJSON=c))})};var k="SelfServeMembershipUnlock_OTP";a.snippetType&&(k+="_"+a.snippetType),b.incorrectMobNumAccordionData=[{heading:"Incorrect number?",noTemplate:!0,content:g.data.contentContainer.content.snippets[k].content}];var l="BDL_SelfServeMembershipUnlock_OTP_Attempts_Exceeded"+a.snippetType;b.noAttemptSnippetName={alertmessage:g.data.contentContainer.content.snippets.BDL_SelfServeMembershipUnlock_OTP_Attempts_Exceeded_Header.content,additionalcontent:g.data.contentContainer.content.snippets[l].content},b.successAlertContent={alertmessage:g.data.contentContainer.content.snippets.BDL_SelfServeMembershipUnlockOTPAuthentication_SMS_Success_Alert.content,additionalcontent:""},b.singleMobileTableData={columns:[{field:"mobileNumber",display:"Mobile number"}],rows:{mobileNumber:[{text:b.mobileNoList[0].mobileNumber}]}},e.addSubmitEventListener(),b.submitForm=function(){setTimeout(function(){if(b.selfServeMemUnlockOtpAuthForm.$invalid)b.displayglobalerror=!0,b.selfServeMemUnlockOtpAuthForm.showErrorsIfAny=!0,e.setFocusOnGlobalErrors();else{var g={oneTimeCode:b.model.smsOtp.value};f.apiService(c.JSON.validateMembershipUnlockOneTimeCode,g).then(function(e){window.scrollTo(0,0),a.contentResponse={},a.contentResponse.errorJSON={},e&&!1===e.header.stopFlow?d.changeView(c.VIEWS.selfServeMemUnlockSuccess):(a.serviceError=!0,b.model.smsOtp.value="",a.contentResponse.errorJSON=e)})}},100)}}b.backAction=function(){void 0!=a.contentResponse&&(a.contentResponse.errorJSON={}),d.changeView(c.VIEWS.selfServeMemUnlockUserDetails)}};a.$inject=["$rootScope","$scope","CONSTANT","secureRoute","authLoginUtilService","services","cmaContent","siteAnalyticsUtilService","selfServeMemUnlockUtilService","siteTrackingService"],angular.module("appBdlLogin.controllers").controller("selfServeMemUnlockOtpAuthCtrl",a)}(),function(){"use strict";var a=function(a,b,c,d,e,f){var g=c.get("secureRoute"),h=c.get("CONSTANT");if(c.get("services").isEmpty(a.userData))return g.changeView(h.VIEWS.identification),!1;d&&(b.contentResponse=d.data,f.getSelfServeUnlockSuccessAnalyticsData()),b.stepsData=e.getStepsData(3),b.unlockMemSuccessHero={notificationText:d.data.contentContainer.content.snippets.BDL_SelfServeMembershipUnlockSuccess_SUCCESS_Header.content,type:"success"},b.fraudAlertContent={alertmessage:d.data.contentContainer.content.snippets.BDL_SelfServeMembershipUnlockSuccess_Fraud_Smart_Alert_Heading.content,additionalcontent:d.data.contentContainer.content.snippets.BDL_SelfServeMembershipUnlockSuccess_Fraud_Smart_Alert_Content.content},b.backToLogin=function(){void 0!=a.contentResponse&&(a.contentResponse.errorJSON={}),g.changeView(h.VIEWS.identification)}};a.$inject=["$rootScope","$scope","$injector","cmaContent","selfServeMemUnlockUtilService","siteAnalyticsUtilService"],angular.module("appBdlLogin.controllers").controller("selfServeMemUnlockSuccessCtrl",a)}(),function(){"use strict";var a=function(a,b,c,d,e,f,g,h,i,j,k){var l=d.get("secureRoute"),m=d.get("services"),n=d.get("CONSTANT");if(void 0===b.userData)return l.changeView(n.VIEWS.identification),!1;a.data&&(c.faqContent=m.setFaqContent(a.data),c.contentResponse=a.data),c.model=i.initializeModelValues(),c.globalErrorFormName="selfServeMemUnlockUserDetailsForm",c.solusMerchantInputTemplate=k("forgot/solusMerchantDetails.html"),c.setSCTags=function(){g.getSelfServeUnlockUserDetailsAnalyticsData()},c.imageConfig=h.setCVVIcon(),c.stepsData=i.getStepsData(1),c.dateOfBirthClass=e.getDateOfBirthClasses(),c.solusAccNosClass=e.getSolusAccountNumber(),!0===window.mortgageMasterSwitch&&!0===window.mortgagePasscodeSwitch&&c.model.accountType.accounts.push({id:n.VAR.MORTGAGE,accountId:n.VAR.MORTGAGE,accountName:n.VAR.MORTGAGE}),!0===window.merchantSolusLiteSwitch&&(c.model.accountType.accounts.push({id:n.VAR.SOLUS_MERCHANT_ACCOUNT,accountId:n.VAR.SOLUS_MERCHANT_ACCOUNT,accountName:n.VAR.SOLUS_MERCHANT_ACCOUNT}),c.configForSortCode=j.getSortCodeClasses()),c.model.accountType.accounts.length>1&&(c.accountTypeListAvailable=!0),c.backToLoginForm=function(){b.contentResponse&&(b.contentResponse.errorJSON={}),l.changeView(n.VIEWS.identification)},c.showValidationErrorsOnBlur=function(){this.validationErrors=!0},c.tooltipConfig=function(a){return f.dssTooltipConfig(c.contentResponse.contentContainer.content.tooltips[a])},h.addSubmitEventListener(),c.submitForm=function(){setTimeout(function(){c.selfServeMemUnlockUserDetailsForm.$valid?o():(c.selfServeMemUnlockUserDetailsForm.showErrorsIfAny=!0,c.displayglobalerror=!0,h.setFocusOnGlobalErrors())},300)};var o=function(){b.contentResponse.errorJSON={};var a=i.getRequestPayload(c.model);window.scrollTo(0,0),m.apiService(a.apiName,a.requestParam).then(function(a){!1===a.header.stopFlow&&!1===a.body.success?(b.userData={},b.contentResponse.errorJSON=a,l.changeView(n.VIEWS.lockedOut)):!1===a.header.stopFlow?(b.mobileNumberList=a.body.mobileNumberList,b.snippetType=a.body.snippetType,b.userData.routedFromMembershipFlow&&(b.userData.routedFromMembershipFlow=!1),i.setUserDetails(c.model),l.changeView(n.VIEWS.selfServeMemUnlockOtpAuth)):(b.serviceError=!0,c.model.accountType.value===n.VAR.CURRENT_SAVINGS_ACCOUNT&&(c.model.securityCode.value=null),b.contentResponse.errorJSON=a,"1524"==a.header.messages[0].code&&(b.userData={},l.changeView(n.VIEWS.lockedOut)))})};c.setSCTags()};a.$inject=["cmaContent","$rootScope","$scope","$injector","forgotUtilService","dssTooltipService","siteAnalyticsUtilService","authLoginUtilService","selfServeMemUnlockUtilService","identificationUtilService","partial"],angular.module("appBdlLogin.controllers").controller("selfServeMemUnlockUserDetailsCtrl",a)}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("solusMerchantTncCtrl",["$rootScope","$scope","imageUrl","authLoginUtilService","services","secureRoute","CONSTANT","siteAnalyticsUtilService","authenticationUtilService","$timeout",function(a,b,c,d,e,f,g,h,i,j){if(e.isEmpty(a.userData))return void f.changeView(g.VIEWS.identification);b.isEditEmail=!1,b.multioutletSwitch=window.multioutletSwitch,b.tilesData={},b.multioutletSwitch?b.tilesData=[{card:[{dataType:"htmlFormat",htmlData:'<div class="card-media"><img aria-hidden="true" src="'+c("solus-tnc-tile-image-01.jpg")+'"></div>\n<div class="card-content"><h4 class="card-heading">View transaction details</h4>\n<p class="card-text ">View the details of your transactions for the last 28 days</p>\n</div>',alignment:"column"},{dataType:"htmlFormat",htmlData:'<div class="card-media"><img aria-hidden="true" src="'+c("solus-tnc-tile-image-02.jpg")+'"></div>\n<div class="card-content"><h4 class="card-heading">Access statements online</h4>\n<p class="card-text ">Access your statements whenever you need them</p>\n</div>',alignment:"column"},{dataType:"htmlFormat",htmlData:'<div class="card-media"><img aria-hidden="true" src="'+c("solus-tnc-tile-image-03.jpg")+'"></div>\n<div class="card-content"><h4 class="card-heading">View payment details</h4>\n<p class="card-text ">Keep track of when funds will reach your business bank account</p>\n</div>',alignment:"column"}]}]:b.tilesData=[{card:[{dataType:"htmlFormat",htmlData:'<div class="card-media"><img aria-hidden="true" src="'+c("solus-tnc-tile-image-01.jpg")+'"></div>\n<div class="card-content"><h4 class="card-heading">View transaction details</h4>\n<p class="card-text ">View the details of your transactions for the past 28 days</p>\n</div>',alignment:"column"},{dataType:"htmlFormat",htmlData:'<div class="card-media"><img aria-hidden="true" src="'+c("solus-tnc-tile-image-02.jpg")+'"></div>\n<div class="card-content"><h4 class="card-heading">Access statements online</h4>\n<p class="card-text ">Access up to 13 months of your statements whenever you need them</p>\n</div>',alignment:"column"},{dataType:"htmlFormat",htmlData:'<div class="card-media"><img aria-hidden="true" src="'+c("solus-tnc-tile-image-03.jpg")+'"></div>\n<div class="card-content"><h4 class="card-heading">View payment details</h4>\n<p class="card-text ">Keep track of when funds will reach your business bank account</p>\n</div>',alignment:"column"}]}],b.merchantUserData=i.getMerchantUserData(),b.multioutletSwitch||b.merchantUserData.email&&""!=b.merchantUserData.email||(b.isEditEmail=!0),h.setSolusTnCAnalyticsTag(),b.editEmail=function(){b.isEditEmail=!0},d.addSubmitEventListener(),b.submitForm=function(){j(function(){if(b.merchantTncForm.$invalid&&!b.multioutletSwitch)b.isEditEmail=!0,b.merchantTncForm.showErrorsIfAny=!0,document.querySelector('[name="emailInput"]').focus();else{a.contentResponse.errorJSON={};var c={email:b.merchantUserData.email,emailUpdate:b.isEditEmail,mobile:b.merchantUserData.data.mobile,sfaEligible:b.merchantUserData.isSFAEligible};b.merchantUserData.isSFAEligible?c.singleFactorAuthenticationToken=b.merchantUserData.data:c.newPasscodeAndMemorableWordAuthenticationToken=b.merchantUserData.data,i.submitLoginRequest(g.JSON.merchantAuthentication,c)}},0)},b.cancel=function(){void 0!=a.identityUserData&&delete a.identityUserData,void 0!=a.scaAuthenticationTokenSpecificationList&&delete a.scaAuthenticationTokenSpecificationList,a.userData={},f.changeView(g.VIEWS.identification)}}])}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("taNotificationCtrl",["$rootScope","$scope","$injector","authLoginUtilService","partial",function(a,b,c,d,e){var f=c.get("secureRoute"),g=c.get("services"),h=(c.get("$cookies"),c.get("CONSTANT"));b.hasSentNotification=!0,b.hasCheckNotification=!1,b.hasTrouble=!1,b.hasResentNotification=!1,b.spinnerTemplate=e("spinner.html"),b.alertTemplateData={alertmessage:"<div class='alert-heading'>Check the device you're registered on</div>",additionalcontent:"<div><p class='mt-24'>We've sent a notification to your device. Just tap it, log in, check the details and that you're happy to continue. The notification will expire in 2 minutes.</p><br> <b-button ng-click='onIssueBtnClick()' name='issueButton' class='btn-primary btn-sm auto-width mt-0' value='Didn&#39t get our notification?'></b-button></div>"},b.notifAlertTemplateData={alertmessage:"<div class='alert-heading'>We've sent your notification again</div>",additionalcontent:"<div><p class='mt-24'>Just tap the notification we resent, log in, check the details and that you're happy to continue. The notification will expire in 2 minutes.</p></div>"},b.notificationAlertTemplateData={alertmessage:"<div class='alert-heading'>Check the device you're registered on</div>",additionalcontent:"<div><p class='mt-24'>We've sent a notification to your device. Just tap it, log in, check the details and that you're happy to continue. The notification will expire in 2 minutes.</p><br> <b-button ng-click='onConfirmBtnClick()' name='confirmButton' class='btn-primary btn-sm auto-width mt-0 mb-15' value='I&#39ve confirmed this'></b-button><br> <b-button ng-click='onIssueBtnClick()' name='issueButton' class='btn-secondary btn-sm auto-width mt-0' value='Didn&#39t get our notification?'></b-button></div>"},b.errorAlertTemplateData={alertmessage:"<div class='alert-heading'>You have not yet confirmed this action</div>",additionalcontent:"<div><p class='mt-24'>Please tap the notification sent to your phone and confirm or decline this action to continue.</p></div>"},b.browser={valid:!1},b.loadBrowserAlert=!0,g.isEmpty(a.userData)&&f.changeView(h.VIEWS.identification),b.onIssueBtnClick=function(){b.hasCheckNotification=!0},b.onStillTrouble=function(){b.hasTrouble=!0},b.onResendNotification=function(){b.hasResentNotification=!0,b.hasSentNotification=!1,window.scrollTo(0,0)},b.onUseMobilePINSentry=function(){b.onStopPolling(),f.changeView(h.VIEWS.mobilePINSentry)},b.cancelBtnLabel="Back",b.cancelAuth=function(){f.changeView(h.VIEWS.identification)},a.lockedOut=!1,a.forgotMembership=!1,a.forgotPasscode=!1,a.forgotPasscodeSuccess=!1,a.loginMultipleMemDetails=!1,a.loginMultipleMem=!1,a.isMultipleLoginFlag=!1,a.step=1,b.$watch("browser.valid",function(){b.browser.valid}),b.wealthUserHelpContent=function(c){window.wealthValue&&window.wealthSwitch?g.apiService(h.JSON.LoginWealthHelpContent).then(function(c){if(c)try{b.faqContent=g.setFaqContent(c),a.faqContent=b.faqContent}catch(a){}}):window.privateBankValue&&window.privateBankSwitch?g.apiService(h.JSON.LoginPrvBnkHelpContent).then(function(c){if(c)try{b.faqContent=g.setFaqContent(c),a.faqContent=b.faqContent}catch(a){}}):b.faqContent=g.setFaqContent(c)},g.apiService(h.JSON.loginStep1NoSavedMember).then(function(c){c&&(c.contentContainer&&(angular.forEach(c.contentContainer.content.snippets,function(a,b){a.content=a.content.replace("https://bank.barclays.co.uk/olb/auth/InternetCookies.action?authECN=true","#/cookiePref")}),a.cookieSnippets=c.contentContainer.content.snippets),b.contentResponse=c,b.FTBLogin_rememberMe_warning_message="",b.contentResponse.contentContainer.content.snippets.hasOwnProperty("FTBLogin_rememberMe_warning_message")&&(b.FTBLogin_rememberMe_warning_message=b.contentResponse.contentContainer.content.snippets.FTBLogin_rememberMe_warning_message.content.replace("<p>","").replace("</p>","")),b.wealthUserHelpContent(c),a.step1StopFlow&&(a.serviceError=!0,a.contentResponse.errorJSON=a.step1StopFlow,a.step1StopFlow=!1))}),b.mobileView=d.isMobileView(),window.onresize=function(){b.mobileView=d.isMobileView(),b.$apply()}}])}(),function(){"use strict";angular.module("appBdlLogin.controllers").controller("trustAnchorCtrl",["$rootScope","$route","$scope","$injector","authLoginUtilService","partial","trustAnchorService","$timeout","siteAnalyticsUtilService","$http","timeoutService",function(a,b,c,d,e,f,g,h,i,j,k){function l(a){var b=a.text.split(".");return{alertmessage:"<h3 class='alert-heading'>"+a.code+" - "+b[0]+"</h3>",additionalcontent:"<div><p class='mt-24'>"+b[1]+"</p></div>"}}function m(a){return 80220==a.code||80221==a.code||80222==a.code||80223==a.code}var n=d.get("secureRoute"),o=d.get("services"),p=d.get("snippetServices"),q=d.get("CONSTANT");c.shouldSendNotification=!0,c.hasSentNotification=!1,c.hasCheckNotification=!1,c.hasTrouble=!1,c.hasResentNotification=!1,c.hasPolling=!0,c.hasPushNotifError=!1,c.hasPending=!1,c.showIssueBtn=!1,c.sendNotificationClicked=!1,c.spinnerTemplate=f("spinner.html"),c.pushNotificationError="",c.alertTemplateData={alertheading:"<h3 class='alert-heading' tabindex='-1'>Check the device you're registered on</h3>",alertmessage:"<div><p id='checkDeviceAlert1' class='mt-24'>We've sent a notification to your device. Just tap it, log in, check the details and that you're happy to continue. The notification will expire in 2 minutes.</p></div>"},c.alertTemplateDataWithBtn={alertheading:"<h3 class='alert-heading' tabindex='-1'>Check the device you're registered on</h3>",alertmessage:"<div><p id='checkDeviceAlert1' class='mt-24'>We've sent a notification to your device. Just tap it, log in, check the details and that you're happy to continue. The notification will expire in 2 minutes.</p><br> <b-button id='noNotificationActionBtn1' ng-click='onIssueBtnClick()' name='issueButton' class='btn-primary btn-sm auto-width mt-0' aria-live='off' value='Didn&#39t get our notification?' analytics-Tag analytics-label='CheckYourNotificationCentre'></b-button></div>"},c.notificationAlertTemplateData={alertmessage:"<h2 class='alert-heading'>Check the device you're registered for the app on</h2>",additionalcontent:"<div><p class='mt-24' id='checkDeviceAlert2'>We've sent a notification to the device you're registered for the app on. To confirm your identity:</p><ol class='ordered-list'><li>Tap the notification on your mobile device - it will expire after 2 minutes.</li><li>You'll be asked to login after tapping the notification.</li><li>Once logged in. Check the details and approve the request - if you're happy to.</li><li>Return to this page and tap <strong>I've confirmed my ID below</strong> to continue</li></ol><p class='mt-24'>If notifications are disabled on your device, you'll need to first login to the app and tap the bell icon in the top right corner to check and approve the request</p><br> <b-button id='confirmationBtn' ng-click='onConfirmIdentity()' name='confirmButton' class='btn-primary btn-sm auto-width mt-0 mb-15' value='I&#39;ve confirmed this' aria-live='off' analytics-Tag analytics-label='ConfirmButton'></b-button><br> <b-button id='noNotificationActionBtn2' ng-click='onIssueBtnClick()' aria-live='off' name='issueButton' class='btn-secondary btn-sm auto-width mt-0' value='Didn&#39t get our notification?' analytics-Tag analytics-label='DidntGetNotification'></b-button></div>"},c.errorAlertTemplateData={alertmessage:"<h3 class='alert-heading'>80222 – We're waiting for you to answer the notification we sent</h3>",additionalcontent:"<div><p class='mt-24' id='alertError'>Just confirm or decline it in the Barclays app.</p></div>"},c.browser={valid:!0},c.loadBrowserAlert=!0;c.showErrorOnSamePage=function(a){angular.forEach(a.header.messages,function(a){null===a.type&&"header"==a.location&&a.code===q.VAR.TA_SERVER_ERROR_CODE&&(c.pushNotificationError=l(a),h(function(){c.hasPushNotifError=!0,c.shouldSendNotification=!0,c.hasSentNotification=!1,c.hasCheckNotification=!1,c.hasTrouble=!1,c.hasResentNotification=!1},50))})},c.routeOnError=function(d){c.showIssueBtn=!1;var f=!0;d.header.messages?angular.forEach(d.header.messages,function(g){"SELF_SERVE_UNLOCK"===g.type?(a.errorPageRedirect=!0,a.selfServeLockedError=d,n.changeView(q.VIEWS.selfServeMemLockedOut),f=!1):"MEMBERSHIP_UNLOCK"===g.type||"LOCKED"===g.type?(a.errorPageRedirect=!0,a.contentResponse.errorJSON=d,a.lockedOut=!0,n.changeView(q.VIEWS.lockedOut),f=!1):"DFA_LOCK_OUT_SFA"===g.type?(a.contentResponse.errorJSON={},a.userData.data.lockedMethods=new Array,a.userData.data.lockedMethods[0]="SFA",angular.forEach(a.userData.data.authenticationTokenSpecificationList,function(b,c){"SFA"===b.method&&a.userData.data.authenticationTokenSpecificationList.splice(c,1)}),"SFA"===a.userData.data.defaultAuthenticationMethod&&(1===a.userData.data.authenticationTokenSpecificationList.length?a.userData.data.defaultAuthenticationMethod=a.userData.data.authenticationTokenSpecificationList[0].method:a.userData.data.defaultAuthenticationMethod="TFA"),b.reload(),f=!1):"UNLOCK"===g.type?(a.serviceError=!0,a.contentResponse.errorJSON=d,a.userData.dateOfBirth=null,a.userData.cardNumber=null,e.getResetViaSMSSwitch(),f=!1):null===g.type&&"header"==g.location&&m(g)?(c.pushNotificationError=l(g),h(function(){c.hasPushNotifError=!0,c.shouldSendNotification=!0,c.hasSentNotification=!1,c.hasCheckNotification=!1,c.hasTrouble=!1,c.hasResentNotification=!1,c.showIssueBtn=!1},50),f=!1):null!==g.type||"header"!=g.location||m(g)||(f=!0)}):d.type&&"CONTEXTUAL_EXCEPTION"===d.type&&(f=!0),f&&(a.serviceError=!0,a.userData={},a.contentResponse.errorJSON=d,n.changeView(q.VIEWS.identification))},o.isEmpty(a.userData)?n.changeView(q.VIEWS.identification):i.initiateTrustAnchorTrackingDetail(),c.$on("$destroy",function(){c.onStopPolling()}),c.onAuthFail=function(b){a.serviceError=!0,a.contentResponse.errorJSON=responseData,n.changeView(q.VIEWS.identification)},c.onStopPolling=function(){g.stopPolling()},c.onAuthenticationSuccess=function(b){"INTERSTITIAL"===b.body.redirectToken.type?b.body.redirectToken.displayTypeCode?(a.interstitial={},a.interstitial.displayTypeCode=b.body.redirectToken.displayTypeCode,n.changeView(q.VIEWS.interstitial)):!0===b.body.redirectToken.dynamicInterstitialEligible&&"CHANNELAPP"===b.body.redirectToken.appName?(a.$broadcast("loader_on"),window.location.href=b.body.redirectToken.dynamicInterstitialAddress):!0===b.body.redirectToken.dynamicInterstitialEligible&&(a.interstitial={},a.interstitial.dyanmicInterstitialAddress=b.body.redirectToken.dynamicInterstitialAddress,a.interstitial.appName=b.body.redirectToken.appName,n.changeView(q.VIEWS.dynamicInterstitial)):"FEDERATION"===b.body.redirectToken.type?p.updateCCPCookie(b.body.verificationToken.membershipNumber).then(function(c){a.$broadcast("loader_on"),window.location.href=b.body.redirectToken.url+"?REF="+b.body.redirectToken.referenceId}):(a.$broadcast("loader_on"),window.location.href=b.body.redirectToken.url)},c.checkRememberMe=function(a){var b=o.setRememberMeInfoPostAuthentication(a);b&&b.rememberMeDVOs&&b.rememberMeDVOs.length>0?o.apiService(q.JSON.rememberUser,b).then(function(b){c.onAuthenticationSuccess(a)}):c.onAuthenticationSuccess(a)},c.checkTrustAnchorEligibility=function(){o.apiService(q.JSON.identifyTrustAnchor,{}).then(function(a){a.body.trustAnchorIdentificationToken.trustAnchorEligible?(c.shouldSendNotification=!0,c.hasSentNotification=!1,c.hasCheckNotification=!1,c.hasTrouble=!1,c.hasResentNotification=!1):c.onAuthenticationFailed()},function(a){this.authenticationFailed()})},c.startAgainBtnClick=function(){i.getTrustAnchorTrackingDetail(),c.showIssueBtn=!1,c.onStartAgain(),c.sendNotificationClicked=!1},c.onStartAgain=function(){c.onStopPolling(),c.shouldSendNotification=!0,c.hasSentNotification=!1,c.hasCheckNotification=!1,c.hasTrouble=!1,c.hasResentNotification=!1,c.hasPolling=!0,c.sendNotificationClicked=!1,h(function(){document.getElementById("sendNotification").focus()},10)},c.onStartPolling=function(b){g.postPollingApiRequest(q.JSON.pushNotificationAuthenticationVerification,{},b).then(function(b){c.hasPushNotifError=!1,b.errorCode?b.errorCode&&(c.onStopPolling(),c.routeOnError(b)):!1===b.header.stopFlow?b.body.success?(c.onStopPolling(),c.checkRememberMe(b),a.userData.data=b.body):b.body.success?c.onStartAgain():(c.onStartPolling(!1),c.showIssueBtn=!0,c.sendNotificationClicked=!1):!0===b.header.stopFlow&&80223!==b.header.messages[0].code?(c.onStopPolling(),c.routeOnError(b)):!0===b.header.stopFlow&&80223===b.header.messages[0].code&&(c.onStartPolling(!1),c.showIssueBtn=!0,c.sendNotificationClicked=!1)},function(a){c.onStartAgain()})},c.sendNotification=function(){c.sendNotificationClicked=!0,i.getTrustAnchorTrackingDetail(),o.apiService(q.JSON.sendPushNotification,{}).then(function(a){a.body&&a.body.success?(c.shouldSendNotification=!1,c.hasPushNotifError=!1,a.body.pollingSwitch?(c.onStartPolling(!0),c.hasSentNotification=!0,c.showIssueBtn=!1,c.hasPolling=!0):(c.sendNotificationClicked=!1,c.hasSentNotification=!1,c.hasPolling=!1,h(function(){document.getElementById("confirmationBtn").focus()},10))):(c.sendNotificationClicked=!1,c.routeOnError(a))},function(a){c.onAuthFail(a)})},c.onConfirmIdentity=function(){c.sendNotificationClicked=!1,o.apiService(q.JSON.pushNotificationAuthenticationVerification,{}).then(function(b){b.header.stopFlow?(c.hasPending=!1,c.hasPolling=!0,c.routeOnError(b)):b.body.success?(c.hasPending=!1,c.checkRememberMe(b),a.userData.data=b.body):b.body.success||(c.hasPending=!0)},function(a){c.onAuthFail()})},c.loginWoApp=function(){n.changeView(q.VIEWS.authentication)},c.onIssueBtnClick=function(){c.hasCheckNotification=!0,c.sendNotificationClicked=!1,h(function(){document.getElementById("stillTroubleBtn").focus()},10),i.getTrustAnchorTrackingDetail()},c.onStillTrouble=function(){c.hasTrouble=!0,h(function(){document.getElementById("resendNotificationBtn").focus()},50)},c.onResendNotification=function(){c.hasResentNotification=!0,c.hasSentNotification=!1,window.scrollTo(0,0)},c.onUseMobilePINSentry=function(){c.onStopPolling(),c.sendNotificationClicked=!1,i.getIdentificationAnalyticsData(),n.changeView(q.VIEWS.mobilePINSentry)},c.cancelBtnLabel="Back",c.cancelAuth=function(){var a=document.cookie.split("assist2=")[1];if(a&&a.split("&").length-1!=0){return a.split("&").length<=2?(n.changeView(q.VIEWS.identification),!0):(n.changeView(q.VIEWS.rememberMe),!0)}window.history.back()},a.lockedOut=!1,a.forgotMembership=!1,a.forgotPasscode=!1,a.forgotPasscodeSuccess=!1,a.loginMultipleMemDetails=!1,a.loginMultipleMem=!1,a.isMultipleLoginFlag=!1,a.step=1,c.$watch("browser.valid",function(){c.browser.valid}),c.wealthUserHelpContent=function(b){window.wealthValue&&window.wealthSwitch?o.apiService(q.JSON.LoginWealthHelpContent).then(function(b){if(b)try{c.faqContent=o.setFaqContent(b),a.faqContent=c.faqContent}catch(a){}}):window.privateBankValue&&window.privateBankSwitch?o.apiService(q.JSON.LoginPrvBnkHelpContent).then(function(b){if(b)try{c.faqContent=o.setFaqContent(b),a.faqContent=c.faqContent}catch(a){}}):c.faqContent=o.setFaqContent(b)},o.apiService(q.JSON.loginStep1NoSavedMember).then(function(b){b&&(b.contentContainer&&(angular.forEach(b.contentContainer.content.snippets,function(a,b){a.content=a.content.replace("https://bank.barclays.co.uk/olb/auth/InternetCookies.action?authECN=true","#/cookiePref")}),a.cookieSnippets=b.contentContainer.content.snippets),c.contentResponse=b,c.FTBLogin_rememberMe_warning_message="",c.contentResponse.contentContainer.content.snippets.hasOwnProperty("FTBLogin_rememberMe_warning_message")&&(c.FTBLogin_rememberMe_warning_message=c.contentResponse.contentContainer.content.snippets.FTBLogin_rememberMe_warning_message.content.replace("<p>","").replace("</p>","")),c.wealthUserHelpContent(b),a.step1StopFlow&&(a.serviceError=!0,a.contentResponse.errorJSON=a.step1StopFlow,a.step1StopFlow=!1))}),c.mobileView=e.isMobileView(),window.onresize=function(){c.mobileView=e.isMobileView(),c.$apply()}}])}(),function(){"use strict";var a=function(a,b,c){return{restrict:"E",scope:!0,templateUrl:a("/directivesTemplate/accountTypeDropDown.html"),link:function(a){var d=c.get("CONSTANT");a.retrieveAccountTypes=function(){b.apiService(d.JSON.retrieveAccountTypes).then(function(c){a.accountTypeListAvailable=!0,c.body.listOfAccountTypes.forEach(function(b){a.model.accountType.accounts.push({id:b.value,accountId:b.value,accountName:b.label})}),a.model.accountType.accounts.sort(b.sortAccountTypes)})},!0===window.isSolusSwitch&&!0===window.siCredentialResetSwitch&&a.retrieveAccountTypes()}}};a.$inject=["partial","services","$injector"],angular.module("appBdlLogin.directives").directive("accountTypeDropDown",a)}(),function(){"use strict";var a=function(a){return{restrict:"E",scope:!0,templateUrl:a("/directivesTemplate/errorMessagesClient.html"),link:function(a){var b,c,d,e,f,g;a.multiInputElements=["mobilePinsentryCode","memorableCharacters","solusAccountNumber","sortCode","dateOfBirth","settlementAccSortcode"];var h=["mobilePinsentryCode","lastDigits","verificationCode"],i=["confirmation"];a.errorCountCallbackFn=function(b){a.headerContent=b>1?"You have "+b+" errors to correct before you can proceed":"You have "+b+" error to correct before you can proceed"},a.globalErrorCallbackFn=function(j){c=document.querySelector('[name="'+a.globalErrorFormName+'"]'),e=c.querySelector('[name="'+j+'"]'),f=e.id,a.multiInputElements.includes(j)||i.includes(j)?(d=e,b=$(e).find("input")[0]):(d=$(e).closest('div[class^="form-item"]')[0],b=e),h.includes(j)&&(g=document.querySelector("label[for='"+f+"']"))&&(d=g.parentNode),b&&b.focus(),d&&d.scrollIntoView()}}}};a.$inject=["partial"],angular.module("appBdlLogin.directives").directive("authClientErrorMessages",a)}(),function(){"use strict";angular.module("appBdlLogin.directives").directive("authServerErrorMessages",["$compile","partial","$rootScope","siteTrackingService","CONSTANT","$window",function(a,b,c,d,e,f){return{restrict:"A",replace:!0,link:function(a,b,e){c.$watch("contentResponse.errorJSON",function(b){try{if(c.contentResponse&&c.contentResponse.errorJSON){var e={headerErrors:{}},f=[],g=0,h=c.contentResponse.errorJSON.header.messages;e.headerErrors=[];var i=[],j=[];if(a.errorType="error",angular.forEach(h,function(b,c){i.push(b.code);var d=angular.lowercase(b.level);"info"!==d&&"success"!==d&&j.push(b.code),-1===f.indexOf(d)&&(f.push(d),e.headerErrors[d]=[]),"header"!==b.location?b.hasOwnProperty("location")&&a.model.hasOwnProperty(b.location)&&(a.model[b.location].valid=!1,a.model[b.location].error.push(b.text)):(e.headerErrors[d].push(b),g++)}),c.errorPageRedirect?(d.setErrorCode(j.join("|")),c.errorPageRedirect=!1):c.serviceError&&(d.tagErrorCodeEvent(j.join("|")),c.serviceError=!1),"undefined"!==c.contentResponse.errorJSON){if(e.headerErrors.errorLength=g,a.serverErrorMessagesObj=e,e.headerErrors.error)for(var k=0;k<e.headerErrors.error.length;k++)"505"==e.headerErrors.error[k].code||"504"==e.headerErrors.error[k].code?(a.errorType="info",e.headerErrors.error[k].HTMLContent={alertmessage:"<p>"+e.headerErrors.error[k].text+"("+e.headerErrors.error[k].code+")</p>"}):(a.errorType="error",e.headerErrors.error[k].HTMLContent={alertmessage:"<p> Error Code: "+e.headerErrors.error[k].code+" <br><br>"+e.headerErrors.error[k].text+"</p>"});if(e.headerErrors.warning)for(var k=0;k<e.headerErrors.warning.length;k++){var l=a.webChatErr(e.headerErrors.warning[k]);"505"==e.headerErrors.warning[k].code||"504"==e.headerErrors.warning[k].code?(a.errorType="info",e.headerErrors.warning[k].HTMLContent={alertmessage:"<p>"+e.headerErrors.warning[k].text+"("+e.headerErrors.warning[k].code+")</p>"}):(a.errorType="error",e.headerErrors.warning[k].HTMLContent={alertmessage:"<p> Error Code: "+e.headerErrors.warning[k].code+" <br><br>"+e.headerErrors.warning[k].text+l+"</p>"})}if(e.headerErrors.alert)for(var k=0;k<e.headerErrors.alert.length;k++)e.headerErrors.alert[k].HTMLContent={alertmessage:"<p> Error Code: "+e.headerErrors.alert[k].code+" <br><br>"+e.headerErrors.alert[k].text+"</p>"}}}}catch(a){}}),a.webchat=a.webchat||{},a.webchat.Prompt=function(){a.webchat.promptCloseHandler(),a.webchat.chatWindowClickHandler()},a.webchat.promptCloseHandler=function(){$(document.querySelector(".chat-prompt .no-chat")).bind("click",function(a){this.getHandler(this.hideChatPrompt)})},a.webchat.chatWindowClickHandler=function(){$(document.querySelector(".webchat-link-new")).bind("click",function(b){if(window.asyncChatSwitch)window.asyncChat.chatService.startChat("login errors");else if(window.webChatSwitch){var c=$(b.target).attr("href"),d=$(b.target).attr("data-errCode"),e=d,f="BarclaysChat",g=600,h=510,i=screen.width/2-g/2,j=screen.height/2-h/2;window.open(c,f,"width="+g+",height="+h+",top="+j+",left="+i+",scrollbars=no,menubar=no,toolbar=no,resizable=yes,location=yes,status=yes"),b.preventDefault(),$(b.target).hasClass("webchat-link-new")?a.webchat.chatWebtrends_New(c,e):a.webchat.chatWebtrends()}})},a.webchat.showChatPrompt=function(a){var b=$(".chat-prompt");b.html(a),b.show()},a.webchat.hideChatPrompt=function(){$(".chat-prompt").hide()},a.webchat.getHandler=function(a){var b=this;return function(){a.apply(b,arguments)}},a.webchat.chatWebtrends=function(){},a.webchat.chatWebtrends_New=function(a,b){},a.webChatErr=function(a){return a.webChatErrFlag=!1,null!=a.data&&a.data.webchatonerror&&a.data.unSecWebChatURL&&(1120===a.code||1121===a.code||30927===a.code||30928===a.code||30941===a.code||30915===a.code||30803===a.code)&&1===a.data.toShow?(a.webChatErrFlag=!0,window.asyncChatSwitch?'<div ng-init="webchat.Prompt()"></div><br/><div><b-text class="topSpace" id="helpDecoration" type="div" b-data="<strong>Need more help?</strong>"></b-text> <b-link id="href-webchat" class="meta(type=ExternalLink) button btn btn-primary webchat-link-new topSpace" href="javascript:void(0)" data-errCode="{{error.data.errorCode}}" analytics-Tag><a href="javascript:void(0)" class="icon icon-chat"></a><a class="btn-icon-text" href="javascript:void(0)">Message us</a></b-link></div> <div class="chat-prompt"></div>':window.webChatSwitch?'<div ng-init="webchat.Prompt()"></div><br/><div><b-text class="topSpace" id="helpDecoration" type="div" b-data="<strong>Need more help?</strong>"></b-text> <b-link id="href-webchat" class="meta(type=ExternalLink) button btn btn-primary webchat-link-new topSpace" href="{{error.data.unSecWebChatURL}}" data-errCode="{{error.data.errorCode}}" analytics-Tag><a href="{{error.data.unSecWebChatURL}}" class="icon icon-chat"></a><a class="btn-icon-text" href="{{error.data.unSecWebChatURL}}">Launch Web chat</a></b-link></div> <div class="chat-prompt"></div>':""):""}},templateUrl:b("error-messages-backend.html")}}])}(),function(){"use strict";var a=function(a){return{restrict:"A",link:function(b,c,d){c.bind("click",function(){a.history.back()})}}};a.$inject=["$window"],angular.module("appBdlLogin.directives").directive("backButton",a)}(),function(){"use strict";var a=function(a,b,c,d,e,f){return{restrict:"E",require:"^form",link:function(a,g,h,i){a.confirmBrowserAlertChecked=[],a.browser.valid=!1,a.confirmBrowser=function(){var b,d;b="advisedBrand"===a.state?"WARNING_UNSUPPORTED_BROWSER":"WARNING_NON_RECOMMENDED_VERSION",d=e.membershipNumber?e.membershipNumber:"UNKNOWN",0===a.confirmBrowserAlertChecked.length?(i.showErrorsIfAny=!0,a.confirmChecked=!1):(i.showErrorsIfAny=!1,a.confirmChecked=!0),a.confirmChecked&&(c.setCookie("browserAccessCookie","membershipNumber#"+d+" + warningType#"+b+"+warningCount#1+warningAcknowledged#true"),a.browser.valid=!0)},a.showBrowserConsolidationMessage=function(b,d,e,f,g){var h="<div><div ng-class=\"{'hidden':!closeStep1Panel}\">"+b+'</div><div class="mb-24" ng-class="{\'hidden\':closeStep1Panel}">'+d+"</div>";f&&(h+='<div ng-if="!confirmChecked"><b-check class="checkboxWidth" id="checkboxBrowserAlert" name="browserAlertConfirmation" ng-model="confirmBrowserAlertChecked" data="browserAlertCheckBoxLabel" arrange="controls-stacked" value-field="value" display-field="display" analytics-Tag mca-validator="AppName.Module.browserAlertCheckValidation | ngModel"> </b-check><div class="marginBtnAlert"><b-button name="updateBrowser"   value="Update browser"  ng-click="updateBtnClick()"  class="btn-secondary" aria-label="Update browser" analytics-Tag></b-button><b-button value="Continue to login"  ng-click="confirmBrowser()" name="ContinueToLogin"  class="btn-primary alertBtnMarginSpace" aria-label="Continue to login" analytics-Tag></b-button></div></div>'),f||(h+='<div><div class="marginBtnAlert"><b-button value="Back to homepage" ng-click="backToHomePage()" name="backToHomepage" class="btn-secondary" aria-label="Back To Homepage" analytics-Tag></b-button><b-button value="Update browser" ng-click="updateBtnClick()"  name="updateBrowser" class="btn-primary alertBtnMarginSpace" analytics-Tag></b-button></div></div>',h+="</div>"),a.content={display:!0,browserAlertContent:{alertmessage:'<div class="browserbottomImp alert-heading">Browser Alert </div>',additionalcontent:h}},c.getCookie("browserAccessCookie")&&(a.browser.valid="rejected"!==g&&"rejectedBrand"!==g)},a.updateBtnClick=function(){location.href="http://www.barclays.co.uk/PersonalBanking/P1242684821625"},a.backToHomePage=function(){location.href=d.URL.BarclaysHomePage},a.confirmCheckedClick=function(b){a.confirmChecked=!b},b.browserAlert().then(function(e){a.state=e;var g="",h=!1;if("advised"===e&&(g="State_1",h=!0,f.setBrowserAlertAnalyticsTag("old")),"advisedBrand"===e&&(g="State_3",h=!0,f.setBrowserAlertAnalyticsTag("old")),"rejected"===e&&(g="State_2",f.setBrowserAlertAnalyticsTag("Unsupported")),"rejectedBrand"===e&&(g="State_4",f.setBrowserAlertAnalyticsTag("Unsupported")),a.confirmation=!1,a.confirmChecked=!1,c.getCookie("browserAccessCookie")?"rejected"!==e&&"rejectedBrand"!==e&&(a.browser.valid=!0,h=!1):a.browser.valid="approved"===e,"approved"!==e){var i="I understand that my current browser may affect my Online Banking experience.";b.apiService(d.JSON.LoginLinkDisplayBrowserAlert).then(function(c){if(c&&c.contentContainer&&c.contentContainer.content&&!b.isEmpty(c.contentContainer.content.snippets)){i=c.contentContainer.content.snippets.FTBLoginLinkCB_ack_label.content,i&&(i=i.replace(/(<([^>]+)>)/gi,""));var d=b.setBrowserConsolidationMessage(g,c),f=d[0],j=d[1];a.showBrowserConsolidationMessage(f,j,i,h,e)}else a.showBrowserConsolidationMessage(b.getBrowserInformation()[0],b.getBrowserInformation()[0],i,h,e);a.browserAlertCheckBoxLabel=[{value:"Y",display:i,disabled:!1}]})}})},templateUrl:a("browserAlert.html")}};a.$inject=["partial","services","cookieService","CONSTANT","$rootScope","siteAnalyticsUtilService"],angular.module("appBdlLogin.directives").directive("browserAlert",a)}(),function(){"use strict";var a=function(a,b,c){return{restrict:"E",scope:!0,templateUrl:b("/directivesTemplate/cardNumber.html"),link:function(a,b,d){a.validateCardNumber=function(){a.model.cardNumber.value=c.formatCardNumber(a.model.cardNumber)}}}};a.$inject=["$rootScope","partial","authLoginUtilService"],angular.module("appBdlLogin.directives").directive("cardNumber",a)}(),function(){"use strict";angular.module("appBdlLogin.directives").directive("cookiePolicy",["partial","snippetServices","$rootScope","$injector","cookieService","siteTrackingService",function(a,b,c,d,e,f){return{restrict:"AE",scope:!0,link:function(a){a.$watch("contentResponse",function(){try{a.contentResponse&&b.setSnippetContent().then(function(){var b=c.snippetName;if(a.alertWarning=!1,["BDL_FTBLogin_cookie_OneTime_Decoupled_Wlb","BDL_FTBLogin_cookie_OneTime_Decoupled","FTBLogin_cookie_Repeat_Decoupled_Wlb","FTBLogin_cookie_Repeat_Decoupled","FTBLogin_cookie_CarryForward_Decoupled_Wlb","FTBLogin_cookie_CarryForward_Decoupled"].includes(b)?a.alertWarning=!0:a.alertWarning=!1,b&&c.cookieSnippets){a.cookieSnippetContent=c.cookieSnippets[b].content.split("</p>");for(var d=0;d<a.cookieSnippetContent-1;d++)a.cookieSnippetContent[d]=a.cookieSnippetContent[d]+"</p>";a.cookieSnippetContentHeading="<div class='alert-heading'>"+a.cookieSnippetContent[0]+"</div>";var e=" ";a.alertWarning&&(e='<div class="marginBtnAlert"><b-button value="Accept and close" ng-click="acceptBtnClick()" name="acceptAndClose" class="btn btn-primary" aria-label="Accept and Close cookies" analytics-Tag></b-button></div></section>'),a.cookieSnippetContentDes='<section class="browser-alert">'+a.cookieSnippetContent.slice(1,a.cookieSnippetContent.length-1).join("")+e,a.content={display:!0,cookieContent:{alertmessage:a.cookieSnippetContentHeading,additionalcontent:a.cookieSnippetContentDes}},f.tagAlertsOnPage("OurCookiePolicy")}})}catch(a){}a.acceptBtnClick=function(){var b=d.get("$filter"),c=b("date")(new Date,"dd/MM/yyyy+H:mm ");c=e.getCookie("CCP")?JSON.parse(decodeURIComponent(e.getCookie("CCP"))):{};var f={},g="on";f.publicuser={},f.publicuser.cat2=g,f.publicuser.cat3=g,f.publicuser.cat4=g,f.publicuser.catStamp=b("date")(new Date,"dd/MM/yyyy+H:mm "),f.publicuser.createStamp=b("date")(new Date,"dd/MM/yyyy+H:mm "),c=angular.extend({},c,f),e.setEncodedCookie("CCP",JSON.stringify(c),7300),e.setEncodedCookie("CCP_OTM",1),a.content={display:!1,cookieContent:{}}}})},templateUrl:a("cookiePolicyAlert.html")}}])}(),function(){"use strict";var a=function(a,b,c){return{restrict:"E",scope:!0,templateUrl:a("/directivesTemplate/countryDropDown.html"),link:function(a){var d=c.get("CONSTANT");a.retrieveCountryList=function(){b.apiService(d.JSON.retrieveCountryList).then(function(b){a.model.countryList.countries.push({id:-1,value:-1,label:"Please select"}),b.body.listOfCountries.forEach(function(b){a.model.countryList.countries.push({id:b.value,value:b.value,label:b.label})})})},!0===window.isSolusSwitch&&!0===window.siCredentialResetSwitch&&a.retrieveCountryList()}}};a.$inject=["partial","services","$injector"],angular.module("appBdlLogin.directives").directive("countryDropDown",a)}(),function(){"use strict";var a=function(a){return{restrict:"E",scope:!0,templateUrl:a("/directivesTemplate/dateOfBirth.html"),controller:["$scope",function(a){var b=16,c=new Date;a.startYear="01/01/"+(c.getFullYear()-b-100),a.endYear="31/12/"+(c.getFullYear()-b),a.additionalDateData="<p>E.g. 08 12 1980</p>"}]}};a.$inject=["partial"],angular.module("appBdlLogin.directives").directive("dateOfBirth",a)}(),function(){"use strict";angular.module("appBdlLogin.directives").directive("faq",["partial","$rootScope","CONSTANT",function(a,b,c){return{restrict:"E",scope:{faqContent:"="},link:function(a){a.templates=[],void 0!==a.faqContent&&(b.faqContent&&(a.faqContent=b.faqContent),angular.forEach(a.faqContent.contents,function(b){a.templates.push({heading:b.header,noTemplate:!0,content:b.content})})),a.needHelp=function(){var a;a=window.wealthSwitch&&window.wealthValue?c.URL.NeedMoreHelpWintc:window.privateBankValue&&window.privateBankSwitch?c.URL.NeedMoreHelpPbc:c.URL.NeedMoreHelp,window.open(a,"_blank")}},templateUrl:a("helpCards.html")}}])}(),function(){"use strict";angular.module("appBdlLogin.directives").directive("headerContent",["partial","$injector",function(a,b){return{restrict:"E",scope:!0,link:function(a){var c=b.get("CONSTANT");a.privateBankHeader=!1,a.wealthInternationalHeader=!1,a.defaultHeader=!0,a.wealthCheck=!1,a.registrationURL=c.URL.registrationURL,a.wealthRequestParam="?"+c.RequestParameters.WealthParameter+"="+window.wealthType+c.ViewRouteTo.decoupledSpeedyRegStep1,window.serviceStatusSwitch&&(a.serviceStatusSwitch=window.serviceStatusSwitch),a.headingContent="How would you like to log in?",a.headerUrlContent="Not registered for Online Banking?",a.headerUrlLinkContent="Register now",a.registrationURL=c.URL.decoupledRegistrationURL,window.wealthValue&&window.wealthSwitch?(a.registrationURL=c.URL.decoupledRegistrationURL+a.wealthRequestParam,a.wealthCheck=!0,"wintc"===window.wealthType&&(a.wealthInternationalHeader=!0,a.defaultHeader=!1,a.privateBankHeader=!1)):window.privateBankValue&&window.privateBankSwitch&&(a.registrationURL=c.URL.decoupledRegistrationURL+a.wealthRequestParam,a.headingContent="Our online service gives you secure and immediate access to all of your personal financial information held by Barclays UK, all in one place.",a.headerUrlContent="First time user?",a.headerUrlLinkContent="Register using your SpeedyReg code",a.wealthCheck=!0,"pbc"===window.wealthType&&(a.privateBankHeader=!0,a.defaultHeader=!1,a.wealthInternationalHeader=!1))},templateUrl:a("headerContent.html")}}])}(),function(){"use strict";var a=function(a,b,c,d,e,f){return{restrict:"E",replace:!0,templateUrl:b("authLoginHero.html"),link:function(b,g,h){if(b.showUserInfo=JSON.parse(h.showUserInfo),b.authDataUser={},b.authLoginHeroBackButton=!1,"/forgotPasscodeDetails"===d.path()||"/forgotPasscodeConfirm"===d.path()||"/forgotPasscodeReset"===d.path()||"/forgotPasscodeVerificationCode"===d.path()||"/forgotPasscodeDeliveryMethodSelection"===d.path()?(b.authLoginHeroTitle="Request a passcode",b.authLoginHeroTagline="Get your new passcode by text or in the post"):"/cookiePref"===d.path()?b.authLoginHeroTitle="Enhanced Cookies Notice":"/forgotMembership"===d.path()?(b.authLoginHeroTitle="Don't know your membership number?",b.authLoginHeroTagline="Access your account in a few steps"):"/selfServeMemUnlockUserDetails"===d.path()||"/selfServeMemUnlockOtpAuth"===d.path()?b.authLoginHeroTitle="Unlock your membership":(b.authLoginHeroTitle="Log in to Online Banking",b.authLoginHeroTagline=""),!_.isEmpty(a.userData)){var i="",j=a.userData.surname.charAt(0).toUpperCase()+a.userData.surname.slice(1).toLowerCase();a.userData.surname=j,"membership"===a.userData.loginType?i=a.userData.membershipNum:"sortCode"===a.userData.loginType?i=a.userData.sortCodeMasked+"    "+a.userData.accountNumberMasked:"cardNumber"===a.userData.loginType&&(i=a.userData.cardNumberMasked)}b.switchUserClick=function(){a.contentResponse.errorJSON={},a.differentUser=!0,b.linkText="switchUser",e.changeView(c.VIEWS.identification)},b.forgotDetailsClick=function(){b.linkText="forgotUser",f.forgetUser(a.userData.membershipNum)},b.heroLinkClick=function(a,b){a.preventDefault(),b.click()},b.heroDDAtextGenerator=function(){if(b.showUserInfo&&!_.isEmpty(a.userData)){if("membership"===a.userData.loginType)return"Membership Number displayed "+a.userData.membershipNum;if("sortCode"===a.userData.loginType)return"Sort code "+a.userData.sortCodeMasked+"  account number ending in "+a.userData.accountNumberMasked.substr(4);if("cardNumber"===a.userData.loginType)return"Card number ending in "+a.userData.cardNumberMasked.substr(15)}return""},b.authDataUser={userinformation:{iconType:"user",username:j,useraccount:{number:i,ddaRead:b.heroDDAtextGenerator()},links:[{text:"Switch user",url:"#",click:b.switchUserClick}]},title:b.authLoginHeroTitle,tagline:b.authLoginHeroTagline,display:!0},a.authForgetId&&b.authDataUser.userinformation.links.push({text:"Forget my details",url:"#",ddaRead:"This link will naviagte you to the forgotten details page",click:b.forgotDetailsClick})}}};a.$inject=["$rootScope","partial","CONSTANT","$location","secureRoute","services"],angular.module("appBdlLogin.directives").directive("hero",a)}(),function(){"use strict";var a=function(a,b,c,d){return{scope:{extraParams:"=params"},restrict:"E",compile:function(e,f){e.html("");var g=d.get("CONSTANT");return function(d,e){d.$destroy(),a({method:"GET",url:f.src}).success(function(a){var d=document.createElement("div");d.innerHTML=a;var h=[];d.querySelectorAll("script").forEach(function(a){if(!a.innerHTML&&-1===a.getAttribute("src").indexOf("polyfill.min.js")){var b=c.defer(),d=document.createElement("script");d.onload=function(){b.resolve()},d.onerror=function(a){b.reject(a)},h.push(b.promise),e.append(d),d.src=a.getAttribute("src")}}),c.all(h).then(function(){b(function(){$(d).find("script").remove(),angular.bootstrap(d,[f.appName]),e.append(d)})}).error(function(){window.location.href=g.URL.BTRHome})})}}}};a.$inject=["$http","$timeout","$q","$injector"],angular.module("appBdlLogin.directives").directive("ngIsolatedApp",a)}(),function(){"use strict";var a=function(a){return{restrict:"E",scope:!0,templateUrl:a("/directivesTemplate/mortgageAccount.html"),link:function(a,b,c){a.tooltipRefId=c.tooltipRefId}}};a.$inject=["partial"],angular.module("appBdlLogin.directives").directive("mortgageAccount",a)}(),function(){"use strict";var a=function(a,b,c){return{restrict:"E",scope:!0,templateUrl:a("/directivesTemplate/securityCode.html")}};a.$inject=["partial","services","$injector"],angular.module("appBdlLogin.directives").directive("securityCode",a)}(),function(){angular.module("appBdlLogin.directives").directive("analyticsTag",["siteTrackingService","$rootScope",function(a,b){return{restrict:"A",link:function(b,c){a.bindTrackEvent(c,b)}}}])}(),function(){"use strict";var a=function(a){return{restrict:"E",link:function(b,c,d){b.$watch("contentResponse",function(){try{if(b.contentResponse){var e=b.contentResponse.contentContainer.content.snippets[d.refId];if(!_.isNil(e)){var f,g=void 0!==d.classNames?d.classNames:"",h=void 0!==d.type?d.type:"p",i=void 0!==d.id?d.id:_.camelCase(d.refId),j=void 0===d.useBtext||JSON.parse(d.useBtext);f=j?$('<b-text id="'+i+'" class="'+g+'" type="'+h+'" b-data="'+e.content+'" ></b-text>'):$('<div id="'+i+'">'+e.content+"</div>"),c.append(f),a(f)(b)}}}catch(a){}})}}};a.$inject=["$compile"],angular.module("appBdlLogin.directives").directive("bdlSnippetContent",a)}(),function(){"use strict";var a=function(a){return{restrict:"E",scope:!0,templateUrl:a("/directivesTemplate/solusAccountNumber.html"),link:function(a,b,c){a.tooltipRefId=c.tooltipRefId}}};a.$inject=["partial"],angular.module("appBdlLogin.directives").directive("solusAccountNumber",a)}();var authloginDigitalData={digitalData:{page:{pageInfo:{},deepLink:{},error:{},searchInfo:{}},user:{ccp:{},login:{},accountsHeld:{}},events:[]},init:function(){if(this.newPage(),this.getPageInfo(),this.getPageAndEventAttributes(),this.getDeviceBuildID(),this.getUserInfo(),this.digitalData.page.error.code=this.getErrorInfo(),this.digitalData.page.error.formFields=this.getEventErrorFormFields(),this.digitalData.page.error.code||(this.digitalData.page.error.code=this.getEventErrorCode()),this.getCookieInfo(),this.getUrlInfo(),this.getBrowserInfo(),this.getLoginInfo(),this.clickEventHandler(),this.changeEventHandler(),window.flatDigitalDataEnable){var a=authloginDigitalData.getNewEventObject("screenload");this.createFlatDataObject(a)}},newPage:function(){var a={pageInfo:{},deepLink:{},error:{},searchInfo:{}};this.digitalData.page,this.digitalData.page=a,this.digitalData.events,this.digitalData.events=[]},getPageInfo:function(){var a,b=window.digitalDataPageName,c=this.digitalData.page.pageInfo;c.pageName=this.authloginAppManager.getPageName(b),c.pageName&&(a=c.pageName.split(/[\-:]/),this.authloginAppManager.getPageLevels(c,a)),c.timeStamp=(new Date).toISOString(),c.timeStampUnix=Math.round((new Date).getTime()/1e3)},getUserInfo:function(){var a,b,c=this.digitalData.user;a=document.getElementsByName("WT.seg_2"),a.length&&(c.customerSegment=a[0].content),this.authloginAppManager.getAccountsHeld(c),this.authloginAppManager.getNewOrReturningCustomer(c),b="membershipNum0","Step2ConfirmYourID"===this.digitalData.page.pageInfo.level4&&this.authloginAppManager.getLoginDetails(c,b)},getErrorInfo:function(){var a;return window.digitalDataErrorCode&&(a=window.digitalDataErrorCode),a},getUrlInfo:function(){var a=this.digitalData.page,b=a.pageInfo;this.authloginAppManager.getUrlProtocol(b),this.authloginAppManager.getUrlHost(b),this.authloginAppManager.getUrlPath(b),this.authloginAppManager.getReferringUrl(b),this.authloginAppManager.getUrlQueryStringAndUrlHash(a),window.digitalData=this.digitalData},getCookieInfo:function(){this.digitalData.page.deepLink.start=this.getCookie("d="),this.digitalData.user.newOrReturning=void 0!==this.getCookie("CCP=")?"Returning":"New"},getBrowserInfo:function(){var a=this.digitalData.page;a.osVersion=this.detectOSVersion(),a.currentOs=this.detectCurrentOS(),a.userBrowser=this.detectUserBrowser(),a.deviceType=this.detectDeviceType()},getLoginInfo:function(){var a=this.getCookie("default_method"),b="";switch(a){case"C":b="MembershipID";break;case"B":b="CardNumber";break;case"A":b="AccountAndSortCode"}this.digitalData.user.login.segment=b},clickEventHandler:function(){var a=this;document.addEventListener("click",function(b){var c,d,e,f,g=a.authloginDigitalDataConstants.allowedClickTags;if(-1!==g.indexOf(b.target.tagName)&&(c=!0,d=b.target.parentElement,"INPUT"===b.target.tagName&&"submit"!==b.target.type?c=!1:d&&d.getAttribute("class")&&"dropdown__label"===d.getAttribute("class")&&(c=!1)),c){var h=authloginDigitalData.getEventObject(b.target,"click");if(!1===authloginDigitalData.checkForDuplicateEvent(h,window.digitalData.events)){switch(f=authloginDigitalData.getEventLabel(b.target,"click"),h=authloginDigitalData.getSectionSubSection(h),h.eventInfo.section){case"transfers_details":switch(h.eventInfo.label){case"PINsentry":window.digitalData.user.login.method="PinSentry";break;case"Passcode and memorable word":window.digitalData.user.login.method="Passcode"}window.digitalData.user.login.route=a.authloginAppManager.getLoginRoute(window.digitalData.user.login.method)}e=window.digitalData.user.customerSegment,e&&-1!==e.indexOf(f)?(window.digitalData.user.browsingAs=f,window.digitalData.page.pageInfo.segment=f):"Home page - Barclays Online Banking"===document.title&&0===window.digitalData.events.length&&(window.digitalData.user.browsingAs=authloginDigitalData.getBrowsingSegmentInfo()),h.eventInfo.label=f,window.digitalData.page.error.code=authloginDigitalData.getErrorInfo(),window.digitalData.page.error.formFields=authloginDigitalData.getEventErrorFormFields(),window.digitalData.page.error.code||(window.digitalData.page.error.code=authloginDigitalData.getEventErrorCode()),window.digitalData.page.deepLink.start=authloginDigitalData.getCookie("d="),window.digitalData.user.newOrReturning=void 0!==authloginDigitalData.getCookie("CCP=")?"Returning":"New",window.digitalData.user.login.segment=authloginDigitalData.getCookie("default_method"),authloginDigitalData.getLoginInfo(),window.digitalData&&(window.digitalData.events.push(h),window.flatDigitalDataEnable?a.createFlatDataObject(h):(authloginDigitalData.initializeDataObject(),"undefined"!=typeof _satellite&&_satellite.track("processEvent")))}}},!0)},changeEventHandler:function(){var a=this;document.addEventListener("change",function(b){var c=authloginDigitalData.getEventObject(b.target,"change");if(!1===authloginDigitalData.checkForDuplicateEvent(c,window.digitalData.events)){switch(c.eventInfo.label=authloginDigitalData.getEventLabel(b.target,"change"),c=authloginDigitalData.getSectionSubSection(c),c.eventInfo.section){case"transfers_details":switch(c.eventInfo.label){case"PINsentry":window.digitalData.user.login.method="PinSentry";break;case"Passcode and memorable word":window.digitalData.user.login.method="Passcode"}window.digitalData.user.login.route=a.authloginAppManager.getLoginRoute(window.digitalData.user.login.method)}window.digitalData.page.error.code=authloginDigitalData.getErrorInfo(),window.digitalData.page.error.formFields=authloginDigitalData.getEventErrorFormFields(),window.digitalData.page.error.code||(window.digitalData.page.error.code=authloginDigitalData.getEventErrorCode()),window.digitalData.page.deepLink.start=authloginDigitalData.getCookie("d="),window.digitalData.user.newOrReturning=void 0!==authloginDigitalData.getCookie("CCP=")?"Returning":"New",authloginDigitalData.getLoginInfo(),window.digitalData&&(window.digitalData.events.push(c),window.flatDigitalDataEnable?a.createFlatDataObject(c):(authloginDigitalData.initializeDataObject(),"undefined"!=typeof _satellite&&_satellite.track("processEvent")))}},!0)},getCookie:function(a){var b,c,d,e,f;if(a)for(c=decodeURIComponent(document.cookie),d=c.split(";"),e=0;e<d.length;e++)if(f=d[e],0===f.trim().indexOf(a)){b=f.split("=")[1];break}return b},getCssSelectors:function(a){Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);for(var b=[];a&&a!==document;a=a.parentNode)b.push(a.tagName);return b.reverse().join(">")},getDomPath:function(a){for(var b=[];a&&a!==document;a=a.parentNode)a.id||a.name?b.push(a.id||a.name):b.push("");return b.reverse()},getDest:function(a){var b,c,d,e=a.tagName;switch(e){case"BUTTON":case"INPUT":b=a.name?a.name:a.formAction;break;case"A":"javascript:void(0)"!==a.href&&(b=a.href.split("?")[0]);break;case"SPAN":for(c=a.parentNode,d=0;d<2&&!(b=c[d]?c[d].href:void 0);d++);}return b},getMethod:function(a){var b=a.tagName;if(void 0!==a.tagName){var c=a.type;c&&(b+=" "+c)}return b},getChangeValue:function(a){var b="",c=this.authloginDigitalDataConstants.disallowedInputTags;return"INPUT"===a.tagName&&-1!==c.indexOf(a.type)||"TEXTAREA"===a.tagName?b="":a.value&&(b=a.value),b},getEventLabel:function(a,b){var c;if("change"===b)c=authloginDigitalData.getChangeLabel(a);else if(a.parentNode.getElementsByTagName("label").length)c=a.parentNode.getElementsByTagName("label")[0].innerText;else switch(a.tagName){case"BUTTON":c=a.value,""===c&&(c=a.innerHTML);break;case"LABEL":case"A":c=a.innerText}return c},getChangeLabel:function(a){var b="",c=["day","month","year"];return"INPUT"===a.tagName&&"radio"===a.type&&(-1!==c.indexOf(a.name)?b="Date of birth":-1!==a.name.indexOf("MemorableCharacter")?b=document.getElementById("label-memorableCharacters").innerText:-1!==a.name.indexOf("siAccount")?b="Account type":-1!==a.name.indexOf("country")&&(b="Country of nationality")),""===b&&(b=authloginDigitalData.parseForLabel(a)),b},parseForLabel:function(a){var b,c="",d=a;for(b=0;b<6;b++)if(d){var e=d.parentElement;if(e){var f=e.getElementsByTagName("label");if(f.length>0){c=f[0].innerText;break}}d=e}return"checkbox1"===a.id&&(c="Remember Me"),c},getPopulatedDomPath:function(a){var b,c=a.eventInfo.domPath,d=[],e=0;for(b=4;b<c.length;b++)""!==c[b]&&(d[e]=c[b],e++);return d},getSectionSubSection:function(a){var b,c,d,e=this.getPopulatedDomPath(a),f=e.length;return f>0&&(b=Math.ceil(f/2),c=e.slice(0,b),d=e.slice(f/2,f),a.eventInfo.section=c.join(":"),a.eventInfo.subSection=d.join(":")),a},getBrowsingSegmentInfo:function(){var a,b,c,d,e=window.digitalData.user.customerSegment;if(-1===e.indexOf("_"))d=e;else if(a=document.getElementById("ul#personal-business"),a.length>0)for(c=a.find("li"),b=0;b<c.length;b++)if("rgb(0, 126, 182)"===c[b].style.backgroundColor){d=c[b].innerText.trim();break}return d},getEventObject:function(a,b){return{eventInfo:{section:"",subSection:"",cssSelector:authloginDigitalData.getCssSelectors(a),domPath:authloginDigitalData.getDomPath(a),alt:"",label:"",destination:"click"===b?authloginDigitalData.getDest(a):"",method:authloginDigitalData.getMethod(a),value:authloginDigitalData.getChangeValue(a),type:b,tool:"",processed:!1,timeStamp:(new Date).toISOString(),timeStampUnix:Math.round((new Date).getTime()/1e3)}}},getNewEventObject:function(a){return{eventInfo:{section:"",subSection:"",cssSelector:"",domPath:"",alt:"",label:"",destination:"",method:"",value:"",type:a,tool:"",processed:!1,timeStamp:"",timeStampUnix:""}}},checkForDuplicateEvent:function(a,b){var c,d,e,f=b.length,g=!1;return f>0?(c=b[f-1].eventInfo,d=c.timeStampUnix,e=a.eventInfo.timeStampUnix,g=e-d<14&&c.cssSelector===a.eventInfo.cssSelector&&c.type===a.eventInfo.type):g=!1,g},createFlatDataObject:function(a){var b=this.digitalData.page.pageInfo,c=this.digitalData.page.deepLink,d=this.digitalData.page.error,e=this.digitalData.page.searchInfo,f=this.digitalData.user,g=this.digitalData.user.login,h=this.digitalData.user.accountsHeld,i=this.getCcp(),j=this.digitalData.page,k={device_build_id:b.buildVersion||"",device_os:j.currentOs||"",device_os_version:j.osVersion||"",device_name:j.userBrowser||"",device_type:j.deviceType||"",page_name:b.pageName||"",page_level1:b.level1||"",page_level2:b.level2||"",page_level3:b.level3||"",page_level4:b.level4||"",page_version:b.pageVersion||"",page_impressions:b.pageImpressions||"",page_url_host:b.urlHost||"",page_url_path:b.urlPath||"",page_url_querystring:b.urlQueryString||"",page_url_hash:b.urlHash||"",page_url_content:b.urlContent||"",page_url_protocol:b.urlProtocol||"",page_referring_url:b.referringUrl||"",page_template_id:b.templateId||"",page_page_id:b.pageId||"",page_breadcrumb:b.breadcrumb||"",page_accessibility:b.accessibility||"",page_segment:b.segment||"",page_cmsPageName:b.cmsPageName||"",page_cmsPath:b.cmsPath||"",page_search_term:e.term||"",page_search_type:e.type||"",page_channel_id:"OLB",page_platform:"OLB",user_optin_performance:i.cat2||"off",user_optin_functional:i.cat3||"off",user_optin_targeting:i.cat4||"off",user_hashed_id:"",user_hashed_id_business:"",user_registered:f.newReturning||"",user_accessibility:f.accessibility||"",user_login_method:g.method||"",user_login_route:g.route||"",user_login_success:g.success||"",user_browsing_as:f.browsingAs||"",user_accounts_held:h.itemised||"",user_accounts_held_total:h.total||"",user_customer_segment:f.customerSegment||"",user_brassId:f.brassId||"",user_login_segment:g.segment||"",user_newReturning:f.newOrReturning||"",event_type:a.eventInfo.type||"",event_application_id:b.applicationId||"",event_application_type:b.applicationType||"",event_timestamp_utc:b.timeStamp||"",event_timestamp_unix:b.timeStampUnix||"",event_cssSelector:a.eventInfo.cssSelector||"",event_error_code:d.code||"",event_deeplink_start:c.start||"",event_deeplink_success:c.success||"",event_label:a.eventInfo.label||"",event_destination:a.eventInfo.destination||"",event_section:a.eventInfo.section||"",event_value:a.eventInfo.value||"",event_subSection:a.eventInfo.subSection||"",event_domPath:a.eventInfo.domPath||"",event_alt:a.eventInfo.alt||"",event_method:a.eventInfo.method||"",event_tool:a.eventInfo.tool||"",event_campaign:"",event_error_form_fields:d.formFields||"",event_product:b.eventProduct||""};if(window.flatDigitalData=k,void 0!==a.eventInfo.type&&"screenload"!==a.eventInfo.type&&(window.flatDigitalData.event_type="click",window.flatDigitalData.event_timestamp_utc=a.eventInfo.timeStamp||"",window.flatDigitalData.event_timestamp_unix=a.eventInfo.timeStampUnix||""),"click"===window.flatDigitalData.event_type)var l=setInterval(function(){"undefined"!=typeof utag&&(clearInterval(l),utag.link(window.flatDigitalData))},1e3);if("screenload"===window.flatDigitalData.event_type){var m=setInterval(function(){"undefined"!=typeof utag&&(clearInterval(m),utag.view(window.flatDigitalData))},1e3);thclient&&thclient.pageNameChangeEvent&&document.dispatchEvent(thclient.pageNameChangeEvent)}},initializeDataObject:function(){var a=this.digitalData.page.pageInfo,b=this.digitalData.page.deepLink,c=this.digitalData.page.error,d=this.digitalData.page.searchInfo,e=this.digitalData.user,f=this.digitalData.user.login,g=this.digitalData.user.accountsHeld,h=this.getCcp(),i={page:{pageInfo:{pageName:a.pageName||"",level1:a.level1||"",level2:a.level2||"",level3:a.level3||"",level4:a.level4||"",urlProtocol:a.urlProtocol||"",urlHost:a.urlHost||"",urlPath:a.urlPath||"",urlQueryString:a.urlQueryString||"",urlHash:a.urlHash||"",urlContent:a.urlContent||"",templateId:a.templateId||"",pageId:a.pageId||"",breadcrumb:a.breadcrumb||"",accessibility:a.accessibility||"",segment:a.segment||"",pageVersion:a.pageVersion||"",pageImpressions:a.pageImpressions||"",eventProduct:a.eventProduct||"",buildVersion:a.buildVersion||"",applicationId:a.applicationId||"",applicationType:a.applicationType||"",timeStamp:a.timeStamp||"",timeStampUnix:a.timeStampUnix||"",cmsPageName:a.cmsPageName||"",cmsPath:a.cmsPath||""},deepLink:{start:b.start||"",success:b.success||""},error:{code:c.code||"",formFields:c.formFields||""},searchInfo:{term:d.term||"",type:d.type||""}},user:{ccp:{cat2:h.cat2||"off",cat3:h.cat3||"off",cat4:h.cat4||"off"},membershipID:e.membershipID||"",brassId:e.brassId||"",customerSegment:e.customerSegment||"",newReturning:e.newReturning||"",accessibility:e.accessibility||"",login:{segment:f.segment||"",method:f.method||"",route:f.route||"",success:f.success||""},browsingAs:e.browsingAs||"",accountsHeld:{itemised:g.itemised||"",total:g.total||""}},events:this.digitalData.events||[]};this.digitalData=i,window.digitalData=this.digitalData},detectCurrentOS:function(){var a="unknown";for(var b in this.authloginDigitalDataConstants.OS_OBJ){var c=this.authloginDigitalDataConstants.OS_OBJ[b];if(c.r.test(this.authloginDigitalDataConstants.nAgt)){a=c.s,/Windows/.test(a)&&(a="Windows");break}}return a},detectOSVersion:function(){var a="unknown",b="",c=this.authloginDigitalDataConstants.OS_OBJ;try{for(var d in this.authloginDigitalDataConstants.OS_OBJ){var e=this.authloginDigitalDataConstants.OS_OBJ[d];if(e.r.test(this.authloginDigitalDataConstants.nAgt)){switch(c=e.s,/Windows/.test(c)&&null!=(b=/Windows (.*)/.exec(c))&&(a=b[1]),c){case"Mac OS X":b=/Mac OS X ([\.\_\d]+)/.exec(this.authloginDigitalDataConstants.nAgt),null!=b&&(a=b[1]);break;case"Android":b=/Android ([\.\_\d]+)/.exec(this.authloginDigitalDataConstants.nAgt),null!=b&&(a=b[1]);break;case"iOS":b=/OS (\d+)_(\d+)_?(\d+)?/.exec(this.authloginDigitalDataConstants.nVer),null!=b&&b.length>3&&(a=b[1]+"."+b[2]+"."+(0|b[3]))}break}}}catch(b){a="error"}return a},detectUserBrowser:function(){try{var a,b,c,d=(this.authloginDigitalDataConstants.nVer,this.authloginDigitalDataConstants.nAgt),e=navigator.appName,f=""+parseFloat(navigator.appVersion),g=parseInt(navigator.appVersion,10);return-1!=(b=d.indexOf("Opera"))&&(e="Opera",f=d.substring(b+6),-1!=(b=d.indexOf("Version"))&&(f=d.substring(b+8))),-1!=(b=d.indexOf("OPR"))?(e="Opera",f=d.substring(b+4)):-1!=(b=d.indexOf("Edge"))?(e="Microsoft Edge",f=d.substring(b+5)):-1!=(b=d.indexOf("Edg"))?(e="Microsoft Edge",f=d.substring(b+4)):-1!=(b=d.indexOf("MSIE"))?(e="Microsoft Internet Explorer",f=d.substring(b+5)):-1!=(b=d.indexOf("Chrome"))?(e="Chrome",f=d.substring(b+7)):-1!=(b=d.indexOf("Safari"))?(e="Safari",f=d.substring(b+7),-1!=(b=d.indexOf("Version"))&&(f=d.substring(b+8))):-1!=(b=d.indexOf("Firefox"))?(e="Firefox",f=d.substring(b+8)):-1!=d.indexOf("Trident/")?(e="Microsoft Internet Explorer",f=d.substring(d.indexOf("rv:")+3)):(a=d.lastIndexOf(" ")+1)<(b=d.lastIndexOf("/"))&&(e=d.substring(a,b),f=d.substring(b+1),e.toLowerCase()==e.toUpperCase()&&(e=navigator.appName)),-1!=(c=f.indexOf(";"))&&(f=f.substring(0,c)),-1!=(c=f.indexOf(" "))&&(f=f.substring(0,c)),-1!=(c=f.indexOf(")"))&&(f=f.substring(0,c)),g=parseInt(""+f,10),isNaN(g)&&(f=""+parseFloat(navigator.appVersion),g=parseInt(navigator.appVersion,10)),e+" "+f}catch(a){return"error"}},detectDeviceType:function(){var a=this.authloginDigitalDataConstants.nVer;return/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(a)?"tablet":/Mobile|iP(hone|od|ad)|Android|BlackBerry|IEMobile|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(a)?"mobile":"desktop"},getCcp:function(){var a,b,c,d,e,f,g={cat2:"",cat3:"",cat4:""};for(b=decodeURIComponent(document.cookie),c=b.split(";"),d=0;d<c.length;d++)e=c[d],0===e.trim().indexOf("CCP=")&&(a=e.split("=")[1]);return f=a?JSON.parse(decodeURIComponent(a)):{},void 0!==f.publicuser&&(g.cat2=void 0!==f.publicuser.cat2?f.publicuser.cat2:"",g.cat3=void 0!==f.publicuser.cat3?f.publicuser.cat3:"",g.cat4=void 0!==f.publicuser.cat4?f.publicuser.cat4:""),g},authloginAppManager:{getPageLevels:function(a,b){a.level1=b[0]?b[0]:"",a.level2=b[1]?b[1]:"",a.level3=b[2]?b[2]:"",a.level4=b[3]?b[3]:""},getPageName:function(a){return a||window.dataLayer.ViewName},getAccountsHeld:function(a){var b,c=a.accountsHeld;b=document.getElementsByName("DCSext.ACCOUNT_PRODUCTS_TYPES"),b.length?(c.itemised=b[0].content,c.total=c.itemised.split("|").length):c.total=0},getNewOrReturningCustomer:function(a){var b;b=document.getElementsByName("firstTimeOLBLogin"),b.length&&("true"===b[0].content?a.newReturning="New":a.newReturning="Returning")},getLoginMethod:function(a){var b,c;for(b=document.getElementsByName("radio-log"),c=0;c<b.length;c++)if(b[c].checked)switch(b[c].id){case"radio-c1":a.method="PinSentry";break;case"radio-c2":a.method="Passcode"}},getLoginRoute:function(a){var b;switch(a){case"Passcode":b="SFA";break;case"PinSentry":b="TFA";break;case"MobilePinSentry":b="MTFA"}return b},getIsLoginSuccess:function(a){"Home page - Barclays Online Banking"===document.title?a.success="TRUE":a.success=""},getLoginDetails:function(a,b){var c=a.login;this.getLoginMethod(c),this.getIsLoginSuccess(c)},getUrlProtocol:function(a){a.urlProtocol=document.location.protocol.split(":")[0]},getUrlHost:function(a){a.urlHost=document.location.hostname},getUrlPath:function(a){a.urlPath=document.location.pathname},getReferringUrl:function(a){var b=document.referrer;if(void 0!==b){var c=b.indexOf("://");a.referringUrl=-1!==c?b.substring(c+3):b}else a.referringUrl=""},getUrlQueryStringAndUrlHash:function(a){var b,c=a.pageInfo,d=(c.urlQueryString,["\\#","\\?"]),e=document.location.href,f="?",g="#";switch(b=e.split(new RegExp(d.join("|"))),b.length){case 3:f+b[1],c.urlHash=g+b[2];break;default:-1!==e.indexOf(f)&&f+b[1],-1!==e.indexOf(g)&&(c.urlHash=g+b[1])}}},authloginDigitalDataConstants:{allowedClickTags:["BUTTON","A","SPAN","INPUT"],disallowedInputTags:["text","password","email","search","tel","url"],OS_OBJ:[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Chrome OS",r:/CrOS/},{s:"Linux",r:/(Linux|X11(?!.*CrOS))/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}],nVer:navigator.appVersion,nAgt:navigator.userAgent},getPageAndEventAttributes:function(){var a=["pageVersion","pageImpressions","eventProduct"],b=this.digitalData.page.pageInfo;if(window.digitalDataPageAndEventAttributes){window.digitalDataPageAndEventAttributes.split(":").forEach(function(c,d){if(d<3){var e=a[d];b[e]=c||""}})}},getEventErrorFormFields:function(){var a=[];return $("div").each(function(){var b=$(this).attr("data-err-form-field");b&&a.push(b)}),a.toString()},getEventErrorCode:function(){return $("[data-err-code]").attr("data-err-code")||""},getDeviceBuildID:function(){null!==window.digitalDataDeviceBuildId&&void 0!==window.digitalDataDeviceBuildId&&(this.digitalData.page.pageInfo.buildVersion=window.digitalDataDeviceBuildId)}};window.digitalDataDeviceBuildId="bwo-rc-23.12.01.01";var s_account="barukprod";try{s_account="barukprod",(s_account.length<3||s_account.length>25)&&(s_account="barukprod")}catch(a){}WebAnalytics=void 0,String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};var dcs2sc={dcsuri:"prop16",ErrorMessage:new scFixed1Tag("events","event4","eVar11"),sp:"prop1",cg_n:"prop2",cg_s:"prop3",ti:"__pageName","p1:p2:p3":new scCombinedP123(":"),"p1/p2/p3":new scCombinedP123("/"),tx_e:"__tx_e",si_cs:new scFixed("events","event8"),si_n:"prop26",si_p:"prop31",si_x:"prop31",RealStoreView:new scFixed1Tag("events","prodView","prop20"),RealStoreViewChoice:new scFixed1Tag("events","scView","prop20"),RealStoreAdd:new scFixed1Tag("events","scAdd","prop20"),RealStoreRemove:new scFixed1Tag("events","scRemove","prop20"),ModuleAdded:"prop30",ModuleRemoved:"prop30",DAYS_SINCE_LAST_LOGIN:"eVar13",NUMBER_OF_ACCOUNTS_HELD:"prop28",ACCOUNT_PRODUCTS_TYPES:"eVar15",TaskViewNotifications:"eVar53",TaskViewNotificationsCopy:"prop53",ContactDetailsChanged:new scLowRankTag("list2"),emailcontact:new scAppendWholeTag("events","event17","prop20","ContactPreferences","list2"),onlinecontact:new scAppendWholeTag("events","event17","prop20","ContactPreferences","list2"),telcontact:new scAppendWholeTag("events","event17","prop20","ContactPreferences","list2"),textcontact:new scAppendWholeTag("events","event17","prop20","ContactPreferences","list2"),LoginMechanism:"eVar36",LOGIN_METHOD:"eVar37",LoginMethod:"eVar38","Unsuccessful Login":"eVar40",pageNameClone:"eVar41",Impressions:"eVar53",ImpressionsClone:"prop53",ERRORS:"prop11",VALIDATION_ERRORS:"prop32",MEMBERSHIPID:"prop34",pn_sku:"prop20",tx_u:"__tx_u",tx_i:"eVar19",tx_s:new scLowRankTag("prop30"),dcsvid:"eVar25",seg_2:"eVar12",seg_1:"__seg_1",LinkName:new scSetLinkNameTag("__LinkName",3),sevents:"events",spageName:"__pageName",sprop10:"prop10",sprop11:"prop11",sprop12:"prop12",sprop16:"prop16",sprop17:"prop17",sprop21:"prop21",sprop23:"prop23",sprop25:"prop25",sprop13:"prop13",sprop14:"prop14",sprop17:"prop17",sprop33:"prop33",sprop34:"prop34",seVar28:"eVar28",seVar29:"eVar29",seVar41:"eVar41",seVar42:"eVar42",seVar53:"eVar53",seVar9:"eVar9",seVar10:"eVar10",seVar11:"eVar11",seVar23:"eVar23",seVar25:"eVar25",seVar30:"eVar30",slist3:"list3"},scBasePageName="",scTakeoverPageName="",_self="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{},Prism=function(){var a=/\blang(?:uage)?-(?!\*)(\w+)\b/i,b=_self.Prism={util:{encode:function(a){return a instanceof c?new c(a.type,b.util.encode(a.content),a.alias):"Array"===b.util.type(a)?a.map(b.util.encode):a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(a){return Object.prototype.toString.call(a).match(/\[object (\w+)\]/)[1]},clone:function(a){switch(b.util.type(a)){case"Object":var c={};for(var d in a)a.hasOwnProperty(d)&&(c[d]=b.util.clone(a[d]));return c;case"Array":return a.map&&a.map(function(a){return b.util.clone(a)})}return a}},languages:{extend:function(a,c){var d=b.util.clone(b.languages[a]);for(var e in c)d[e]=c[e];return d},insertBefore:function(a,c,d,e){e=e||b.languages;var f=e[a];if(2==arguments.length){d=arguments[1];for(var g in d)d.hasOwnProperty(g)&&(f[g]=d[g]);return f}var s={};for(var h in f)if(f.hasOwnProperty(h)){if(h==c)for(var g in d)d.hasOwnProperty(g)&&(s[g]=d[g]);s[h]=f[h]}return b.languages.DFS(b.languages,function(b,c){c===e[a]&&b!=a&&(this[b]=s)}),e[a]=s},DFS:function(a,c,d){for(var e in a)a.hasOwnProperty(e)&&(c.call(a,e,a[e],d||e),"Object"===b.util.type(a[e])?b.languages.DFS(a[e],c):"Array"===b.util.type(a[e])&&b.languages.DFS(a[e],c,e))}},highlightAll:function(a,c){for(var d,e=document.querySelectorAll('code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'),f=0;d=e[f++];)b.highlightElement(d,!0===a,c)},highlightElement:function(d,e,f){for(var g,s,h=d;h&&!a.test(h.className);)h=h.parentNode;if(h&&(g=(h.className.match(a)||[,""])[1],s=b.languages[g]),d.className=d.className.replace(a,"").replace(/\s+/g," ")+" language-"+g,h=d.parentNode,/pre/i.test(h.nodeName)&&(h.className=h.className.replace(a,"").replace(/\s+/g," ")+" language-"+g),s){var i=d.textContent;if(i){i=i.replace(/^(?:\r?\n|\r)/,"");var j={element:d,language:g,grammar:s,code:i};if(b.hooks.run("before-highlight",j),e&&_self.Worker){var k=new Worker(b.filename);k.onmessage=function(a){j.highlightedCode=c.stringify(JSON.parse(a.data),g),b.hooks.run("before-insert",j),j.element.innerHTML=j.highlightedCode,f&&f.call(j.element),b.hooks.run("after-highlight",j)},k.postMessage(JSON.stringify({language:j.language,code:j.code}))}else j.highlightedCode=b.highlight(j.code,j.grammar,j.language),b.hooks.run("before-insert",j),j.element.innerHTML=j.highlightedCode,f&&f.call(d),b.hooks.run("after-highlight",j)}}},highlight:function(a,d,e){var f=b.tokenize(a,d);return c.stringify(b.util.encode(f),e)},tokenize:function(a,c){var d=b.Token,e=[a],f=c.rest;if(f){for(var g in f)c[g]=f[g];delete c.rest}a:for(var g in c)if(c.hasOwnProperty(g)&&c[g]){var s=c[g];s="Array"===b.util.type(s)?s:[s];for(var h=0;h<s.length;++h){var i=s[h],j=i.inside,k=!!i.lookbehind,l=0,m=i.alias;i=i.pattern||i;for(var n=0;n<e.length;n++){var o=e[n];if(e.length>a.length)break a;if(!(o instanceof d)){i.lastIndex=0;var p=i.exec(o);if(p){k&&(l=p[1].length);var q=p.index-1+l,p=p[0].slice(l),r=p.length,t=q+r,u=o.slice(0,q+1),v=o.slice(t+1),w=[n,1];u&&w.push(u);var x=new d(g,j?b.tokenize(p,j):p,m);w.push(x),v&&w.push(v),Array.prototype.splice.apply(e,w)}}}}}return e},hooks:{all:{},add:function(a,c){var d=b.hooks.all;d[a]=d[a]||[],d[a].push(c)},run:function(a,c){var d=b.hooks.all[a];if(d&&d.length)for(var e,f=0;e=d[f++];)e(c)}}},c=b.Token=function(a,b,c){this.type=a,this.content=b,this.alias=c};if(c.stringify=function(a,d,e){if("string"==typeof a)return a;if("Array"===b.util.type(a))return a.map(function(b){return c.stringify(b,d,a)}).join("");var f={type:a.type,content:c.stringify(a.content,d,e),tag:"span",classes:["token",a.type],attributes:{},language:d,parent:e};if("comment"==f.type&&(f.attributes.spellcheck="true"),a.alias){var g="Array"===b.util.type(a.alias)?a.alias:[a.alias];Array.prototype.push.apply(f.classes,g)}b.hooks.run("wrap",f);var s="";for(var h in f.attributes)s+=h+'="'+(f.attributes[h]||"")+'"';return"<"+f.tag+' class="'+f.classes.join(" ")+'" '+s+">"+f.content+"</"+f.tag+">"},!_self.document)return _self.addEventListener?(_self.addEventListener("message",function(a){var c=JSON.parse(a.data),d=c.language,e=c.code;_self.postMessage(JSON.stringify(b.util.encode(b.tokenize(e,b.languages[d])))),_self.close()},!1),_self.Prism):_self.Prism;var d=document.getElementsByTagName("script");return d=d[d.length-1],d&&(b.filename=d.src,document.addEventListener&&!d.hasAttribute("data-manual")&&document.addEventListener("DOMContentLoaded",b.highlightAll)),_self.Prism}();"undefined"!=typeof module&&module.exports&&(module.exports=Prism),Prism.languages.markup={comment:/<!--[\w\W]*?-->/,prolog:/<\?[\w\W]+?\?>/,doctype:/<!DOCTYPE[\w\W]+?>/,cdata:/<!\[CDATA\[[\w\W]*?]]>/i,tag:{pattern:/<\/?[^\s>\/]+(?:\s+[^\s>\/=]+(?:=(?:("|')(?:\\\1|\\?(?!\1)[\w\W])*\1|[^\s'">=]+))?)*\s*\/?>/i,inside:{tag:{pattern:/^<\/?[^\s>\/]+/i,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"attr-value":{pattern:/=(?:('|")[\w\W]*?(\1)|[^\s>]+)/i,inside:{punctuation:/[=>"']/}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:/&#?[\da-z]{1,8};/i},Prism.hooks.add("wrap",function(a){"entity"===a.type&&(a.attributes.title=a.content.replace(/&amp;/,"&"))}),Prism.languages.css={comment:/\/\*[\w\W]*?\*\//,atrule:{pattern:/@[\w-]+?.*?(;|(?=\s*\{))/i,inside:{rule:/@[\w-]+/}},url:/url\((?:(["'])(\\(?:\r\n|[\w\W])|(?!\1)[^\\\r\n])*\1|.*?)\)/i,selector:/[^\{\}\s][^\{\};]*?(?=\s*\{)/,string:/("|')(\\(?:\r\n|[\w\W])|(?!\1)[^\\\r\n])*\1/,property:/(\b|\B)[\w-]+(?=\s*:)/i,important:/\B!important\b/i,function:/[-a-z0-9]+(?=\()/i,punctuation:/[(){};:]/},Prism.languages.css.atrule.inside.rest=Prism.util.clone(Prism.languages.css),Prism.languages.markup&&(Prism.languages.insertBefore("markup","tag",{style:{pattern:/<style[\w\W]*?>[\w\W]*?<\/style>/i,inside:{tag:{pattern:/<style[\w\W]*?>|<\/style>/i,inside:Prism.languages.markup.tag.inside},rest:Prism.languages.css},alias:"language-css"}}),Prism.languages.insertBefore("inside","attr-value",{"style-attr":{pattern:/\s*style=("|').*?\1/i,inside:{"attr-name":{pattern:/^\s*style/i,inside:Prism.languages.markup.tag.inside},punctuation:/^\s*=\s*['"]|['"]\s*$/,"attr-value":{pattern:/.+/i,inside:Prism.languages.css}},alias:"language-css"}},Prism.languages.markup.tag)),Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\w\W]*?\*\//,lookbehind:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0}],string:/("|')(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,"class-name":{pattern:/((?:(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[a-z0-9_\.\\]+/i,lookbehind:!0,inside:{punctuation:/(\.|\\)/}},keyword:/\b(if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/,boolean:/\b(true|false)\b/,function:/[a-z0-9_]+(?=\()/i,number:/\b-?(0x[\dA-Fa-f]+|\d*\.?\d+([Ee]-?\d+)?)\b/,operator:/[-+]{1,2}|!|<=?|>=?|={1,3}|&{1,2}|\|?\||\?|\*|\/|~|\^|%/,punctuation:/[{}[\];(),.:]/},Prism.languages.javascript=Prism.languages.extend("clike",{keyword:/\b(as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|false|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|true|try|typeof|var|void|while|with|yield)\b/,number:/\b-?(0x[\dA-Fa-f]+|0b[01]+|0o[0-7]+|\d*\.?\d+([Ee][+-]?\d+)?|NaN|Infinity)\b/,function:/(?!\d)[a-z0-9_$]+(?=\()/i}),Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:/(^|[^/])\/(?!\/)(\[.+?]|\\.|[^/\\\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/,lookbehind:!0}}),Prism.languages.insertBefore("javascript","class-name",{"template-string":{pattern:/`(?:\\`|\\?[^`])*`/,inside:{interpolation:{pattern:/\$\{[^}]+\}/,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}}}),Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{script:{pattern:/<script[\w\W]*?>[\w\W]*?<\/script>/i,inside:{tag:{pattern:/<script[\w\W]*?>|<\/script>/i,inside:Prism.languages.markup.tag.inside},rest:Prism.languages.javascript},alias:"language-javascript"}}),function(angular){"use strict";angular.module("rolb.services").factory("spinnerHTTPInterceptor",["$q","$rootScope",function(a,b){var c=0;return{request:function(a){return c++,b.$broadcast("loader_on"),a},response:function(a){return 0==--c&&b.$broadcast("loader_off"),a},responseError:function(d){return--c||b.$broadcast("loader_off"),a.reject(d)}}}]).provider("$loader",["$injector",function(a){var b;this.init=function(){var a=12,c="",d=angular.element(document.querySelector(".rolb")),e=angular.element("<div id/>");for(e.attr("id","ROLBspinner"),c="<div class='spinner-css' style='transform:scale(0.5);'>";a--;)c+="<div></div>";c+="</div>",e.append(c),d.append(e),b=angular.element(document.querySelector("#ROLBspinner"))},this.$get=["$injector",function(a){var c={},d=a.get("$rootScope");return c.exec=function(){d.$on("loader_on",function(){b.removeClass("hidden")}),d.$on("loader_off",function(){b.addClass("hidden")})},c}]}])}(angular),function(){"use strict";var a="bdlLogin",b=function(b){return(window[a]&&window[a].ctxPath||"/olb/authlogin")+"/"+b},c=function(a){return"/authlogin/"+a};angular.module("appBdlLogin",["ngRoute","ngCookies","DSS.Components","appBdlLogin.controllers","appBdlLogin.directives","appBdlLogin.services","appBdlLogin.filters"]).constant("partial",function(a){return c("partials/bdlLogin/")+a}).constant("appContext",function(c){return b(a+"/")+c}).constant("contentUrl",function(a){return b("content/")+a+".json"}).constant("appName",a).constant("webContext",function(a){return b(a)}).constant("imageUrl",function(a){return"/authlogin/img/"+a}).config(["$routeProvider","partial","contentUrl","appContext",function(a,b,c,d){a.when("/identification",{templateUrl:b("identification/identification.html"),controller:"identificationCtrl",reloadOnSearch:!1,title:"Step 1 - Login details - Barclays Online Banking",resolve:{cmaContent:["$http",function(a){return a.post(c("LoginStep1NoSavedMemberDecoupled"),{})}]}}).when("/identifyJointAccount",{templateUrl:b("identification/identifyJointAccount.html"),controller:"identifyJointAccountCtrl",reloadOnSearch:!1,title:"Step 1 - Login details - Barclays Online Banking"}).when("/rememberme",{templateUrl:b("rememberMe.html"),controller:"rememberMeCtrl",reloadOnSearch:!1,title:"Step 1 - Login details - Barclays Online Banking",resolve:{cmaContent:["authLoginUtilService",function(a){return!!a.isRemembermePage()&&a.loadCMAContent("LoginStep1MultipleSavedMembersDecoupled")}]}}).when("/authTFA",{templateUrl:b("authTFA.html"),controller:"authTFACtrl",reloadOnSearch:!1,title:"Step 2 - Confirm your ID - Barclays Online Banking"}).when("/authentication",{templateUrl:b("authentication/authentication.html"),controller:"authenticationCtrl",reloadOnSearch:!1,title:"Step 2 - Confirm your ID - Barclays Online Banking",resolve:{cmaContent:["authLoginUtilService",function(a){return a.isUserDataSet()}]}}).when("/lockedOut",{templateUrl:b("/forgot/lockedOut.html"),controller:"lockedOutCtrl",reloadOnSearch:!1,title:"Step 2 - Locked out of Online Banking - Barclays Online Banking",resolve:{content:["$http",function(a){return a.post(c("LockedOutErrorFtb"),{})}]}}).when("/forgotPasscodeDetails",{templateUrl:b("/forgot/forgotPasscodeDetails.html"),controller:"forgotPasscodeDetailsCtrl",reloadOnSearch:!1,title:"Step 1 - Forgotten Passcode - Barclays Online Banking",resolve:{content:["$http",function(a){return a.post(c("LoginStep2ReorderPasscode"),{})}]}}).when("/forgotPasscodeConfirm",{templateUrl:b("/forgot/forgotPasscodeConfirm.html"),controller:"forgotPasscodeConfirmCtrl",reloadOnSearch:!1,title:"Step 3 - Forgotten Passcode - Barclays Online Banking",resolve:{content:["$http",function(a){return a.post(c("LoginStep2ReorderPasscodeConfirmAddress"),{})}]}}).when("/forgotPasscodeSuccess",{templateUrl:b("/forgot/forgotPasscodeSuccess.html"),controller:"forgotPasscodeSuccessCtrl",reloadOnSearch:!1,title:"Success Page - Forgotten Passcode - Barclays Online Banking"}).when("/forgotPasscodeDeliveryMethodSelection",{templateUrl:b("/forgot/forgotPasscodeDeliveryMethodSelection.html"),controller:"forgotPasscodeDeliveryMethodCtrl",reloadOnSearch:!1,title:"Step 2 - Forgotten Passcode - Barclays Online Banking",resolve:{content:["$http",function(a){return a.post(c("LoginStep2ReorderPasscodeSelection"),{})}]}}).when("/forgotPasscodeVerificationCode",{templateUrl:b("/forgot/forgotPasscodeVerificationCode.html"),controller:"forgotPasscodeVerificationCodeCtrl",reloadOnSearch:!1,title:"Step 3 - Forgotten Passcode - Barclays Online Banking",resolve:{content:["$http",function(a){return a.post(c("forgotPasscodeVerificationCodeEntry"),{})}]}}).when("/forgotPasscodeReset",{templateUrl:b("/forgot/forgotPasscodeReset.html"),controller:"forgotPasscodeResetCtrl",reloadOnSearch:!1,title:"Step 4 - Forgotten Passcode - Barclays Online Banking"}).when("/interstitial",{templateUrl:b("interstitial.html"),controller:"interstitialCtrl",reloadOnSearch:!1,title:"Step 3 - Your details - Login - Barclays Online Banking"}).when("/forgotMembership",{templateUrl:b("/forgot/forgotMembershipDetails.html"),controller:"forgotMembershipDetailsCtrl",reloadOnSearch:!1,title:"Step 1 - Forgotten membership number - Barclays Online Banking",resolve:{content:["$http",function(a){return a.post(c("FLDMembershipNumberStep1"),{})}]}}).when("/forgotMembershipSuccess",{templateUrl:b("/forgot/forgotMembershipSuccess.html"),controller:"forgotMembershipSuccessCtrl",reloadOnSearch:!1,title:"Step 2 - Forgotten membership number - Barclays Online Banking",resolve:{content:["$http",function(a){return a.post(c("FLDMembershipNumberStep3"),{})}]}}).when("/multipleMembership",{templateUrl:b("forgot/multipleMembership.html"),controller:"forgotMembershipSuccessCtrl",reloadOnSearch:!1,title:"Step 2 - Forgotten membership number - Barclays Online Banking",resolve:{content:["$http",function(a){return a.post(c("FLDMembershipNumberStep3"),{})}]}}).when("/cookiePref",{templateUrl:b("cookiesPolicy.html"),controller:"cookiePrefCtrl",reloadOnSearch:!1,title:"Step 1 - Enhanced Cookies Notice - Barclays Online Banking"}).when("/logMultipleMemDetails",{templateUrl:b("multipleMembership/loginMultipleMemDetails.html"),controller:"loginMultipleMemDetailsCtrl",reloadOnSearch:!1,title:"Step 1 - Your details - Login - Barclays Online Banking",resolve:{content:["$http",function(a){return a.post(c("FLDMembershipNumberStep1"),{})}]}}).when("/logMultipleMemSuccess",{templateUrl:b("forgot/multipleMembership.html"),controller:"loginMultipleMemSuccessCtrl",reloadOnSearch:!1,title:"Step 3 - Your details - Login - Barclays Online Banking",resolve:{content:["$http",function(a){return a.post(c("FLDMembershipNumberStep3"),{})}]}}).when("/changeFirstTimePasscode",{templateUrl:b("changeFirstTimePasscode.html"),controller:"changeFirstTimePasscodeCtrl",reloadOnSearch:!1,title:"Step 1 - Your details - Login - Barclays Online Banking"}).when("/dynamicInterstitial",{templateUrl:b("dynamicInterstitial.html"),controller:"dynamicInterstitialCtrl",reloadOnSearch:!1,title:"Step 1 - Your details - Login - Barclays Online Banking"}).when("/scaCardAuthentication",{templateUrl:b("sca/scaCardAuthentication.html"),controller:"scaCardAuthenticationCtrl",reloadOnSearch:!1,title:"Step 3 - Confirm your ID - Barclays Online Banking",resolve:{content:["$http",function(a){return a.post(c("LoginStrongCustomerAuthentication"),{})}]}}).when("/scaOtpAuthentication",{templateUrl:b("sca/scaOtpAuthentication.html"),controller:"scaOtpAuthenticationCtrl",reloadOnSearch:!1,title:"Step 2 - Confirm your ID - Barclays Online Banking",resolve:{content:["$http",function(a){return a.post(c("LoginOneTimePassCodeAuthentication"),{})}]}}).when("/selfServeMemLockedOut",{templateUrl:b("selfServeMembershipUnlock/selfServeMemLockedOut.html"),controller:"selfServeMemLockedOutCtrl",reloadOnSearch:!1,title:"Step 1 - Your details - Locked out of Online Banking - Barclays Online Banking",resolve:{cmaContent:["$http",function(a){return a.post(c("SelfServeMembershipLockedOut"),{})}]}}).when("/selfServeMemUnlockUserDetails",{templateUrl:b("selfServeMembershipUnlock/selfServeMemUnlockUserDetails.html"),controller:"selfServeMemUnlockUserDetailsCtrl",reloadOnSearch:!1,title:"Step 1 - Your details - Locked out of Online Banking - Barclays Online Banking",resolve:{cmaContent:["$http",function(a){return a.post(c("SelfServeMembershipUnlock"),{})}]}}).when("/selfServeMemUnlockOtpAuth",{templateUrl:b("selfServeMembershipUnlock/selfServeMemUnlockOtpAuth.html"),controller:"selfServeMemUnlockOtpAuthCtrl",reloadOnSearch:!1,title:"Step 2 - SMS verification - Locked out of Online Banking - Barclays Online Banking",resolve:{cmaContent:["$http",function(a){return a.post(c("SelfServeMembershipUnlockOTPAuthentication"),{})}]}}).when("/selfServeMemUnlockSuccess",{templateUrl:b("selfServeMembershipUnlock/selfServeMemUnlockSuccess.html"),controller:"selfServeMemUnlockSuccessCtrl",reloadOnSearch:!1,title:"Step 3 - Unlock Success - Locked out of Online Banking - Barclays Online Banking",resolve:{cmaContent:["$http",function(a){return a.post(c("SelfServeMembershipUnlockSuccess"),{})}]}}).when("/solusMerchantTnc",{templateUrl:b("solusMerchantTnc.html"),controller:"solusMerchantTncCtrl",reloadOnSearch:!1,title:"Step 3 - Solus Merchant - Accept Terms and Conditions - Barclays Online Banking"}).when("/confirmIdentity",{templateUrl:b("trustAnchor.html"),controller:"trustAnchorCtrl",reloadOnSearch:!1,title:"Step 2 - Confirm your ID - Barclays Online Banking"}).when("/notification",{templateUrl:b("trustAnchor/notification.html"),controller:"taNotificationCtrl",reloadOnSearch:!1,title:"Step 2 - Confirm your ID - Barclays Online Banking"}).when("/mobilePINSentry",{templateUrl:b("mobilePINSentry.html"),controller:"mobilePINSentryCtrl",reloadOnSearch:!1,title:"Step 2 - Confirm your ID - Barclays Online Banking",resolve:{cmaContent:["$http",function(a){return a.post(c("LoginStep2TwoFactorMobileDecoupled"),{})}]}}).otherwise({redirectTo:"/identification",reloadOnSearch:!1,title:"Step 1 - Your details - Login - Barclays Online Banking"})}]).run(["$location","$rootScope","timeoutService","CONSTANT","secureRoute",function(a,b,c,d,e){b.$on("$routeChangeSuccess",function(a,e,f){AppName.Module.formInstance={},f&&f.$$route&&(b.previousRoute=f.$$route.originalPath),e.hasOwnProperty("$$route")&&(document.title=e.$$route.title,"/identification"===e.$$route.originalPath&&(b.tfaSwitched=null,("/forgotMembership"===b.previousRoute||"/forgotPasscodeDetails"===b.previousRoute)&&b.userData&&b.contentResponse&&(b.contentResponse.errorJSON={}))),void 0!==c.startLoginTimeout()&&c.registerTimeoutCallbackFn(function(){location.href=d.URL.BarclaysHomePage})})}]).config(["$httpProvider","$loaderProvider",function(a,b){a.defaults.timeout=9e4,a.defaults.headers.common["Content-Type"]="application/json",a.interceptors.push("errorHandlingHTTPInterceptor"),a.interceptors.push("spinnerHTTPInterceptor"),b.init()}]).run(["$rootScope","$templateCache","containerInterface","secureRoute","$loader","$timeout",function(a,b,c,d,e,f){var g=[];g.push(a.$on("$viewContentLoaded",function(){b.removeAll()})),g.push(a.$on("$locationChangeStart",function(a,b,e){c.locationChange(a,b,e),d.locationChange(a,b,e)})),g.push(a.$on("$destroy",function(){angular.forEach(g,function(a){a()}),g=[]})),e.exec()}]).run(["$rootScope","$window","$route",function(a,b,c){b._rolb_angular_cleanup={rootScope:a,ngRoutes:c.routes}}])}();